from datetime import datetime

import pytest
from fastapi.testclient import TestClient
from moto import mock_dynamodb

from app.main import app
from app.models.admin import AdminModel
from app.models.master import (
    MasterSupporterOrganizationModel,
)
from app.models.project import (
    GrossProfitAttribute,
    ProjectModel,
    SalesforceMainCustomerAttribute,
)
from app.models.project_survey import (
    AnswersAttribute,
    PointsAttribute,
    ProjectSurveyModel,
    SupporterUserAttribute,
)
from app.models.user import UserModel
from app.resources.const import DataType, MasterDataType, UserRoleType

client = TestClient(app)

REQUEST_HEADERS = {"x-otp-verified-token": "111111"}


@mock_dynamodb
class TestGetSurveyPlans:
    def setup_method(self, method):
        ProjectSurveyModel.create_table(
            read_capacity_units=5, write_capacity_units=5, wait=True
        )
        ProjectModel.create_table(
            read_capacity_units=5, write_capacity_units=5, wait=True
        )
        UserModel.create_table(read_capacity_units=5, write_capacity_units=5, wait=True)
        MasterSupporterOrganizationModel.create_table(
            read_capacity_units=5, write_capacity_units=5, wait=True
        )

        ProjectSurveyModel(
            id="11111449-5d63-42d4-ae1b-f0faf65a7076",
            data_type=DataType.SURVEY,
            survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
            survey_master_revision=4,
            survey_type="service",
            project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
            project_name="サンプルプロジェクト",
            customer_success="DXの実現",
            supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
            supporter_organization_name="IST",
            support_date_from="2022/01/01",
            support_date_to="2022/06/30",
            main_supporter_user=SupporterUserAttribute(
                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                name="山田太郎",
                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                organization_name="IST",
            ),
            supporter_users=[
                SupporterUserAttribute(
                    id="fee9f8ac-b968-40ce-9f68-32df0ad01957",
                    name="山田太郎２",
                    organization_id="bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                    organization_name="BIT",
                )
            ],
            sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            service_type_name="組織開発",
            answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
            answer_user_name="田中 次郎",
            dedicated_survey_user_name="",
            dedicated_survey_user_email="",
            customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
            customer_name="あああ研究所",
            company="ソニーグループ株式会社",
            answers=[
                AnswersAttribute(
                    id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                    answer="問題なし",
                    point=3,
                )
            ],
            summary_month="2022/01",
            plan_survey_request_datetime="2022/01/15 01:00",
            actual_survey_request_datetime="2022/01/15 01:10",
            plan_survey_response_datetime="2022/01/31 17:00",
            actual_survey_response_datetime="2022/01/30 10:00",
            is_finished=True,
            is_disclosure=True,
            is_not_summary=False,
            unanswered_surveys_number=0,
            points=PointsAttribute(
                satisfaction=3,
                continuation=False,
                recommended=3,
                sales=0,
                survey_satisfaction=4,
                man_hour_satisfaction=4,
                karte_satisfaction=4,
                master_karte_satisfaction=0,
            ),
            this_month_type="サービスアンケート",
            no_send_reason=None,
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            create_at=datetime.now(),
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_at=datetime.now(),
        ).save()

        ProjectSurveyModel(
            id="00000449-5d63-42d4-ae1b-f0faf65a7076",
            data_type=DataType.SURVEY,
            survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
            survey_master_revision=4,
            survey_type="service",
            project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
            project_name="サンプルプロジェクト",
            customer_success="DXの実現",
            supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
            supporter_organization_name="IST",
            support_date_from="2022/01/01",
            support_date_to="2022/06/30",
            main_supporter_user=SupporterUserAttribute(
                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                name="山田太郎",
                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                organization_name="IST",
            ),
            supporter_users=[
                SupporterUserAttribute(
                    id="fee9f8ac-b968-40ce-9f68-32df0ad01957",
                    name="山田太郎２",
                    organization_id="bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                    organization_name="BIT",
                )
            ],
            sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            service_type_name="組織開発",
            answer_user_id="",
            answer_user_name="",
            dedicated_survey_user_name="",
            dedicated_survey_user_email="",
            customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
            customer_name="あああ研究所",
            company="ソニーグループ株式会社",
            answers=[
                AnswersAttribute(
                    id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                    answer="問題なし",
                    point=3,
                )
            ],
            summary_month="2022/02",
            plan_survey_request_datetime="2022/02/15 01:00",
            actual_survey_request_datetime=None,
            plan_survey_response_datetime="2022/02/31 17:00",
            actual_survey_response_datetime=None,
            is_finished=False,
            is_disclosure=True,
            is_not_summary=False,
            unanswered_surveys_number=0,
            points=PointsAttribute(
                satisfaction=3,
                continuation=False,
                recommended=3,
                sales=0,
                survey_satisfaction=4,
                man_hour_satisfaction=4,
                karte_satisfaction=4,
                master_karte_satisfaction=0,
            ),
            this_month_type="サービスアンケート",
            no_send_reason=None,
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            create_at=datetime.now(),
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_at=datetime.now(),
        ).save()

        ProjectSurveyModel(
            id="22222449-5d63-42d4-ae1b-f0faf65a7076",
            data_type=DataType.SURVEY,
            survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
            survey_master_revision=4,
            survey_type="service",
            project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
            project_name="サンプルプロジェクト",
            customer_success="DXの実現",
            supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
            supporter_organization_name="IST",
            support_date_from="2022/01/01",
            support_date_to="2022/06/30",
            main_supporter_user=SupporterUserAttribute(
                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                name="山田太郎",
                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                organization_name="IST",
            ),
            supporter_users=[
                SupporterUserAttribute(
                    id="fee9f8ac-b968-40ce-9f68-32df0ad01957",
                    name="山田太郎２",
                    organization_id="bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                    organization_name="BIT",
                )
            ],
            sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            service_type_name="組織開発",
            answer_user_id="",
            answer_user_name="",
            dedicated_survey_user_name="山田太郎",
            dedicated_survey_user_email="yamada@example.com",
            customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
            customer_name="あああ研究所",
            company="ソニーグループ株式会社",
            answers=[
                AnswersAttribute(
                    id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                    answer="問題なし",
                    point=3,
                )
            ],
            summary_month="2022/03",
            plan_survey_request_datetime="2022/03/15 01:00",
            actual_survey_request_datetime="2022/03/15 01:10",
            plan_survey_response_datetime="2022/03/30 17:00",
            actual_survey_response_datetime="2022/03/30 10:00",
            is_finished=True,
            is_disclosure=True,
            is_not_summary=False,
            unanswered_surveys_number=0,
            points=PointsAttribute(
                satisfaction=3,
                continuation=False,
                recommended=3,
                sales=0,
                survey_satisfaction=4,
                man_hour_satisfaction=4,
                karte_satisfaction=4,
                master_karte_satisfaction=0,
            ),
            this_month_type="サービスアンケート",
            no_send_reason=None,
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            create_at=datetime.now(),
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_at=datetime.now(),
        ).save()

        ProjectSurveyModel(
            id="22222449-5d63-42d4-ae1b-f0faf65a22222",
            data_type=DataType.SURVEY,
            survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
            survey_master_revision=4,
            survey_type="service",
            project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
            project_name="サンプルプロジェクト",
            customer_success="DXの実現",
            supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
            supporter_organization_name="IST",
            support_date_from="2022/01/01",
            support_date_to="2022/06/30",
            main_supporter_user=SupporterUserAttribute(
                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                name="山田太郎",
                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                organization_name="IST",
            ),
            supporter_users=[
                SupporterUserAttribute(
                    id="fee9f8ac-b968-40ce-9f68-32df0ad01957",
                    name="山田太郎２",
                    organization_id="bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                    organization_name="BIT",
                )
            ],
            sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            service_type_name="組織開発",
            answer_user_id="",
            answer_user_name="",
            dedicated_survey_user_name="山田太郎",
            dedicated_survey_user_email="yamada@example.com",
            customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
            customer_name="あああ研究所",
            company="ソニーグループ株式会社",
            answers=[
                AnswersAttribute(
                    id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                    answer="問題なし",
                    point=3,
                )
            ],
            summary_month="2022/06",
            plan_survey_request_datetime="2022/06/15 01:00",
            actual_survey_request_datetime="2022/06/15 01:10",
            plan_survey_response_datetime="2022/06/30 17:00",
            actual_survey_response_datetime=None,
            is_finished=False,
            is_disclosure=False,
            is_not_summary=False,
            unanswered_surveys_number=1,
            points=PointsAttribute(
                satisfaction=3,
                continuation=False,
                recommended=3,
                sales=0,
                survey_satisfaction=4,
                man_hour_satisfaction=4,
                karte_satisfaction=4,
                master_karte_satisfaction=0,
            ),
            this_month_type="サービスアンケート",
            no_send_reason=None,
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            create_at=datetime.now(),
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_at=datetime.now(),
        ).save()

        ProjectSurveyModel(
            id="33333449-5d63-42d4-ae1b-f0faf65a7076",
            data_type=DataType.SURVEY,
            survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
            survey_master_revision=4,
            survey_type="completion",
            project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
            project_name="サンプルプロジェクト",
            customer_success="DXの実現",
            supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
            supporter_organization_name="IST",
            support_date_from="2022/01/01",
            support_date_to="2022/06/30",
            main_supporter_user=SupporterUserAttribute(
                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                name="山田太郎",
                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                organization_name="IST",
            ),
            supporter_users=[
                SupporterUserAttribute(
                    id="fee9f8ac-b968-40ce-9f68-32df0ad01957",
                    name="山田太郎２",
                    organization_id="bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                    organization_name="BIT",
                )
            ],
            sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            service_type_name="組織開発",
            answer_user_id="",
            answer_user_name="",
            dedicated_survey_user_name="匿名太郎",
            dedicated_survey_user_email="dedicated_taro@example.com",
            customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
            customer_name="あああ研究所",
            company="ソニーグループ株式会社",
            answers=[
                AnswersAttribute(
                    id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                    answer="問題なし",
                    point=3,
                )
            ],
            summary_month="2022/04",
            plan_survey_request_datetime="2022/04/15 01:00",
            actual_survey_request_datetime="2022/04/15 01:10",
            plan_survey_response_datetime="2022/04/30 17:00",
            actual_survey_response_datetime="2022/04/30 10:00",
            is_finished=True,
            is_disclosure=True,
            is_not_summary=False,
            unanswered_surveys_number=0,
            points=PointsAttribute(
                satisfaction=3,
                continuation=False,
                recommended=3,
                sales=0,
                survey_satisfaction=4,
                man_hour_satisfaction=4,
                karte_satisfaction=4,
                master_karte_satisfaction=0,
            ),
            this_month_type="サービスアンケート",
            no_send_reason=None,
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            create_at=datetime.now(),
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_at=datetime.now(),
        ).save()

        # supporter_users：未設定
        ProjectSurveyModel(
            id="44444449-5d63-42d4-ae1b-f0faf65a7076",
            data_type=DataType.SURVEY,
            survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
            survey_master_revision=4,
            survey_type="completion",
            project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
            project_name="サンプルプロジェクト",
            customer_success="DXの実現",
            supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
            supporter_organization_name="IST",
            support_date_from="2024/01/01",
            support_date_to="2024/06/30",
            main_supporter_user=SupporterUserAttribute(
                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                name="山田太郎",
                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                organization_name="IST",
            ),
            supporter_users=None,
            sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            service_type_name="組織開発",
            service_manager_id="8e394235-fde1-4546-a7e2-1f76e7ead6ac",
            service_manager_name="テスト太郎（サービス責任者）",
            answer_user_id="",
            answer_user_name="",
            dedicated_survey_user_name="匿名太郎",
            dedicated_survey_user_email="dedicated_taro@example.com",
            customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
            customer_name="あああ研究所",
            company="ソニーグループ株式会社",
            answers=[
                AnswersAttribute(
                    id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                    answer="問題なし",
                    point=3,
                )
            ],
            summary_month="2024/04",
            plan_survey_request_datetime="2024/04/15 01:00",
            actual_survey_request_datetime="2024/04/15 01:10",
            plan_survey_response_datetime="2024/04/30 17:00",
            actual_survey_response_datetime="2024/04/30 10:00",
            is_finished=True,
            is_disclosure=True,
            is_not_summary=False,
            unanswered_surveys_number=0,
            points=PointsAttribute(
                satisfaction=3,
                continuation=False,
                recommended=3,
                sales=0,
                survey_satisfaction=4,
                man_hour_satisfaction=4,
                karte_satisfaction=4,
                master_karte_satisfaction=0,
            ),
            this_month_type="サービスアンケート",
            no_send_reason=None,
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            create_at=datetime.now(),
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_at=datetime.now(),
        ).save()

        ProjectModel(
            id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
            data_type=DataType.PROJECT,
            salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
            customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
            name="サンプルプロジェクト１",
            customer_name="ソニーグループ株式会社",
            service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            create_new=True,
            continued=True,
            main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            contract_date="2021/01/30",
            phase="プラン提示(D)",
            customer_success="DXの実現",
            support_date_from="2022/01/01",
            support_date_to="2022/06/30",
            profit=GrossProfitAttribute(
                monthly=[
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                ],
                quarterly=[1200000, 1200000, 1200000, 1200000],
                half=[2400000, 2400000],
                year=4800000,
            ),
            total_contract_time=200,
            main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
            salesforce_main_customer=SalesforceMainCustomerAttribute(
                name="山田太郎",
                email="yamada@example.com",
                organization_name="IST",
                job="部長",
            ),
            customer_user_ids=set(list(["51ff73f4-2414-421c-b64c-9981f988b331"])),
            main_supporter_user_id="0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
            supporter_organization_id="5ed9544b-3a60-4e1b-896d-2ccf2427a440",
            salesforce_main_supporter_user_name="山田太郎",
            supporter_user_ids=set(list(["d18163da-adb0-42eb-9ba1-beeaa9039cf6"])),
            salesforce_supporter_user_names=["山田太郎", "山田次郎"],
            is_count_man_hour=True,
            is_karte_remind=True,
            contract_type="有償",
            is_secret=False,
            this_month_type="サービスアンケート",
            no_send_reason=None,
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            create_at=datetime.now(),
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_at=datetime.now(),
        ).save()
        # アンケート未送信の案件情報
        ProjectModel(
            id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
            data_type=DataType.PROJECT,
            salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
            customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
            name="サンプルプロジェクト２",
            customer_name="ソニーグループ株式会社",
            service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            create_new=True,
            continued=True,
            main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            contract_date="2021/01/30",
            phase="プラン提示(D)",
            customer_success="DXの実現",
            support_date_from="2022/01/01",
            support_date_to="2022/06/30",
            profit=GrossProfitAttribute(
                monthly=[
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                    400000,
                ],
                quarterly=[1200000, 1200000, 1200000, 1200000],
                half=[2400000, 2400000],
                year=4800000,
            ),
            total_contract_time=200,
            main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
            salesforce_main_customer=SalesforceMainCustomerAttribute(
                name="山田太郎",
                email="yamada@example.com",
                organization_name="IST",
                job="部長",
            ),
            customer_user_ids=set(list(["51ff73f4-2414-421c-b64c-9981f988b331"])),
            main_supporter_user_id="0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
            supporter_organization_id="5ed9544b-3a60-4e1b-896d-2ccf2427a440",
            salesforce_main_supporter_user_name="山田太郎",
            supporter_user_ids=set(list(["d18163da-adb0-42eb-9ba1-beeaa9039cf6"])),
            salesforce_supporter_user_names=["山田太郎", "山田次郎"],
            is_count_man_hour=True,
            is_karte_remind=True,
            contract_type="有償",
            is_secret=True,
            this_month_type="終了アンケート",
            no_send_reason="お客様の要望の為アンケートは未送信",
            create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
            update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
        ).save()

        UserModel(
            id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
            data_type=DataType.USER,
            name="田中 太郎",
            email="user@example.com",
            role=UserRoleType.CUSTOMER.key,
            customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
            customer_name="ソニーグループ株式会社",
            job="部長",
            company=None,
            supporter_organization_id=None,
            is_input_man_hour=None,
            project_ids=None,
            cognito_id=None,
            agreed=False,
            last_login_at=None,
            disabled=False,
            create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
        ).save()

        UserModel(
            id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
            data_type=DataType.USER,
            name="田中 次郎",
            email="user@example.com",
            role=UserRoleType.CUSTOMER.key,
            customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
            customer_name="ソニーグループ株式会社",
            job="部長",
            company=None,
            supporter_organization_id=None,
            is_input_man_hour=None,
            project_ids=None,
            cognito_id=None,
            agreed=False,
            last_login_at=None,
            disabled=False,
            create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
        ).save()
        UserModel(
            id="51ff73f4-2414-421c-b64c-9981f988b331",
            data_type=DataType.USER,
            name="田中 三郎",
            email="user@example.com",
            role=UserRoleType.CUSTOMER.key,
            customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
            customer_name="ソニーグループ株式会社",
            job="部長",
            company=None,
            supporter_organization_id=None,
            is_input_man_hour=None,
            project_ids=None,
            cognito_id=None,
            agreed=False,
            last_login_at=None,
            disabled=False,
            create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
        ).save()
        UserModel(
            id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
            data_type=DataType.USER,
            name="山田太郎",
            role=UserRoleType.SUPPORTER.key,
            email="taro.yamada@example.com",
            job="部長",
            supporter_organization_id=["de40733f-6be9-4fef-8229-01052f43c1e2"],
            organization_name="IST",
            cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
        ).save()
        UserModel(
            id="fee9f8ac-b968-40ce-9f68-32df0ad01957",
            data_type=DataType.USER,
            name="山田太郎２",
            role=UserRoleType.SUPPORTER.key,
            email="taro.yamada2@example.com",
            job="部長",
            supporter_organization_id=["bfecfa2c-8bf5-45cd-b011-95c67f169ab9"],
            organization_name="BIT",
            cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
        ).save()
        UserModel(
            id="0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
            data_type=DataType.USER,
            name="山田太郎３",
            role=UserRoleType.SUPPORTER.key,
            email="taro.yamada3@example.com",
            job="部長",
            supporter_organization_id=["5ed9544b-3a60-4e1b-896d-2ccf2427a440"],
            organization_name="QCT",
            cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
        ).save()
        UserModel(
            id="d18163da-adb0-42eb-9ba1-beeaa9039cf6",
            data_type=DataType.USER,
            name="山田太郎４",
            role=UserRoleType.SUPPORTER.key,
            email="taro.yamada4@example.com",
            job="部長",
            supporter_organization_id=["5ed9544b-3a60-4e1b-896d-2ccf2427a440"],
            organization_name="QCT",
            cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
        ).save()

        MasterSupporterOrganizationModel(
            id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
            data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
            name="組織開発",
            value=None,
            attributes=None,
            order=1,
            use=True,
            create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            create_at=datetime.now(),
            update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            update_at=datetime.now(),
        ).save()
        MasterSupporterOrganizationModel(
            id="de40733f-6be9-4fef-8229-01052f43c1e2",
            data_type=MasterDataType.MASTER_SUPPORTER_ORGANIZATION.value,
            name="Ideation Service Team",
            value="IST",
            attributes=None,
            order=1,
            use=True,
            create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            create_at=datetime.now(),
            update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            update_at=datetime.now(),
        ).save()
        MasterSupporterOrganizationModel(
            id="bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
            data_type=MasterDataType.MASTER_SUPPORTER_ORGANIZATION.value,
            name="Business Incubation Team",
            value="BIT",
            attributes=None,
            order=1,
            use=True,
            create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            create_at=datetime.now(),
            update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            update_at=datetime.now(),
        ).save()
        MasterSupporterOrganizationModel(
            id="5ed9544b-3a60-4e1b-896d-2ccf2427a440",
            data_type=MasterDataType.MASTER_SUPPORTER_ORGANIZATION.value,
            name="Quality and Compliance Team",
            value="QCT",
            attributes=None,
            order=1,
            use=True,
            create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            create_at=datetime.now(),
            update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
            update_at=datetime.now(),
        ).save()

    def teardown_method(self, method):
        ProjectSurveyModel.delete_table()
        ProjectModel.delete_table()
        UserModel.delete_table()
        MasterSupporterOrganizationModel.delete_table()

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SYSTEM_ADMIN.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/01",
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト１",
                            "id": "00000449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "2022/02",
                            "planSurveyRequestDatetime": "2022/02/15 01:00",
                            "actualSurveyRequestDatetime": None,
                            "planSurveyResponseDatetime": "2022/02/31 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2024/01/01",
                            "supportDateTo": "2024/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "8e394235-fde1-4546-a7e2-1f76e7ead6ac",
                                    "name": "テスト太郎（サービス責任者）",
                                    "organizationId": None,
                                    "organizationName": None,
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2024/04",
                            "planSurveyRequestDatetime": "2024/04/15 01:00",
                            "actualSurveyRequestDatetime": "2024/04/15 01:10",
                            "planSurveyResponseDatetime": "2024/04/30 17:00",
                            "actualSurveyResponseDatetime": "2024/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_ok_no_query_parameters_specified(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """クエリパラメータなし"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get("/api/surveys/plans", headers=REQUEST_HEADERS)
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SYSTEM_ADMIN.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_query_parameters_contains_summary_month(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """集計月絞り込み"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])

        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get(
            "/api/surveys/plans?summaryMonthFrom=202203&summaryMonthTo=202206",
            headers=REQUEST_HEADERS,
        )
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SURVEY_OPS.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_query_parameters_contains_single_summary_month(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """単月集計月絞り込み"""
        mock_auth_admin([UserRoleType.SURVEY_OPS.key])

        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get(
            "/api/surveys/plans?summaryMonthFrom=202206&summaryMonthTo=202206",
            headers=REQUEST_HEADERS,
        )
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SYSTEM_ADMIN.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_ok_query_parameters_contains_plan_survey_response_date(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """回答受信予定日絞り込み"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get(
            "/api/surveys/plans?planSurveyResponseDateFrom=20220429&planSurveyResponseDateTo=20220505",
            headers=REQUEST_HEADERS,
        )
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SALES_MGR.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/01",
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト１",
                            "id": "00000449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "2022/02",
                            "planSurveyRequestDatetime": "2022/02/15 01:00",
                            "actualSurveyRequestDatetime": None,
                            "planSurveyResponseDatetime": "2022/02/31 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2024/01/01",
                            "supportDateTo": "2024/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "8e394235-fde1-4546-a7e2-1f76e7ead6ac",
                                    "name": "テスト太郎（サービス責任者）",
                                    "organizationId": None,
                                    "organizationName": None,
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2024/04",
                            "planSurveyRequestDatetime": "2024/04/15 01:00",
                            "actualSurveyRequestDatetime": "2024/04/15 01:10",
                            "planSurveyResponseDatetime": "2024/04/30 17:00",
                            "actualSurveyResponseDatetime": "2024/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_auth_ok_sales_mgr(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """クエリパラメータなし"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get("/api/surveys/plans", headers=REQUEST_HEADERS)
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SALES.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/01",
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト１",
                            "id": "00000449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "2022/02",
                            "planSurveyRequestDatetime": "2022/02/15 01:00",
                            "actualSurveyRequestDatetime": None,
                            "planSurveyResponseDatetime": "2022/02/31 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2024/01/01",
                            "supportDateTo": "2024/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "8e394235-fde1-4546-a7e2-1f76e7ead6ac",
                                    "name": "テスト太郎（サービス責任者）",
                                    "organizationId": None,
                                    "organizationName": None,
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2024/04",
                            "planSurveyRequestDatetime": "2024/04/15 01:00",
                            "actualSurveyRequestDatetime": "2024/04/15 01:10",
                            "planSurveyResponseDatetime": "2024/04/30 17:00",
                            "actualSurveyResponseDatetime": "2024/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_auth_ok_sales(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """クエリパラメータなし"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get("/api/surveys/plans", headers=REQUEST_HEADERS)
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SURVEY_OPS.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/01",
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト１",
                            "id": "00000449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "2022/02",
                            "planSurveyRequestDatetime": "2022/02/15 01:00",
                            "actualSurveyRequestDatetime": None,
                            "planSurveyResponseDatetime": "2022/02/31 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2024/01/01",
                            "supportDateTo": "2024/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "8e394235-fde1-4546-a7e2-1f76e7ead6ac",
                                    "name": "テスト太郎（サービス責任者）",
                                    "organizationId": None,
                                    "organizationName": None,
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2024/04",
                            "planSurveyRequestDatetime": "2024/04/15 01:00",
                            "actualSurveyRequestDatetime": "2024/04/15 01:10",
                            "planSurveyResponseDatetime": "2024/04/30 17:00",
                            "actualSurveyResponseDatetime": "2024/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_auth_ok_survey_ops(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """クエリパラメータなし"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get("/api/surveys/plans", headers=REQUEST_HEADERS)
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SYSTEM_ADMIN.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/01",
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト１",
                            "id": "00000449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "2022/02",
                            "planSurveyRequestDatetime": "2022/02/15 01:00",
                            "actualSurveyRequestDatetime": None,
                            "planSurveyResponseDatetime": "2022/02/31 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2024/01/01",
                            "supportDateTo": "2024/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "8e394235-fde1-4546-a7e2-1f76e7ead6ac",
                                    "name": "テスト太郎（サービス責任者）",
                                    "organizationId": None,
                                    "organizationName": None,
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2024/04",
                            "planSurveyRequestDatetime": "2024/04/15 01:00",
                            "actualSurveyRequestDatetime": "2024/04/15 01:10",
                            "planSurveyResponseDatetime": "2024/04/30 17:00",
                            "actualSurveyResponseDatetime": "2024/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_auth_ok_system_admin(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """クエリパラメータなし"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get("/api/surveys/plans", headers=REQUEST_HEADERS)
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["de40733f-6be9-4fef-8229-01052f43c1e2"]
                    ),
                    organization_name="IST",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SUPPORTER_MGR.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/01",
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト１",
                            "id": "00000449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "2022/02",
                            "planSurveyRequestDatetime": "2022/02/15 01:00",
                            "actualSurveyRequestDatetime": None,
                            "planSurveyResponseDatetime": "2022/02/31 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2024/01/01",
                            "supportDateTo": "2024/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "8e394235-fde1-4546-a7e2-1f76e7ead6ac",
                                    "name": "テスト太郎（サービス責任者）",
                                    "organizationId": None,
                                    "organizationName": None,
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2024/04",
                            "planSurveyRequestDatetime": "2024/04/15 01:00",
                            "actualSurveyRequestDatetime": "2024/04/15 01:10",
                            "planSurveyResponseDatetime": "2024/04/30 17:00",
                            "actualSurveyResponseDatetime": "2024/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        # 自身の課以外の非公開案件：アクセス不可
                        # {
                        #     "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        #     "projectName": "サンプルプロジェクト２",
                        #     "id": None,
                        #     "surveyType": None,
                        #     "customerSuccess": "DXの実現",
                        #     "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                        #     "supporterOrganizationName": "QCT",
                        #     "supportDateFrom": "2022/01/01",
                        #     "supportDateTo": "2022/06/30",
                        #     "mainSupporterUser": {
                        #         "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                        #         "name": "山田太郎３",
                        #         "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                        #         "organizationName": "QCT",
                        #     },
                        #     "supporterUsers": [
                        #         {
                        #             "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                        #             "name": "山田太郎４",
                        #             "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                        #             "organizationName": "QCT",
                        #         }
                        #     ],
                        #     "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        #     "salesUserName": "田中 太郎",
                        #     "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        #     "serviceTypeName": "組織開発",
                        #     "surveyUserType": "登録済のお客様代表",
                        #     "surveyUserName": "田中 次郎",
                        #     "surveyUserEmail": "user@example.com",
                        #     "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        #     "customerName": "ソニーグループ株式会社",
                        #     "summaryMonth": "",
                        #     "planSurveyRequestDatetime": "",
                        #     "actualSurveyRequestDatetime": "",
                        #     "planSurveyResponseDatetime": "",
                        #     "actualSurveyResponseDatetime": "",
                        #     "phase": "プラン提示(D)",
                        #     "isCountManHour": True,
                        # },
                    ],
                },
            )
        ],
    )
    def test_auth_ok_supporter_mgr_1(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """支援者責任者：自身の課以外の非公開案件：アクセス不可"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get("/api/surveys/plans", headers=REQUEST_HEADERS)
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "admin_model, expected",
        [
            (
                AdminModel(
                    id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                    data_type=DataType.ADMIN,
                    name="ソニー太郎",
                    email="taro.sony@example.com",
                    job="部長",
                    supporter_organization_id=set(
                        ["5ed9544b-3a60-4e1b-896d-2ccf2427a440"]
                    ),
                    organization_name="QCT",
                    cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                    roles={UserRoleType.SUPPORTER_MGR.key},
                    otp_verified_token="111111",
                ),
                {
                    "surveys": [
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/01",
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト１",
                            "id": "00000449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "2022/02",
                            "planSurveyRequestDatetime": "2022/02/15 01:00",
                            "actualSurveyRequestDatetime": None,
                            "planSurveyResponseDatetime": "2022/02/31 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/03",
                            "planSurveyRequestDatetime": "2022/03/15 01:00",
                            "actualSurveyRequestDatetime": "2022/03/15 01:10",
                            "planSurveyResponseDatetime": "2022/03/30 17:00",
                            "actualSurveyResponseDatetime": "2022/03/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/04",
                            "planSurveyRequestDatetime": "2022/04/15 01:00",
                            "actualSurveyRequestDatetime": "2022/04/15 01:10",
                            "planSurveyResponseDatetime": "2022/04/30 17:00",
                            "actualSurveyResponseDatetime": "2022/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a22222",
                            "surveyType": "service",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "fee9f8ac-b968-40ce-9f68-32df0ad01957",
                                    "name": "山田太郎２",
                                    "organizationId": "bfecfa2c-8bf5-45cd-b011-95c67f169ab9",
                                    "organizationName": "BIT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "Salesforce取引先責任者",
                            "surveyUserName": "山田太郎",
                            "surveyUserEmail": "yamada@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2022/06",
                            "planSurveyRequestDatetime": "2022/06/15 01:00",
                            "actualSurveyRequestDatetime": "2022/06/15 01:10",
                            "planSurveyResponseDatetime": "2022/06/30 17:00",
                            "actualSurveyResponseDatetime": None,
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 1,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        {
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyType": "completion",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2024/01/01",
                            "supportDateTo": "2024/06/30",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "IST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "8e394235-fde1-4546-a7e2-1f76e7ead6ac",
                                    "name": "テスト太郎（サービス責任者）",
                                    "organizationId": None,
                                    "organizationName": None,
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "手動設定",
                            "surveyUserName": "匿名太郎",
                            "surveyUserEmail": "dedicated_taro@example.com",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "summaryMonth": "2024/04",
                            "planSurveyRequestDatetime": "2024/04/15 01:00",
                            "actualSurveyRequestDatetime": "2024/04/15 01:10",
                            "planSurveyResponseDatetime": "2024/04/30 17:00",
                            "actualSurveyResponseDatetime": "2024/04/30 10:00",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": 0,
                            "thisMonthType": "サービスアンケート",
                            "noSendReason": None,
                        },
                        # 自身の課の非公開案件：アクセス可
                        {
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "id": None,
                            "surveyType": None,
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                            "supporterOrganizationName": "QCT",
                            "supportDateFrom": "2022/01/01",
                            "supportDateTo": "2022/06/30",
                            "mainSupporterUser": {
                                "id": "0f8ff927-3f37-492c-9dea-8a61a0d1ddc0",
                                "name": "山田太郎３",
                                "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                "organizationName": "QCT",
                            },
                            "supporterUsers": [
                                {
                                    "id": "d18163da-adb0-42eb-9ba1-beeaa9039cf6",
                                    "name": "山田太郎４",
                                    "organizationId": "5ed9544b-3a60-4e1b-896d-2ccf2427a440",
                                    "organizationName": "QCT",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "surveyUserType": "登録済のお客様代表",
                            "surveyUserName": "田中 次郎",
                            "surveyUserEmail": "user@example.com",
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "customerName": "ソニーグループ株式会社",
                            "summaryMonth": "",
                            "planSurveyRequestDatetime": "",
                            "actualSurveyRequestDatetime": "",
                            "planSurveyResponseDatetime": "",
                            "actualSurveyResponseDatetime": "",
                            "phase": "プラン提示(D)",
                            "isCountManHour": True,
                            "unansweredSurveysNumber": None,
                            "thisMonthType": "終了アンケート",
                            "noSendReason": "お客様の要望の為アンケートは未送信",
                        },
                    ],
                },
            )
        ],
    )
    def test_auth_ok_supporter_mgr_2(
        self,
        mocker,
        mock_auth_admin,
        admin_model,
        expected,
    ):
        """支援者責任者：自身の課の非公開案件：アクセス可"""
        mock_auth_admin([UserRoleType.MAN_HOUR_OPS.key])
        # mock_auth_adminのユーザ部分を上書き
        mock = mocker.patch.object(AdminModel, "get_admin_by_cognito_id")
        mock.return_value = admin_model

        response = client.get("/api/surveys/plans", headers=REQUEST_HEADERS)
        actual = response.json()

        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param",
        [
            "?summaryMonthFrom=2022013",
            "?summaryMonthTo=2022013",
            "?planSurveyResponseDateFrom=202203011",
            "?planSurveyResponseDateTo=202203011",
            "?summaryMonthFrom=202212&planSurveyResponseDateFrom=20221231",
            "?summaryMonthFrom=202303&summaryMonthTo=202204",
            "?planSurveyResponseDateFrom=20230301&planSurveyResponseDateTo=20220401",
        ],
    )
    def test_validation(self, mock_auth_admin, query_param):
        mock_auth_admin([UserRoleType.SYSTEM_ADMIN.key])

        response = client.get(
            f"/api/surveys/plans{query_param}", headers=REQUEST_HEADERS
        )
        assert response.status_code == 400
