# Pleasanter移行 詳細工数見積書

## 📋 概要

本書は、双日ライフワン光熱費管理システムのPleasanter移行における詳細な工数見積もりを、テーブル単位・モジュール単位で精緻化したものです。

**作成日**: 2025-07-07  
**総工数**: 133人日（当初見積もり）→ 145人日（詳細見積もり）  
**期間**: 6.5ヶ月

---

## 🏗️ テーブル別詳細工数見積もり

### 1. マスターテーブル群（計25人日）

| テーブル名 | 用途 | レコード数 | 設計 | 実装 | テスト | 小計 |
|-----------|------|-----------|------|------|---------|------|
| **施設マスター** | 施設・建物情報管理 | 約50件 | 1日 | 2日 | 1日 | 4日 |
| **テナントマスター** | テナント基本情報 | 約100件 | 1日 | 2日 | 1日 | 4日 |
| **グループマスター** | 16/2/78/9グループ定義 | 4件 | 0.5日 | 1日 | 0.5日 | 2日 |
| **料金マスター** | ガス・電力単価設定 | 約20件 | 1日 | 2日 | 1日 | 4日 |
| **按分ルールマスター** | 按分計算ルール | 約200件 | 2日 | 3日 | 2日 | 7日 |
| **ユーザーマスター** | アクセス権限管理 | 約30件 | 1日 | 2日 | 1日 | 4日 |

### 2. トランザクションテーブル群（計35人日）

| テーブル名 | 用途 | 月間レコード数 | 設計 | 実装 | テスト | 小計 |
|-----------|------|---------------|------|------|---------|------|
| **検針データ** | CSVインポート用 | 約500件/月 | 2日 | 4日 | 2日 | 8日 |
| **月次集計** | グループ別集計値 | 約100件/月 | 2日 | 3日 | 2日 | 7日 |
| **テナント別明細** | 按分後の個別データ | 約300件/月 | 2日 | 4日 | 2日 | 8日 |
| **承認履歴** | ワークフロー管理 | 約50件/月 | 1日 | 3日 | 1日 | 5日 |
| **エラーログ** | インポートエラー管理 | 変動 | 1日 | 2日 | 1日 | 4日 |
| **レポート出力** | 帳票生成管理 | 約20件/月 | 1日 | 1日 | 1日 | 3日 |

### 3. ビュー・ダッシュボード（計15人日）

| 項目 | 内容 | 設計 | 実装 | テスト | 小計 |
|------|------|------|------|--------|------|
| **月次推移ビュー** | 12ヶ月の推移表示 | 1日 | 2日 | 1日 | 4日 |
| **前年比較ビュー** | 前年同月比較 | 1日 | 2日 | 1日 | 4日 |
| **グループ別ダッシュボード** | KPI表示 | 1日 | 3日 | 1日 | 5日 |
| **異常値一覧** | アラート表示 | 0.5日 | 1日 | 0.5日 | 2日 |

---

## 🔄 VBAモジュール → Pleasanterマッピング表

### 計算用管理変動費Master.xls（13モジュール → 実質3機能）

| VBAモジュール | 行数 | 主要機能 | 移行先 | 実装方法 | 工数 |
|--------------|------|----------|--------|----------|------|
| **Module1** | 150行 | FDに値のコピー | 月次集計テーブル | サーバースクリプト | 3日 |
| **Module3** | 194行 | 管理変動費master用FD作成 | レポート出力 | エクスポート機能 | 2日 |
| **Module4** | 20行 | テスト（水道光熱費） | **不要** | - | 0日 |
| **Module2** | 2行 | 空モジュール | **不要** | - | 0日 |
| その他9モジュール | 127行 | 単純コピー処理 | **不要** | 標準機能で代替 | 0日 |

**削減率**: 13モジュール → 2機能（85%削減）

### MO報告光熱費.xls（29モジュール → 実質8機能）

| VBAモジュール | 行数 | 主要機能 | 移行先 | 実装方法 | 工数 |
|--------------|------|----------|--------|----------|------|
| **Module1** | 262行 | 準備1、テナント検針データコピー | 検針データテーブル | CSVインポート | 5日 |
| **Module15** | 292行 | 電気合計チェック | 月次集計テーブル | バリデーション | 3日 |
| **Module9** | 264行 | JM報告電気データ入力 | テナント別明細 | フォーム入力 | 2日 |
| **Module13** | 161行 | 前年データのコピー | 前年比較ビュー | ビュー機能 | 1日 |
| **Module16** | 136行 | フードアレイ光熱費作成 | レポート出力 | テンプレート | 2日 |
| **Module6** | 102行 | 空調データ取込み | 按分ルールマスター | サーバースクリプト | 3日 |
| **Module7** | 87行 | 準備2、準備3 | **Module1に統合** | - | 0日 |
| **Module5** | 73行 | 光熱費管理変動費コピー | **不要** | 自動計算で代替 | 0日 |
| **Module10** | 60行 | 数値のコピー | **不要** | - | 0日 |
| その他20モジュール | 228行 | 単純処理・空 | **不要** | - | 0日 |

**削減率**: 29モジュール → 8機能（72%削減）

---

## 🚧 ボトルネック分析と対策

### 1. 技術的ボトルネック

| ボトルネック | 影響度 | 原因 | 対策 | 追加工数 |
|-------------|--------|------|------|----------|
| **CSVインポート処理** | 高 | 複雑な検証ロジック | 段階的インポート実装 | +3日 |
| **按分計算の複雑性** | 高 | 多様な按分パターン | ルールエンジン実装 | +5日 |
| **レガシーデータ移行** | 中 | データ形式の不統一 | ETLツール作成 | +4日 |
| **権限管理の細分化** | 中 | 複雑な組織構造 | 階層型権限設計 | +2日 |

### 2. 業務的ボトルネック

| ボトルネック | 影響度 | 原因 | 対策 | 追加工数 |
|-------------|--------|------|------|----------|
| **ユーザー教育** | 高 | 操作方法の大幅変更 | 段階的移行・研修 | +5日 |
| **並行稼働期間** | 中 | データ整合性確保 | 同期ツール開発 | +3日 |
| **承認フロー確立** | 中 | 新規プロセス | ワークフロー設計 | +2日 |

---

## 📊 工程別詳細見積もり

### Phase 1: 要件定義・設計（30人日）

| 作業項目 | 詳細 | 工数 |
|---------|------|------|
| 現行システム分析 | VBAコード解析、業務フロー整理 | 5日 |
| 要件定義 | ステークホルダーヒアリング | 5日 |
| 基本設計 | アーキテクチャ、データモデル | 8日 |
| 詳細設計 | 画面設計、帳票設計、IF設計 | 10日 |
| 設計レビュー | 品質確認、修正 | 2日 |

### Phase 2: 開発（70人日）

| 作業項目 | 詳細 | 工数 |
|---------|------|------|
| 環境構築 | Pleasanter設定、開発環境 | 3日 |
| マスター開発 | 6テーブル実装 | 15日 |
| トランザクション開発 | 6テーブル実装 | 20日 |
| 機能開発 | スクリプト、バッチ処理 | 20日 |
| 画面開発 | ビュー、ダッシュボード | 10日 |
| 単体テスト | 開発者テスト | 2日 |

### Phase 3: テスト（25人日）

| 作業項目 | 詳細 | 工数 |
|---------|------|------|
| 結合テスト | 機能間連携テスト | 8日 |
| システムテスト | E2Eテスト | 7日 |
| 性能テスト | 負荷テスト、チューニング | 5日 |
| 受入テスト | ユーザー確認 | 5日 |

### Phase 4: 移行・導入（20人日）

| 作業項目 | 詳細 | 工数 |
|---------|------|------|
| データ移行 | 本番データ投入 | 5日 |
| 並行稼働 | 新旧システム並行運用 | 5日 |
| ユーザー研修 | 操作説明、マニュアル作成 | 5日 |
| 本番切替 | 最終確認、切替作業 | 3日 |
| 運用引継ぎ | 保守手順説明 | 2日 |

---

## 💰 コスト内訳（詳細）

### 開発費用
- **基本開発費**: 145人日 × 7万円 = 1,015万円
- **追加対応費**: 24人日分（ボトルネック対策）含む
- **ライセンス費**: Pleasanter利用料（月額）

### 削減効果
- **工数削減**: VBAコード85%削減による保守工数減
- **作業時間**: 月40時間 → 月10時間（75%削減）
- **年間効果**: 360万円の人件費削減

---

## 📌 成功のための重要ポイント

1. **段階的移行**: 一度に全機能を移行せず、重要機能から順次移行
2. **並行稼働期間**: 最低1ヶ月の新旧システム並行運用
3. **ユーザー教育**: 十分な研修時間の確保（5日間）
4. **データ品質**: 移行前のデータクレンジング徹底
5. **カスタマイズ最小化**: Pleasanter標準機能の最大活用

---

## 🔄 更新履歴
| 日付 | 更新内容 | 更新者 |
|------|---------|--------|
| 2025-07-07 | 初版作成 | Claude |

---

*本見積書は、VBAコード分析とPleasanter実装経験に基づく詳細見積もりです*