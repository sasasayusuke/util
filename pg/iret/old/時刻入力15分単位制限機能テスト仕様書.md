# 時刻入力15分単位制限機能テスト仕様書

## 📋 概要

支援日スケジュール追加・個別カルテ入力・BO画面等での時刻入力において、分の選択肢を15分単位（0・15・30・45）にする機能のテスト仕様書です。
ユーザビリティ向上のため、時刻選択時のスクロール操作を削減し、一般的な会議時間に合わせた時刻設定を可能にします。

### 現在の実装状況
- **VueTimePickerコンポーネント**: 15分単位制限機能が実装済み（`:step="15"`プロパティ）
- **支援スケジュール作成・編集**: 既に15分単位制限を使用中
- **個別カルテ時刻入力**: 既に15分単位制限を使用中
- **直接入力**: HTML5 time input使用時は制限なし（要件通り）

---

## 🔍 要件と現在実装の差異

| 項目 | 要件 | 現在の実装 | 状態 |
|------|------|-----------|------|
| **支援スケジュール追加** | 15分単位制限 | ✅ `:step="15"` 実装済み | ✅ 実装済み |
| **支援スケジュール編集** | 15分単位制限 | ✅ `:step="15"` 実装済み | ✅ 実装済み |
| **個別カルテ時刻入力** | 15分単位制限 | ✅ `:step="15"` 実装済み | ✅ 実装済み |
| **BO画面時刻入力** | 15分単位制限 | ✅ 同じコンポーネント使用 | ✅ 実装済み |
| **直接入力時制限なし** | 制限不要 | ✅ HTML5 time inputで自由入力可能 | ✅ 実装済み |

---

## 🎯 テスト目的

1. **15分単位制限確認**: 時刻選択時に0、15、30、45分のみ選択可能であることを確認
2. **直接入力自由度確認**: キーボード入力時は任意の分が入力可能であることを確認
3. **ユーザビリティ確認**: スクロール操作が削減され、操作が簡単になることを確認
4. **機能一貫性確認**: 全ての時刻入力画面で同様の制限が適用されることを確認
5. **既存機能影響確認**: 15分単位制限が既存機能に悪影響を与えないことを確認

---

## 👥 テスト実施可能ロール

| ロール | 日本語名 | スケジュール作成 | カルテ編集 | BO画面アクセス | 備考 |
|--------|----------|----------------|-----------|---------------|------|
| **supporter** | 支援者 | ✅ | ✅ | ❌ | FO画面メインテストロール |
| **supporter_mgr** | 支援者責任者 | ✅ | ✅ | ✅ | 全画面テスト可能 |
| **business_mgr** | 事業責任者 | ✅ | ✅ | ✅ | 全権限 |
| **sales** | 営業担当者 | ✅ | ❌ | ❌ | スケジュール作成のみ |
| **system_admin** | システム管理者 | ✅ | ✅ | ✅ | BO画面含む全テスト |

---

## 📊 テスト前準備（データ作成手順）

### STEP 1: テスト用ユーザー作成

#### 1-1. 支援者（supporter）の作成
```
必要データ:
- ユーザーID: test-supporter-time-001
- 名前: 時刻入力テスト支援者
- メールアドレス: time-supporter@example.com
- ロール: supporter
```

#### 1-2. システム管理者（system_admin）の作成
```
必要データ:
- ユーザーID: test-admin-time-001
- 名前: 時刻入力テスト管理者
- メールアドレス: time-admin@example.com
- ロール: system_admin
```

### STEP 2: テスト用プロジェクト作成

```
必要データ:
- プロジェクトID: test-project-time-001
- プロジェクト名: 時刻入力15分単位テストプロジェクト
- 顧客名: タイム株式会社
- 主担当支援者ID: test-supporter-time-001
- 支援開始日: 2024/01/01
- 支援終了日: 2024/12/31
```

### STEP 3: テスト用カルテ作成

```
必要データ:
- 事前にスケジュール作成してカルテを自動生成
- 編集用の下書きカルテを準備
```

---

## 🧪 テストケース詳細

### 【テストケース TC-TIME-001】支援スケジュール追加時の15分単位制限確認

#### 実施ロール: supporter（支援者）

#### 手順:
1. **FO画面にsupporterでログイン**
   - URL: `/`
   - 期待結果: HOME画面が表示される

2. **プロジェクト詳細画面にアクセス**
   - 操作: プロジェクト一覧 → テスト用プロジェクトをクリック
   - URL: `/project/test-project-time-001`
   - 期待結果: プロジェクト詳細画面が表示される

3. **支援スケジュール追加モーダルを開く**
   - 操作: 「支援スケジュール追加」ボタンをクリック
   - 期待結果: ProjectSupportAddModalが表示される

4. **開始時刻の時刻ピッカーを確認**
   - 操作: 開始時刻フィールドをクリック
   - 期待結果: 時刻選択ピッカーが表示される

5. **分の選択肢を確認**
   - 確認項目: 分の選択肢が0、15、30、45のみ表示される
   - 操作: 分のセクションをスクロールして選択肢を確認
   - 期待結果: ✅ 0、15、30、45分のみ選択可能

6. **終了時刻でも同様に確認**
   - 操作: 終了時刻フィールドをクリック
   - 確認項目: 同じく0、15、30、45分のみ選択可能
   - 期待結果: ✅ 一貫して15分単位制限が適用される

7. **時刻設定と保存**
   - 操作: 開始時刻「10:15」、終了時刻「12:30」を選択
   - 操作: その他必須項目を入力して「保存」をクリック
   - 期待結果: ✅ 正常に保存される

#### 判定基準:
- ✅ **PASS**: 分の選択肢が0、15、30、45のみで、正常に保存される
- ❌ **FAIL**: 他の分が選択可能、または保存に失敗する

---

### 【テストケース TC-TIME-002】支援スケジュール編集時の15分単位制限確認

#### 実施ロール: supporter（支援者）

#### 手順:
1. **既存スケジュールの編集**
   - 前提: TC-TIME-001で作成したスケジュールを使用
   - 操作: プロジェクト詳細 → スケジュール一覧 → 「編集」ボタンをクリック
   - 期待結果: ProjectSupportEditModalが表示される

2. **現在の時刻設定を確認**
   - 確認項目: 開始時刻「10:15」、終了時刻「12:30」が正しく表示される
   - 期待結果: ✅ 15分単位の時刻が正しく読み込まれる

3. **時刻変更時の制限確認**
   - 操作: 開始時刻を変更しようとする
   - 確認項目: 分の選択肢が0、15、30、45のみ
   - 期待結果: ✅ 編集時も15分単位制限が適用される

4. **時刻変更と保存**
   - 操作: 開始時刻を「09:45」、終了時刻を「11:00」に変更
   - 操作: 「保存」をクリック
   - 期待結果: ✅ 変更が正常に保存される

#### 判定基準:
- ✅ **PASS**: 編集時も15分単位制限が機能し、変更が保存される
- ❌ **FAIL**: 制限が機能しない、または保存に失敗する

---

### 【テストケース TC-TIME-003】個別カルテ時刻入力の15分単位制限確認

#### 実施ロール: supporter（支援者）

#### 手順:
1. **カルテ詳細画面にアクセス**
   - 操作: カルテ一覧 → 編集対象カルテをクリック
   - URL: `/karte/{karteId}`
   - 期待結果: カルテ詳細画面が表示される

2. **編集モードに切り替え**
   - 操作: 「編集」ボタンをクリック
   - 期待結果: カルテ編集モードになる

3. **実施時間（開始時刻）の時刻入力確認**
   - 操作: 実施時間の開始時刻フィールドをクリック
   - 確認項目: 時刻ピッカーが表示される
   - 期待結果: ✅ 時刻選択UI が表示される

4. **分の選択肢確認**
   - 確認項目: 分の選択肢が0、15、30、45のみ表示される
   - 期待結果: ✅ 15分単位制限が適用される

5. **実施時間（終了時刻）でも同様に確認**
   - 操作: 終了時刻フィールドをクリック
   - 確認項目: 同じく0、15、30、45分のみ選択可能
   - 期待結果: ✅ 一貫して制限が適用される

6. **時刻設定と保存**
   - 操作: 開始時刻「14:00」、終了時刻「16:15」を設定
   - 操作: その他項目を入力して「保存」をクリック
   - 期待結果: ✅ カルテが正常に保存される

#### 判定基準:
- ✅ **PASS**: カルテ時刻入力でも15分単位制限が機能する
- ❌ **FAIL**: 制限が機能しない、またはカルテ保存に失敗する

---

### 【テストケース TC-TIME-004】BO画面時刻入力の15分単位制限確認

#### 実施ロール: system_admin（システム管理者）

#### 手順:
1. **BO画面にsystem_adminでログイン**
   - URL: `/admin/`
   - 期待結果: BO管理画面にログイン成功

2. **プロジェクト管理画面にアクセス**
   - 操作: ヘッダー → 案件管理 → プロジェクト詳細
   - 期待結果: BOのプロジェクト詳細画面が表示される

3. **支援スケジュール管理での時刻入力確認**
   - 操作: 支援スケジュール追加/編集機能にアクセス
   - 確認項目: BOでも同じVueTimePickerコンポーネントが使用されている
   - 期待結果: ✅ FO画面と同様の15分単位制限が適用される

4. **時刻選択と動作確認**
   - 操作: 時刻ピッカーを使用して時刻を選択
   - 確認項目: 分の選択肢が0、15、30、45のみ
   - 期待結果: ✅ BO画面でも制限が正常に機能する

#### 判定基準:
- ✅ **PASS**: BO画面でも15分単位制限が一貫して適用される
- ❌ **FAIL**: BO画面で制限が機能しない

---

### 【テストケース TC-TIME-005】直接入力時の制限なし確認

#### 実施ロール: supporter（支援者）

#### 手順:
1. **スケジュール追加画面で直接入力テスト**
   - 前提: TC-TIME-001の支援スケジュール追加画面
   - 操作: 時刻フィールドに直接キーボードで入力を試行

2. **HTML5 time input の直接入力確認**
   - 操作: 開始時刻フィールドで「10:07」と直接入力
   - 期待結果: ✅ 15分単位以外の分も入力可能

3. **任意の分での入力テスト**
   - 操作: 以下の時刻を直接入力してテスト:
     - 「09:05」（5分）
     - 「14:22」（22分）
     - 「16:37」（37分）
     - 「18:59」（59分）
   - 期待結果: ✅ 全て入力・保存可能

4. **保存と表示確認**
   - 操作: 直接入力した時刻でスケジュールを保存
   - 確認項目: 保存後の表示で入力した時刻が正しく表示される
   - 期待結果: ✅ 15分単位以外の時刻も正常に保存・表示される

#### 判定基準:
- ✅ **PASS**: 直接入力時は15分単位制限が適用されない
- ❌ **FAIL**: 直接入力でも制限がかかる、または保存できない

---

### 【テストケース TC-TIME-006】ユーザビリティ改善効果確認

#### 実施ロール: supporter（支援者）

#### 手順:
1. **操作時間の測定（15分単位制限あり）**
   - 操作: 時刻ピッカーで「10:30」を選択する時間を測定
   - 確認項目: スクロール操作の回数と時間
   - 期待結果: 少ない操作で目的の時刻を選択可能

2. **操作時間の測定（制限なしとの比較想定）**
   - 想定: 60分全ての選択肢がある場合の操作時間
   - 比較: 15分単位制限による操作時間短縮効果
   - 期待結果: ✅ 明らかな操作時間短縮

3. **視認性の確認**
   - 確認項目: 時刻ピッカーの分選択肢の見やすさ
   - 確認項目: 一般的な会議時間（00、15、30、45分）への適合性
   - 期待結果: ✅ 直感的で使いやすいUI

4. **一般的な会議時間との適合性確認**
   - 確認項目: ビジネスでよく使用される時刻が設定可能
   - 例: 9:00-10:30、14:15-15:45など
   - 期待結果: ✅ 実用的な時刻設定が可能

#### 判定基準:
- ✅ **PASS**: 操作時間短縮効果があり、実用的
- ❌ **FAIL**: 操作性に問題がある、または実用性が低い

---

### 【テストケース TC-TIME-007】時刻フォーマット・バリデーション確認

#### 実施ロール: supporter（支援者）

#### 手順:
1. **正常な時刻フォーマットの確認**
   - 操作: 15分単位の時刻を設定（例：「09:15」）
   - 確認項目: HH:mm形式で正しく表示される
   - 期待結果: ✅ 標準的な時刻フォーマットで表示

2. **異常値入力時の動作確認**
   - 操作: 無効な時刻を直接入力（例：「25:70」）
   - 期待結果: ✅ 適切なバリデーションエラーが表示される

3. **開始時刻 > 終了時刻の場合の確認**
   - 操作: 開始時刻「15:30」、終了時刻「14:00」を設定
   - 期待結果: ✅ 論理エラーが検出される

4. **必須入力チェック**
   - 操作: 時刻フィールドを空欄のまま保存を試行
   - 期待結果: ✅ 必須入力エラーが表示される

#### 判定基準:
- ✅ **PASS**: 適切なバリデーションが機能する
- ❌ **FAIL**: バリデーションが不十分、またはエラー処理に問題

---

### 【テストケース TC-TIME-008】レスポンシブ対応確認

#### 実施ロール: supporter（支援者）

#### 手順:
1. **PC画面での時刻入力確認**
   - 画面サイズ: 1920x1080
   - 操作: 時刻ピッカーの表示と操作性を確認
   - 期待結果: ✅ 15分単位制限が正常に機能

2. **タブレット画面での確認**
   - 画面サイズ: 768x1024
   - 操作: タッチ操作で時刻選択
   - 期待結果: ✅ タッチデバイスでも操作可能

3. **スマートフォン画面での確認**
   - 画面サイズ: 375x667
   - 操作: 小画面での時刻ピッカー表示
   - 期待結果: ✅ 適切にレイアウトされる

4. **HTML5 time input フォールバックの確認**
   - 確認項目: Vuetifyピッカーが利用できない環境でのHTML5フォールバック
   - 期待結果: ✅ 代替手段が適切に動作

#### 判定基準:
- ✅ **PASS**: 全画面サイズ・デバイスで適切に動作
- ❌ **FAIL**: 特定環境で動作に問題

---

## 📋 テスト実施チェックリスト

### 機能テスト
- [ ] TC-TIME-001: 支援スケジュール追加時の15分単位制限
- [ ] TC-TIME-002: 支援スケジュール編集時の15分単位制限
- [ ] TC-TIME-003: 個別カルテ時刻入力の15分単位制限
- [ ] TC-TIME-004: BO画面時刻入力の15分単位制限
- [ ] TC-TIME-005: 直接入力時の制限なし確認
- [ ] TC-TIME-006: ユーザビリティ改善効果確認
- [ ] TC-TIME-007: 時刻フォーマット・バリデーション確認
- [ ] TC-TIME-008: レスポンシブ対応確認

### 影響範囲確認
- [ ] 既存データの表示に問題なし
- [ ] 既存スケジュール・カルテの編集に問題なし
- [ ] API応答への影響なし
- [ ] パフォーマンスへの影響なし

---

## 🚨 既知の実装状況

| 対象画面/機能 | 実装状況 | 使用コンポーネント | ステップ設定 |
|-------------|----------|-------------------|------------|
| **支援スケジュール追加** | ✅ 実装済み | VueTimePicker | `:step="15"` |
| **支援スケジュール編集** | ✅ 実装済み | VueTimePicker | `:step="15"` |
| **個別カルテ時刻入力** | ✅ 実装済み | VueTimePicker | `:step="15"` |
| **BO画面各機能** | ✅ 実装済み | 同じコンポーネント | `:step="15"` |
| **直接入力制限なし** | ✅ 実装済み | HTML5 time input | 制限なし |

---

## 🎯 テスト完了判定基準

### ✅ 全テストPASS条件
1. **全画面で15分単位制限が正常に機能**
2. **直接入力時は制限が適用されない**
3. **ユーザビリティが向上している**
4. **既存機能に悪影響がない**
5. **全デバイス・画面サイズで正常動作**

### 🎯 ユーザビリティ改善効果の測定
1. **スクロール操作削減**: 分選択の操作時間が従来比75%短縮
2. **直感的操作**: 一般的な会議時間（15分単位）に即座に設定可能
3. **操作エラー削減**: 意図しない分設定を防止

---

## 📊 性能・操作性基準

| 項目 | 目標値 | 測定方法 |
|------|--------|----------|
| **時刻選択操作時間** | 3秒以内 | 目的時刻選択までの操作時間 |
| **画面表示時間** | 1秒以内 | 時刻ピッカー表示時間 |
| **スクロール回数** | 4回以下 | 目的分到達までのスクロール |

---

## ⚠️ 注意事項・制約

1. **直接入力の優先**: キーボード入力時は15分制限を適用しない
2. **既存データ互換性**: 15分単位以外の既存時刻データも正常表示
3. **段階的適用**: 各画面で個別にstepプロパティを設定済み
4. **フォールバック対応**: Vuetifyピッカー非対応環境ではHTML5 time input使用

---

## 📞 問題発生時の連絡先

- **システム管理者**: [連絡先]
- **開発チーム**: [連絡先]
- **UX/UI担当**: [連絡先]

---

*このテスト仕様書は、時刻入力の15分単位制限機能の動作確認とユーザビリティ改善効果の検証を目的としています。*
*機能は既に実装済みのため、テストは動作確認と改善効果の測定に重点を置いて実施してください。*