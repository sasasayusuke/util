from datetime import datetime

import pytest
from fastapi.testclient import TestClient
from pynamodb.exceptions import PutError
from pynamodb.models import BatchWrite
from pytz import timezone

from app.main import app
from app.models.admin import AdminModel
from app.models.customer import CustomerModel
from app.models.master import MasterSupporterOrganizationModel
from app.models.project import ProjectModel
from app.models.user import UserModel
from app.resources.const import DataType, MasterDataType, TimezoneType, UserRoleType
from app.service.customer_service import CustomerService
from app.utils.aws.s3 import S3Helper
from app.utils.aws.sqs import SqsHelper
from app.utils.platform import PlatformApiOperator

client = TestClient(app)
jst = timezone(TimezoneType.UTC)

REQUEST_HEADERS = {"x-otp-verified-token": "111111"}


class TestImportProjects:
    @pytest.mark.parametrize(
        "role_types",
        [
            [UserRoleType.SYSTEM_ADMIN.key],
            [UserRoleType.SALES.key],
            [UserRoleType.SALES_MGR.key],
            [UserRoleType.SUPPORTER_MGR.key],
            [UserRoleType.SURVEY_OPS.key],
            [UserRoleType.MAN_HOUR_OPS.key],
            [UserRoleType.BUSINESS_MGR.key],
        ]
    )
    def test_access_ok(
        self,
        mock_auth_admin,
        role_types,
    ):
        mock_auth_admin(role_types)
        response = client.post(
            "/api/projects/import", headers=REQUEST_HEADERS
        )

        assert response.status_code == 422

    @pytest.mark.parametrize(
        "body, s3_value, customer_models, master_models, user_models, project_models, expected",
        [
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"\n"9999h000002Ts19","9999a99999RYLbr","2022/05/13 8:27","アアアアア2022","アアアアアKxxxxx","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","1","0","田中 三郎","test@sample.com","","","田中 三郎","2021/07/29","内部決済完了(A)","2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了","2022/04/01","2022/05/31","","2000000","","","","","","","","","","","2000000","0","0","0","2000000","0","2000000","","3000000","","","","","","","","","","","3000000","0","0","0","3000000","0","3000000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","5.9"\n',
                [
                    CustomerModel(
                        id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        data_type=DataType.CUSTOMER,
                        name="一般社団法人アアアアア",
                        category="ソニーグループ",
                        salesforce_customer_id="9999a99999RYLbr",
                        salesforce_update_at=CustomerService.jst.localize(
                            datetime.strptime(
                                "2022/01/16 8:07",
                                "%Y/%m/%d %H:%M",
                            )
                        ),
                        salesforce_target=None,
                        salesforce_credit_limit=None,
                        salesforce_credit_get_month=None,
                        salesforce_credit_manager=None,
                        salesforce_credit_no_retry=None,
                        salesforce_paws_credit_number=None,
                        salesforce_customer_owner=None,
                        salesforce_customer_segment=None,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at=datetime.strptime(
                            "2020-10-23T02:21:39.356000+0000",
                            "%Y-%m-%dT%H:%M:%S.%f+0000",
                        ),
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at=datetime.strptime(
                            "2020-10-23T04:21:39.356000+0000",
                            "%Y-%m-%dT%H:%M:%S.%f+0000",
                        ),
                        version=1,
                    ),
                ],
                [
                    MasterSupporterOrganizationModel(
                        id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                        name="組織開発",
                        value=None,
                        attributes=None,
                        order=1,
                        use=True,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T04:21:39.356000+0000",
                        version=1,
                    ),
                    MasterSupporterOrganizationModel(
                        id="bad0b57c-de29-48e0-9deb-94be98437441",
                        data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                        name="アイデア可視化",
                        value=None,
                        attributes=None,
                        order=1,
                        use=True,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T04:21:39.356000+0000",
                        version=1,
                    ),
                    MasterSupporterOrganizationModel(
                        id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                        data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                        name="Ideation Service Team",
                        value="IST",
                        attributes=None,
                        order=1,
                        use=True,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T04:21:39.356000+0000",
                        version=1,
                    ),
                ],
                [
                    UserModel(
                        id="a9b67094-cdab-494c-818e-d4845088269b",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.SUPPORTER.key,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="b9b67094-cdab-494c-818e-d4845088269b",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.SUPPORTER.key,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="c9b67094-cdab-494c-818e-d4845088269b",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.SALES.key,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                ],
                [
                    ProjectModel(
                        id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                        data_type=DataType.PROJECT,
                        customer_id="11cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                        salesforce_customer_id="9999a99999RYLbr",
                        salesforce_opportunity_id="9999h000001AAAAA",
                        salesforce_update_at=CustomerService.jst.localize(
                            datetime.strptime(
                                "2022/05/01 8:07",
                                "%Y/%m/%d %H:%M",
                            )
                        ),
                        name="サンプルプロジェクト",
                        customer_name="ソニーグループ株式会社",
                        service_type=None,
                        create_new=None,
                        continued=None,
                        main_sales_user_id="c67b0ca2270d",
                        contract_date=None,
                        phase=None,
                        customer_success=None,
                        support_date_from="2021/03/01",
                        support_date_to="2022/02/28",
                        profit=None,
                        gross=None,
                        total_contract_time=200,
                        main_customer_user_id="c67b0ca2270d",
                        salesforce_main_customer=None,
                        customer_user_ids=None,
                        main_supporter_user_id=None,
                        supporter_organization_id=None,
                        salesforce_main_supporter_user_name=None,
                        supporter_user_ids=None,
                        salesforce_supporter_user_names=None,
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type=None,
                        is_secret=False,
                        salesforce_use_package=None,
                        salesforce_via_pr=None,
                        update_history=None,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    )
                ],
                {
                    "mode": "check",
                    "result": "ok",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000002Ts19",
                            "salesforceUpdateAt": "2022/05/13 8:27",
                            "name": "アアアアア2022",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2021/07/29",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/05/31",
                            "profit": {
                                "year": 2000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    2000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [2000000.0, 0.0, 0.0, 0.0],
                                "half": [2000000.0, 0.0],
                            },
                            "totalContractTime": 5.9,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    3000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [3000000.0, 0.0, 0.0, 0.0],
                                "half": [3000000.0, 0.0],
                                "year": 3000000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [],
                        },
                    ],
                },
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "execute"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"\n"9999h000002Ts19","9999a99999RYLbr","2022/05/13 8:27","アアアアア2022","アアアアアKxxxxx","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","1","0","田中 三郎","test@sample.com","","","田中 三郎","2021/07/29","内部決済完了(A)","2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了","2022/04/01","2022/05/31","","2000000","","","","","","","","","","","2000000","0","0","0","2000000","0","2000000","","3000000","","","","","","","","","","","3000000","0","0","0","3000000","0","3000000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","5.9"\n',
                [
                    CustomerModel(
                        id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        data_type=DataType.CUSTOMER,
                        name="一般社団法人アアアアア",
                        category="ソニーグループ",
                        salesforce_customer_id="9999a99999RYLbr",
                        salesforce_update_at=CustomerService.jst.localize(
                            datetime.strptime(
                                "2022/01/16 8:07",
                                "%Y/%m/%d %H:%M",
                            )
                        ),
                        salesforce_target=None,
                        salesforce_credit_limit=None,
                        salesforce_credit_get_month=None,
                        salesforce_credit_manager=None,
                        salesforce_credit_no_retry=None,
                        salesforce_paws_credit_number=None,
                        salesforce_customer_owner=None,
                        salesforce_customer_segment=None,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at=datetime.strptime(
                            "2020-10-23T02:21:39.356000+0000",
                            "%Y-%m-%dT%H:%M:%S.%f+0000",
                        ),
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at=datetime.strptime(
                            "2020-10-23T04:21:39.356000+0000",
                            "%Y-%m-%dT%H:%M:%S.%f+0000",
                        ),
                        version=1,
                    ),
                ],
                [
                    MasterSupporterOrganizationModel(
                        id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                        name="組織開発",
                        value=None,
                        attributes=None,
                        order=1,
                        use=True,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T04:21:39.356000+0000",
                        version=1,
                    ),
                    MasterSupporterOrganizationModel(
                        id="bad0b57c-de29-48e0-9deb-94be98437441",
                        data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                        name="アイデア可視化",
                        value=None,
                        attributes=None,
                        order=1,
                        use=True,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T04:21:39.356000+0000",
                        version=1,
                    ),
                    MasterSupporterOrganizationModel(
                        id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                        data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                        name="Ideation Service Team",
                        value="IST",
                        attributes=None,
                        order=1,
                        use=True,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T04:21:39.356000+0000",
                        version=1,
                    ),
                ],
                [
                    UserModel(
                        id="a9b67094-cdab-494c-818e-d4845088269b",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.SUPPORTER.key,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="b9b67094-cdab-494c-818e-d4845088269b",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.SUPPORTER.key,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="c9b67094-cdab-494c-818e-d4845088269b",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.SALES.key,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                ],
                [
                    ProjectModel(
                        id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                        data_type=DataType.PROJECT,
                        customer_id="11cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                        salesforce_customer_id="9999a99999RYLbr",
                        salesforce_opportunity_id="9999h000001AAAAA",
                        salesforce_update_at=CustomerService.jst.localize(
                            datetime.strptime(
                                "2022/05/01 8:07",
                                "%Y/%m/%d %H:%M",
                            )
                        ),
                        name="サンプルプロジェクト",
                        customer_name="ソニーグループ株式会社",
                        service_type=None,
                        create_new=None,
                        continued=None,
                        main_sales_user_id="c67b0ca2270d",
                        contract_date=None,
                        phase=None,
                        customer_success=None,
                        support_date_from="2021/03/01",
                        support_date_to="2022/02/28",
                        profit=None,
                        gross=None,
                        total_contract_time=200,
                        main_customer_user_id="c67b0ca2270d",
                        salesforce_main_customer=None,
                        customer_user_ids=None,
                        main_supporter_user_id=None,
                        supporter_organization_id=None,
                        salesforce_main_supporter_user_name=None,
                        supporter_user_ids=None,
                        salesforce_supporter_user_names=None,
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type=None,
                        is_secret=False,
                        salesforce_use_package=None,
                        salesforce_via_pr=None,
                        update_history=None,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    )
                ],
                {
                    "mode": "execute",
                    "result": "done",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": None,
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "7999h0000011111",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": "田中 三郎",
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": [{"name": "田中 三郎"}, {"name": "田中 次郎"}],
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": None,
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "8999h0000022222",
                            "salesforceUpdateAt": "2022/05/13 8:27",
                            "name": "アアアアア2022",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2021/07/29",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/05/31",
                            "profit": {
                                "year": 2000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    2000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [2000000.0, 0.0, 0.0, 0.0],
                                "half": [2000000.0, 0.0],
                            },
                            "totalContractTime": 5.9,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": None,
                            },
                            "mainSupporterUserName": "田中 三郎",
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": [{"name": "田中 三郎"}, {"name": "田中 次郎"}],
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    3000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [3000000.0, 0.0, 0.0, 0.0],
                                "half": [3000000.0, 0.0],
                                "year": 3000000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": None,
                        },
                    ],
                },
            ),
        ],
    )
    def test_ok(
        self,
        mocker,
        mock_auth_admin,
        body,
        s3_value,
        customer_models,
        master_models,
        user_models,
        project_models,
        expected,
    ):
        mock_auth_admin([UserRoleType.SYSTEM_ADMIN.key])
        mock_s3 = mocker.patch.object(S3Helper, "get_object_content")
        mock_s3.return_value = s3_value
        mock_customer = mocker.patch.object(CustomerModel, "scan")
        mock_customer.return_value = customer_models
        mock_master = mocker.patch.object(
            MasterSupporterOrganizationModel.data_type_value_index, "query"
        )
        mock_master.return_value = master_models
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_user_batch_get = mocker.patch.object(UserModel, "batch_get")
        mock_user_batch_get.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "scan")
        mock_project.return_value = project_models
        mocker.patch.object(BatchWrite, "save")
        mock_admin = mocker.patch.object(AdminModel, "scan")
        mock_admin.return_value = [
            AdminModel(
                id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                data_type=DataType.ADMIN,
                name="田中 太郎",
                email="user@example.com",
                roles={UserRoleType.SYSTEM_ADMIN.key},
                company=None,
                job="部長",
                supporter_organization_id={"180a3597-b7e7-42c8-902c-a29016afa662"},
                organization_name=None,
                cognito_id=None,
                last_login_at="2020-10-23T03:21:39.356000+0000",
                otp_secret=None,
                otp_verified_token=None,
                otp_verified_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            )
        ]
        mocker.patch.object(SqsHelper, "send_message_batch_to_queue")

        mock = mocker.patch.object(PlatformApiOperator, "put_project_publication")
        mock.return_value = (200, {"message": "OK"})
        response = client.put(
            "/project/publication",
            headers=REQUEST_HEADERS,
        )

        response = client.post(
            "/api/projects/import", json=body, headers=REQUEST_HEADERS
        )

        actual = response.json()
        assert response.status_code == 200
        assert actual["mode"] == expected["mode"]
        assert actual["result"] == expected["result"]

        for ac in actual["projects"]:
            for ex in expected["projects"]:
                if ac["salesforceOpportunityId"] == ex["salesforceOpportunityId"]:
                    if ac["supporterUsers"]:
                        ac["supporterUsers"].sort(key=lambda x: x["name"])
                    if ex["supporterUsers"]:
                        ex["supporterUsers"].sort(key=lambda x: x["name"])
                    assert ac == ex

    @pytest.mark.parametrize(
        "body, s3_value",
        [
            ({"file": "案件情報_テストデータ.csv", "mode": "check"}, ""),
            ({"file": "案件情報_テストデータ.csv", "mode": "execute"}, ""),
        ],
    )
    def test_ng_400_csv_blank_data(self, mocker, mock_auth_admin, body, s3_value):
        mock_auth_admin([UserRoleType.SYSTEM_ADMIN.key])
        mock_s3 = mocker.patch.object(S3Helper, "get_object_content")
        mock_s3.return_value = s3_value
        mock_customer = mocker.patch.object(CustomerModel, "scan")
        mock_customer.return_value = []
        mock_master = mocker.patch.object(
            MasterSupporterOrganizationModel.data_type_value_index, "query"
        )
        mock_master.return_value = []
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = []
        mock_user_batch_get = mocker.patch.object(UserModel, "batch_get")
        mock_user_batch_get.return_value = []
        mock_project = mocker.patch.object(ProjectModel, "scan")
        mock_project.return_value = []
        mocker.patch.object(BatchWrite, "save")
        mock_admin = mocker.patch.object(AdminModel, "scan")
        mock_admin.return_value = []
        mocker.patch.object(SqsHelper, "send_message_batch_to_queue")

        response = client.post(
            "/api/projects/import", json=body, headers=REQUEST_HEADERS
        )

        assert response.status_code == 400

    @pytest.mark.parametrize(
        "body, s3_value",
        [
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","契約時間（対面支援工数）"',
            ),
            (
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)"',
            ),
        ],
    )
    def test_ng_400_csv_illegal_header(self, mocker, mock_auth_admin, body, s3_value):
        mock_auth_admin([UserRoleType.SYSTEM_ADMIN.key])
        mock_s3 = mocker.patch.object(S3Helper, "get_object_content")
        mock_s3.return_value = s3_value
        mock_customer = mocker.patch.object(CustomerModel, "scan")
        mock_customer.return_value = []
        mock_master = mocker.patch.object(
            MasterSupporterOrganizationModel.data_type_value_index, "query"
        )
        mock_master.return_value = []
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = []
        mock_user_batch_get = mocker.patch.object(UserModel, "batch_get")
        mock_user_batch_get.return_value = []
        mock_project = mocker.patch.object(ProjectModel, "scan")
        mock_project.return_value = []
        mocker.patch.object(BatchWrite, "save")
        mock_admin = mocker.patch.object(AdminModel, "scan")
        mock_admin.return_value = []
        mocker.patch.object(SqsHelper, "send_message_batch_to_queue")

        response = client.post(
            "/api/projects/import", json=body, headers=REQUEST_HEADERS
        )

        assert response.status_code == 400

    @pytest.mark.parametrize(
        "body, s3_value, expected",
        [
            (
                # 商談ID（必須チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["商談 IDを入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [],
                        },
                    ],
                },
            ),
            (
                # 取引先 ID（必須チェック、存在チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","AAAAAAAAAA","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "取引先 IDを入力してください。",
                                "取引先 IDが存在しません。",
                                "取引先名が存在しません。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["取引先 IDが存在しません。", "取引先名が存在しません。"],
                        },
                    ],
                },
            ),
            (
                # PP最終更新日時（商談）（必須チェック、書式チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022-06-01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"\n"9999h00000CCyYE","9999a99999RYLbr","2022/16/01 17:09","アアア　Idea XXX支援","アアア株式会社　IdeaXXX支援","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/05/02","内部決済完了(A)","PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了","2022/05/02","2022/09/30","","","1920000","","","2880000","","","","","","","1920000","2880000","0","0","4800000","0","4800000","","","1920000","","","2880000","","","","","","","1920000","2880000","0","0","4800000","0","4800000","IST_田中 三郎","","30.0"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "PP最終更新日時（商談）を入力してください。",
                                "PP最終更新日時（商談）は「yyyy/mm/dd h:mm」形式で入力してください。",
                                "PP最終更新日時（商談）には正しい日時を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [
                                "PP最終更新日時（商談）は「yyyy/mm/dd h:mm」形式で入力してください。",
                                "PP最終更新日時（商談）には正しい日時を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h00000CCyYE",
                            "salesforceUpdateAt": "2022/16/01 17:09",
                            "name": "アアア　Idea XXX支援",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": None,
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": None,
                            "continued": None,
                            "mainSalesUserId": None,
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/05/02",
                            "phase": None,
                            "customerSuccess": "PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了",
                            "supportDateFrom": "2022/05/02",
                            "supportDateTo": "2022/09/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": None,
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": None,
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": None,
                            "salesforceViaPr": None,
                            "errorMessage": ["PP最終更新日時（商談）には正しい日時を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 商談名(アンケート,PartnerPortalで使用)（必須チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["商談名(アンケート,PartnerPortalで使用)を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [],
                        },
                    ],
                },
            ),
            (
                # 取引先名（必須チェック、存在チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","AAAAAAAA","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["取引先名を入力してください。", "取引先名が存在しません。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["取引先名が存在しません。"],
                        },
                    ],
                },
            ),
            (
                # サービス区分（必須チェック、列挙値チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. ああああ","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["サービス区分を入力してください。", "サービス区分が存在しません。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["サービス区分が存在しません。"],
                        },
                    ],
                },
            ),
            (
                # (アンケート)粗利メイン課（存在チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","XXX","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["(アンケート)粗利メイン課が存在しません。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [],
                        },
                    ],
                },
            ),
            (
                # PKG利用（必須チェック、真理値変換可否チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","A","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "PKG利用を入力してください。",
                                "PKG利用は真理値（1または0）を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PKG利用は真理値（1または0）を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 新規・更新（真理値変換可否チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 削除","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["新規・更新は「01. 更新」または「02. 新規」を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください（必須チェック、真理値変換可否チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","A","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してくださいを入力してください。",
                                "支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してくださいは真理値（1または0）を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [
                                "支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してくださいは真理値（1または0）を入力してください。"
                            ],
                        },
                    ],
                },
            ),
            (
                # PR経由（必須チェック、真理値変換可否チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","A","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "PR経由を入力してください。",
                                "PR経由は真理値（1または0）を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PR経由は真理値（1または0）を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 取引先責任者メールアドレス（書式チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","makoto.fukushima@iret@co.jp","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["取引先責任者メールアドレスには正しい形式のメールアドレスを入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [],
                        },
                    ],
                },
            ),
            (
                # 商談 所有者（必須チェック、存在チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 あお","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["商談 所有者を入力してください。", "商談 所有者が存在しません。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["商談 所有者が存在しません。"],
                        },
                    ],
                },
            ),
            (
                # 完了予定日（必須チェック、書式チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022-03-14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"\n"9999h000009yYMD","9999a99999RYLbr","2022/06/01 17:09","AAA XXXプロジェクト FY99支援","AAA BBB PJ","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","事業開発戦略部門 PJ","","田中 三郎","2022/13/25","内部決済完了(A)","次世代検査機の手作り試作の設計検討および 導入サポートの実施","2022/04/05","2022/07/31","3300000","3300000","3300000","3300000","","","","","","","","","9900000","3300000","0","0","13200000","0","13200000","4300000","4300000","4300000","4300000","","","","","","","","","12900000","4300000","0","0","17200000","0","17200000","IST_田中 三郎","IST_田中 太郎; IST_田中 次郎","40.0"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "完了予定日を入力してください。",
                                "完了予定日は「yyyy/mm/dd」形式で入力してください。",
                                "完了予定日には正しい日付を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [
                                "完了予定日は「yyyy/mm/dd」形式で入力してください。",
                                "完了予定日には正しい日付を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009yYMD",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "AAA XXXプロジェクト FY99支援",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/13/25",
                            "phase": None,
                            "customerSuccess": "次世代検査機の手作り試作の設計検討および 導入サポートの実施",
                            "supportDateFrom": "2022/04/05",
                            "supportDateTo": "2022/07/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "事業開発戦略部門 PJ",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 太郎", "IST_田中 次郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["完了予定日には正しい日付を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # フェーズ（必須チェック、列挙値チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["フェーズを入力してください。", "フェーズは規定値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["フェーズは規定値を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 支援開始日（必須チェック、書式チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022-04-01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/51","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "支援開始日を入力してください。",
                                "支援開始日は「yyyy/mm/dd」形式で入力してください。",
                                "支援開始日には正しい日付を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [
                                "支援開始日は「yyyy/mm/dd」形式で入力してください。",
                                "支援開始日には正しい日付を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h00000CBF64",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "アアアア・イイイイイ⑤",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "06f65c34-1570-4c02-a892-b2cf6392451a",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/18",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "「耕作放棄地の有効利用」のアイデアに関してSG2を通過・システムの運用改善",
                            "supportDateFrom": "2022/14/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["支援開始日には正しい日付を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 支援終了日（必須チェック、書式チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023-03-31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"\n"9999h000002Ts19","9999a99999RYLbr","2022/05/13 8:27","アアアアア2022","アアアアアKxxxxx","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","1","0","田中 三郎","test@sample.com","","","田中 三郎","2021/07/29","内部決済完了(A)","2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了","2022/04/01","2022/15/31","","2000000","","","","","","","","","","","2000000","0","0","0","2000000","0","2000000","","3000000","","","","","","","","","","","3000000","0","0","0","3000000","0","3000000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","5.9"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": [
                                "支援終了日を入力してください。",
                                "支援終了日は「yyyy/mm/dd」形式で入力してください。",
                                "支援終了日には正しい日付を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [
                                "支援終了日は「yyyy/mm/dd」形式で入力してください。",
                                "支援終了日には正しい日付を入力してください。",
                            ],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000002Ts19",
                            "salesforceUpdateAt": "2022/05/13 8:27",
                            "name": "アアアアア2022",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": None,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2021/07/29",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/15/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["支援終了日には正しい日付を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 粗利 売上 Q毎,H毎,FY 必須チェック
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"6999h00000CCyYE","9999a99999RYLbr","2022/06/01 17:09","アアア　Idea XXX支援","アアア株式会社　IdeaXXX支援","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/05/02","内部決済完了(A)","PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了","2022/05/02","2022/09/30","","","","","","","","","","","","","","2880000","0","0","4800000","0","4800000","","","1920000","","","2880000","","","","","","","1920000","2880000","0","0","4800000","0","4800000","IST_田中 三郎","","30.0"\n"6999h000009wvfm","9999a99999RYLbr","2022/06/01 17:09","アアア　力強化（FY99）","アアア　2022年　SSAP支援","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/03/20","内部決済完了(A)","マーケティング力強化ワークショップを通じて、研究者の思いのあるアイデアや実務テーマのビジネスモデルを定義・提案できるスキルを身に着け、実践できるようになる","2022/04/01","2022/07/30","","","","","","","","","","","","","3330000","","0","0","5550000","0","5550000","","","3330000","","2220000","","","","","","","","3330000","2220000","0","0","5550000","0","5550000","IST_田中 三郎","IST_田中 三郎","26.7"\n"6999h00000CCKCX","9999a99999RYLbr","2022/06/01 17:14","アアアアアシステムテクノロジー③","アアアアアシステムテクノロジー様","一般社団法人アアアアア","02. アイデア可視化","IST","0","02. 新規","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/03/29","内部決済完了(A)","プロジェクトチームへのメンタリングによる伴走支援、事務局様への審査協力、第二期応募施策検討等の運用サポートに関するメンタリングを完了","2022/04/01","2022/06/30","","","","","","","","","","","","","1800000","0","","0","1800000","0","1800000","600000","600000","600000","","","","","","","","","","1800000","0","0","0","1800000","0","1800000","IST_田中 三郎","IST_田中 三郎","36.0"\n"6999h00000BGUlc","9999a99999RYLbr","2022/06/01 17:14","アア・イイイ 2期目","商品開発に向けたデザイン支援","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","1","1","田中 三郎","test@sample.com","新規事業開発部","","田中 三郎","2021/12/25","内部決済完了(A)","・カート型新商品の事業計画の策定が完了・カート型新商品の大型版のデザイン及びモックアップ制作、車両型・取付型へのデザインを完了","2022/04/01","2022/06/30","","","3500000","","","","","","","","","","3500000","0","0","","3500000","0","3500000","","","3500000","","","","","","","","","","3500000","0","0","0","3500000","0","3500000","IST_田中 三郎","","12.0"\n"6999h000009yYMD","9999a99999RYLbr","2022/06/01 17:09","AAA XXXプロジェクト FY99支援","AAA BBB PJ","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","事業開発戦略部門 PJ","","田中 三郎","2022/03/25","内部決済完了(A)","次世代検査機の手作り試作の設計検討および 導入サポートの実施","2022/04/05","2022/07/31","3300000","3300000","3300000","3300000","","","","","","","","","9900000","3300000","0","0","","0","13200000","4300000","4300000","4300000","4300000","","","","","","","","","12900000","4300000","0","0","17200000","0","17200000","IST_田中 三郎","IST_田中 三郎; IST_田中 三郎","40.0"\n"6999h00000CD5ef","9999a99999RYLbr","2022/05/31 15:29","AAAアプリ支援　5月","AAA BBB PJ（アプリ支援）","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","事業開発戦略部門 PJ","","田中 三郎","2022/04/22","内部決済完了(A)","次世代検査機の手作り試作（アプリ）の実施","2022/05/02","2022/05/31","","600000","","","","","","","","","","","600000","0","0","0","600000","","600000","","1600000","","","","","","","","","","","1600000","0","0","0","1600000","0","1600000","IST_田中 三郎","","4.0"\n"6999h00000CBF64","9999a99999RYLbr","2022/06/01 17:14","アアアア・イイイイイ⑤","アアアア・イイイイイ様","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","1","0","田中 三郎","test@sample.com","","","田中 三郎","2022/03/18","内部決済完了(A)","「耕作放棄地の有効利用」のアイデアに関してSG2を通過・システムの運用改善","2022/04/01","2022/06/30","1200000","1200000","1200000","","","","","","","","","","3600000","0","0","0","3600000","0","","1200000","1200000","1200000","","","","","","","","","","3600000","0","0","0","3600000","0","3600000","IST_田中 三郎","IST_田中 三郎","20.8"\n"6999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","","","","","","","","","","","","","","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 三郎","122.5"\n"6999h000002Ts19","9999a99999RYLbr","2022/05/13 8:27","アアアアア2022","アアアアアKxxxxx","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","1","0","田中 三郎","test@sample.com","","","田中 三郎","2021/07/29","内部決済完了(A)","2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了","2022/04/01","2022/05/31","","2000000","","","","","","","","","","","2000000","0","0","0","2000000","0","2000000","","","","","","","","","","","","","3000000","","0","0","3000000","0","3000000","IST_田中 三郎","IST_田中 三郎; IST_田中 三郎","5.9"\n"5999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","","","","","","","","","","","9000000","0","","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"5999h00000CCyYE","9999a99999RYLbr","2022/06/01 17:09","アアア　Idea XXX支援","アアア株式会社　IdeaXXX支援","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/05/02","内部決済完了(A)","PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了","2022/05/02","2022/09/30","","","1920000","","","2880000","","","","","","","1920000","2880000","0","0","4800000","0","4800000","","","1920000","","","2880000","","","","","","","1920000","2880000","0","","4800000","0","4800000","IST_田中 三郎","","30.0"\n"5999h000009wvfm","9999a99999RYLbr","2022/06/01 17:09","アアア　力強化（FY99）","アアア　2022年　SSAP支援","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/03/20","内部決済完了(A)","マーケティング力強化ワークショップを通じて、研究者の思いのあるアイデアや実務テーマのビジネスモデルを定義・提案できるスキルを身に着け、実践できるようになる","2022/04/01","2022/07/30","","","3330000","","2220000","","","","","","","","3330000","2220000","0","0","5550000","0","5550000","","","3330000","","2220000","","","","","","","","3330000","2220000","0","0","","0","5550000","IST_田中 三郎","IST_田中 三郎","26.7"\n"5999h00000CCKCX","9999a99999RYLbr","2022/06/01 17:14","アアアアアシステムテクノロジー③","アアアアアシステムテクノロジー様","一般社団法人アアアアア","02. アイデア可視化","IST","0","02. 新規","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/03/29","内部決済完了(A)","プロジェクトチームへのメンタリングによる伴走支援、事務局様への審査協力、第二期応募施策検討等の運用サポートに関するメンタリングを完了","2022/04/01","2022/06/30","600000","600000","600000","","","","","","","","","","1800000","0","0","0","1800000","0","1800000","600000","600000","600000","","","","","","","","","","1800000","0","0","0","1800000","","1800000","IST_田中 三郎","IST_田中 三郎","36.0"\n"5999h00000BGUlc","9999a99999RYLbr","2022/06/01 17:14","アア・イイイ 2期目","商品開発に向けたデザイン支援","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","1","1","田中 三郎","test@sample.com","新規事業開発部","","田中 三郎","2021/12/25","内部決済完了(A)","・カート型新商品の事業計画の策定が完了・カート型新商品の大型版のデザイン及びモックアップ制作、車両型・取付型へのデザインを完了","2022/04/01","2022/06/30","","","3500000","","","","","","","","","","3500000","0","0","0","3500000","0","3500000","","","3500000","","","","","","","","","","3500000","0","0","0","3500000","0","","IST_田中 三郎","","12.0"\n',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h00000CCyYE",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アアア　Idea XXX支援",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/05/02",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了",
                            "supportDateFrom": "2022/05/02",
                            "supportDateTo": "2022/09/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_1Q粗利を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h000009wvfm",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アアア　力強化（FY99）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/20",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "マーケティング力強化ワークショップを通じて、研究者の思いのあるアイデアや実務テーマのビジネスモデルを定義・提案できるスキルを身に着け、実践できるようになる",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/07/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_2Q粗利を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h00000CCKCX",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "アアアアアシステムテクノロジー③",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "02. 新規",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/29",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "プロジェクトチームへのメンタリングによる伴走支援、事務局様への審査協力、第二期応募施策検討等の運用サポートに関するメンタリングを完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_3Q粗利を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h00000BGUlc",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "アア・イイイ 2期目",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2021/12/25",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "・カート型新商品の事業計画の策定が完了・カート型新商品の大型版のデザイン及びモックアップ制作、車両型・取付型へのデザインを完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新規事業開発部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": True,
                            "errorMessage": ["PP_4Q粗利を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h000009yYMD",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "AAA XXXプロジェクト FY99支援",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/25",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "次世代検査機の手作り試作の設計検討および 導入サポートの実施",
                            "supportDateFrom": "2022/04/05",
                            "supportDateTo": "2022/07/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "事業開発戦略部門 PJ",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_1H粗利を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h00000CD5ef",
                            "salesforceUpdateAt": "2022/05/31 15:29",
                            "name": "AAAアプリ支援　5月",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/04/22",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "次世代検査機の手作り試作（アプリ）の実施",
                            "supportDateFrom": "2022/05/02",
                            "supportDateTo": "2022/05/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "事業開発戦略部門 PJ",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_2H粗利を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h00000CBF64",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "アアアア・イイイイイ⑤",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/18",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "「耕作放棄地の有効利用」のアイデアに関してSG2を通過・システムの運用改善",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_FY粗利を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_1Q売上を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "6999h000002Ts19",
                            "salesforceUpdateAt": "2022/05/13 8:27",
                            "name": "アアアアア2022",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2021/07/29",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/05/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_2Q売上を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "5999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["PP_3Q売上を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "5999h00000CCyYE",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アアア　Idea XXX支援",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/05/02",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了",
                            "supportDateFrom": "2022/05/02",
                            "supportDateTo": "2022/09/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_4Q売上を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "5999h000009wvfm",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アアア　力強化（FY99）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/20",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "マーケティング力強化ワークショップを通じて、研究者の思いのあるアイデアや実務テーマのビジネスモデルを定義・提案できるスキルを身に着け、実践できるようになる",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/07/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_1H売上を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "5999h00000CCKCX",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "アアアアアシステムテクノロジー③",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "02. 新規",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/29",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "プロジェクトチームへのメンタリングによる伴走支援、事務局様への審査協力、第二期応募施策検討等の運用サポートに関するメンタリングを完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_2H売上を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "5999h00000BGUlc",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "アア・イイイ 2期目",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2021/12/25",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "・カート型新商品の事業計画の策定が完了・カート型新商品の大型版のデザイン及びモックアップ制作、車両型・取付型へのデザインを完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新規事業開発部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": True,
                            "errorMessage": ["PP_FY売上を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 粗利 売上 月毎,Q毎,H毎,FY 数値チェック
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"5999h000009yYMD","9999a99999RYLbr","2022/06/01 17:09","AAA XXXプロジェクト FY99支援","AAA BBB PJ","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","事業開発戦略部門 PJ","","田中 三郎","2022/03/25","内部決済完了(A)","次世代検査機の手作り試作の設計検討および 導入サポートの実施","2022/04/05","2022/07/31","A","3300000","3300000","3300000","","","","","","","","","9900000","3300000","0","0","13200000","0","13200000","4300000","4300000","4300000","4300000","","","","","","","","","12900000","4300000","0","0","17200000","0","17200000","IST_田中 三郎","IST_田中 三郎; IST_田中 三郎","40.0"\n"5999h00000CD5ef","9999a99999RYLbr","2022/05/31 15:29","AAAアプリ支援　5月","AAA BBB PJ（アプリ支援）","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","事業開発戦略部門 PJ","","田中 三郎","2022/04/22","内部決済完了(A)","次世代検査機の手作り試作（アプリ）の実施","2022/05/02","2022/05/31","","600000","","","","","","","","","","","A","0","0","0","600000","0","600000","","1600000","","","","","","","","","","","1600000","0","0","0","1600000","0","1600000","IST_田中 三郎","","4.0"\n"4999h00000CBF64","9999a99999RYLbr","2022/06/01 17:14","アアアア・イイイイイ⑤","アアアア・イイイイイ様","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","1","0","田中 三郎","test@sample.com","","","田中 三郎","2022/03/18","内部決済完了(A)","「耕作放棄地の有効利用」のアイデアに関してSG2を通過・システムの運用改善","2022/04/01","2022/06/30","1200000","1200000","1200000","","","","","","","","","","3600000","0","0","0","A","0","3600000","1200000","1200000","1200000","","","","","","","","","","3600000","0","0","0","3600000","0","3600000","IST_田中 三郎","IST_田中 三郎","20.8"\n"4999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","A","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 三郎","122.5"\n"4999h000002Ts19","9999a99999RYLbr","2022/05/13 8:27","アアアアア2022","アアアアアKxxxxx","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","1","0","田中 三郎","test@sample.com","","","田中 三郎","2021/07/29","内部決済完了(A)","2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了","2022/04/01","2022/05/31","","2000000","","","","","","","","","","","2000000","0","0","0","2000000","0","2000000","A","3000000","","","","","","","","","","","3000000","0","0","0","3000000","0","3000000","IST_田中 三郎","IST_田中 三郎; IST_田中 三郎","5.9"\n"3999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","A","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"3999h00000CCyYE","9999a99999RYLbr","2022/06/01 17:09","アアア　Idea XXX支援","アアア株式会社　IdeaXXX支援","一般社団法人アアアアア","02. アイデア可視化","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/05/02","内部決済完了(A)","PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了","2022/05/02","2022/09/30","","","1920000","","","2880000","","","","","","","1920000","2880000","0","0","4800000","0","4800000","","","1920000","","","2880000","","","","","","","1920000","2880000","0","0","4800000","A","4800000","IST_田中 三郎","","30.0"\n"3999h000009wvfm","9999a99999RYLbr","2022/06/01 17:09","アアア　力強化（FY99）","アアア　2022年　SSAP支援","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","","","田中 三郎","2022/03/20","内部決済完了(A)","マーケティング力強化ワークショップを通じて、研究者の思いのあるアイデアや実務テーマのビジネスモデルを定義・提案できるスキルを身に着け、実践できるようになる","2022/04/01","2022/07/30","","","3330000","","2220000","","","","","","","","3330000","2220000","0","0","5550000","0","5550000","","","3330000","","2220000","","","","","","","","3330000","2220000","0","0","5550000","0","A","IST_田中 三郎","IST_田中 三郎","26.7"\n',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "5999h000009yYMD",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "AAA XXXプロジェクト FY99支援",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/25",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "次世代検査機の手作り試作の設計検討および 導入サポートの実施",
                            "supportDateFrom": "2022/04/05",
                            "supportDateTo": "2022/07/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "事業開発戦略部門 PJ",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_04粗利は数値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "5999h00000CD5ef",
                            "salesforceUpdateAt": "2022/05/31 15:29",
                            "name": "AAAアプリ支援　5月",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/04/22",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "次世代検査機の手作り試作（アプリ）の実施",
                            "supportDateFrom": "2022/05/02",
                            "supportDateTo": "2022/05/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "事業開発戦略部門 PJ",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_1Q粗利は数値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "4999h00000CBF64",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "アアアア・イイイイイ⑤",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/18",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "「耕作放棄地の有効利用」のアイデアに関してSG2を通過・システムの運用改善",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_1H粗利は数値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "4999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_FY粗利は数値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "4999h000002Ts19",
                            "salesforceUpdateAt": "2022/05/13 8:27",
                            "name": "アアアアア2022",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2021/07/29",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "2号機開発に向けたコミュニケーション、プロダクトデザイン、パートナー募集を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/05/31",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_04売上は数値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "3999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["PP_1Q売上は数値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "3999h00000CCyYE",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アアア　Idea XXX支援",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/05/02",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "PJチームへのトレーニング・メンタリング支援、事務局へのメンタリング支援を通じ　社内新規事業育成プログラムの各フェーズが完了",
                            "supportDateFrom": "2022/05/02",
                            "supportDateTo": "2022/09/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_2H売上は数値を入力してください。"],
                        },
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "3999h000009wvfm",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アアア　力強化（FY99）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/20",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "マーケティング力強化ワークショップを通じて、研究者の思いのあるアイデアや実務テーマのビジネスモデルを定義・提案できるスキルを身に着け、実践できるようになる",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/07/30",
                            "profit": None,
                            "totalContractTime": None,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎"],
                            "gross": None,
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": ["PP_FY売上は数値を入力してください。"],
                        },
                    ],
                },
            ),
            (
                # 延べ契約時間（数値チェック）
                {"file": "案件情報_テストデータ.csv", "mode": "check"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","AAA"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "check",
                    "result": "ng",
                    "projects": [
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009ydGd",
                            "salesforceUpdateAt": "2022/06/01 17:14",
                            "name": "AAA 1期目（メンタルヘルス）",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "bad0b57c-de29-48e0-9deb-94be98437441",
                            "serviceTypeName": "02. アイデア可視化",
                            "createNew": "01. 更新",
                            "continued": True,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/31",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2022/06/30",
                            "profit": {
                                "year": 9000000,
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                            },
                            "totalContractTime": 18.0,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "新事業統括本部 新事業統括事業企画部",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": [],
                            "gross": {
                                "monthly": [
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    9000000.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                    0.0,
                                ],
                                "quarterly": [9000000.0, 0.0, 0.0, 0.0],
                                "half": [9000000.0, 0.0],
                                "year": 9000000,
                            },
                            "salesforceUsePackage": True,
                            "salesforceViaPr": True,
                            "errorMessage": ["契約時間（対面支援工数）は数値を入力してください。"],
                        },
                        # 19
                        {
                            "customerId": "3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                            "salesforceCustomerId": "9999a99999RYLbr",
                            "salesforceOpportunityId": "9999h000009wia8",
                            "salesforceUpdateAt": "2022/06/01 17:09",
                            "name": "アイウエオ",
                            "customerName": "一般社団法人アアアアア",
                            "serviceType": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "01. 組織開発",
                            "createNew": "01. 更新",
                            "continued": False,
                            "mainSalesUserId": "c9b67094-cdab-494c-818e-d4845088269b",
                            "mainSalesUserName": "田中 三郎",
                            "contractDate": "2022/03/14",
                            "phase": "内部決済完了(A)",
                            "customerSuccess": "事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施",
                            "supportDateFrom": "2022/04/01",
                            "supportDateTo": "2023/03/31",
                            "profit": {
                                "year": 39000000,
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    2900000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3100000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9700000.0,
                                    9900000.0,
                                    9500000.0,
                                ],
                                "half": [19600000.0, 19400000.0],
                            },
                            "totalContractTime": 122.5,
                            "salesforceMainCustomer": {
                                "name": "田中 三郎",
                                "email": "test@sample.com",
                                "organizationName": "総合企画部 起業・事業化推進課",
                            },
                            "mainSupporterUserName": None,
                            "supporterOrganizationId": "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                            "supporterOrganizationName": "IST",
                            "salesforceMainSupporterUserName": "IST_田中 三郎",
                            "supporterUsers": None,
                            "salesforceSupporterUserNames": ["IST_田中 三郎", "IST_田中 次郎"],
                            "gross": {
                                "monthly": [
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                    3300000.0,
                                ],
                                "quarterly": [
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                    9900000.0,
                                ],
                                "half": [19800000.0, 19800000.0],
                                "year": 39600000,
                            },
                            "salesforceUsePackage": False,
                            "salesforceViaPr": False,
                            "errorMessage": [],
                        },
                    ],
                },
            ),
        ],
    )
    def test_check_ng(
        self,
        mocker,
        mock_auth_admin,
        body,
        s3_value,
        expected,
    ):
        mock_auth_admin([UserRoleType.SYSTEM_ADMIN.key])
        mock_s3 = mocker.patch.object(S3Helper, "get_object_content")
        mock_s3.return_value = s3_value
        mock_customer = mocker.patch.object(CustomerModel, "scan")
        mock_customer.return_value = [
            CustomerModel(
                id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                data_type=DataType.CUSTOMER,
                name="一般社団法人アアアアア",
                category="ソニーグループ",
                salesforce_customer_id="9999a99999RYLbr",
                salesforce_update_at=CustomerService.jst.localize(
                    datetime.strptime(
                        "2022/01/16 8:07",
                        "%Y/%m/%d %H:%M",
                    )
                ),
                salesforce_target=None,
                salesforce_credit_limit=None,
                salesforce_credit_get_month=None,
                salesforce_credit_manager=None,
                salesforce_credit_no_retry=None,
                salesforce_paws_credit_number=None,
                salesforce_customer_owner=None,
                salesforce_customer_segment=None,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at=datetime.strptime(
                    "2020-10-23T02:21:39.356000+0000",
                    "%Y-%m-%dT%H:%M:%S.%f+0000",
                ),
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at=datetime.strptime(
                    "2020-10-23T04:21:39.356000+0000",
                    "%Y-%m-%dT%H:%M:%S.%f+0000",
                ),
                version=1,
            ),
        ]
        mock_master = mocker.patch.object(
            MasterSupporterOrganizationModel.data_type_value_index, "query"
        )
        mock_master.return_value = [
            MasterSupporterOrganizationModel(
                id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                name="組織開発",
                value=None,
                attributes=None,
                order=1,
                use=True,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T04:21:39.356000+0000",
                version=1,
            ),
            MasterSupporterOrganizationModel(
                id="bad0b57c-de29-48e0-9deb-94be98437441",
                data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                name="アイデア可視化",
                value=None,
                attributes=None,
                order=1,
                use=True,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T04:21:39.356000+0000",
                version=1,
            ),
            MasterSupporterOrganizationModel(
                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                name="Ideation Service Team",
                value="IST",
                attributes=None,
                order=1,
                use=True,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T04:21:39.356000+0000",
                version=1,
            ),
        ]
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = [
            UserModel(
                id="a9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 太郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="b9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 次郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="c9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 三郎",
                email="user@example.com",
                role=UserRoleType.SALES.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
        ]
        mock_user_batch_get = mocker.patch.object(UserModel, "batch_get")
        mock_user_batch_get.return_value = [
            UserModel(
                id="a9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 太郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="b9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 次郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="c9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 三郎",
                email="user@example.com",
                role=UserRoleType.SALES.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
        ]
        mock_project = mocker.patch.object(ProjectModel, "scan")
        mock_project.return_value = [
            ProjectModel(
                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                data_type=DataType.PROJECT,
                customer_id="11cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                salesforce_customer_id="9999a99999RYLbr",
                salesforce_opportunity_id="9999h000001AAAAA",
                salesforce_update_at=CustomerService.jst.localize(
                    datetime.strptime(
                        "2022/05/01 8:07",
                        "%Y/%m/%d %H:%M",
                    )
                ),
                name="サンプルプロジェクト",
                customer_name="ソニーグループ株式会社",
                service_type=None,
                create_new=None,
                continued=None,
                main_sales_user_id="c67b0ca2270d",
                contract_date=None,
                phase=None,
                customer_success=None,
                support_date_from="2021/03/01",
                support_date_to="2022/02/28",
                profit=None,
                gross=None,
                total_contract_time=200,
                main_customer_user_id="c67b0ca2270d",
                salesforce_main_customer=None,
                customer_user_ids=None,
                main_supporter_user_id=None,
                supporter_organization_id=None,
                salesforce_main_supporter_user_name=None,
                supporter_user_ids=None,
                salesforce_supporter_user_names=None,
                is_count_man_hour=True,
                is_karte_remind=True,
                contract_type=None,
                is_secret=False,
                salesforce_use_package=None,
                salesforce_via_pr=None,
                update_history=None,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
        ]
        mocker.patch.object(BatchWrite, "save")
        mock_admin = mocker.patch.object(AdminModel, "scan")
        mock_admin.return_value = [
            AdminModel(
                id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                data_type=DataType.ADMIN,
                name="田中 太郎",
                email="user@example.com",
                roles={UserRoleType.SYSTEM_ADMIN.key},
                company=None,
                job="部長",
                supporter_organization_id={"180a3597-b7e7-42c8-902c-a29016afa662"},
                organization_name=None,
                cognito_id=None,
                last_login_at="2020-10-23T03:21:39.356000+0000",
                otp_secret=None,
                otp_verified_token=None,
                otp_verified_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            )
        ]
        mocker.patch.object(SqsHelper, "send_message_batch_to_queue")

        response = client.post(
            "/api/projects/import", json=body, headers=REQUEST_HEADERS
        )

        actual = response.json()
        assert response.status_code == 200
        assert actual["result"] == expected["result"]
        assert (
            actual["projects"][0]["errorMessage"]
            == expected["projects"][0]["errorMessage"]
        )
        assert (
            actual["projects"][1]["errorMessage"]
            == expected["projects"][1]["errorMessage"]
        )

    @pytest.mark.parametrize(
        "body, s3_value, expected",
        [
            (
                {"file": "案件情報_テストデータ.csv", "mode": "execute"},
                '"商談 ID","取引先 ID","PP最終更新日時（商談）","商談名(アンケート,PartnerPortalで使用)","商談名","取引先名","サービス区分","(アンケート)粗利メイン課","PKG利用","新規・更新","支援期間が前年度をまたぐ際はチェックを入れ、別途前年度の商談を登録してください","PR経由","取引先責任者","取引先責任者メールアドレス","取引先責任者所属部署","取引先責任者役職","商談 所有者","完了予定日","フェーズ","カスタマーサクセス","支援開始日","支援終了日","PP_04粗利","PP_05粗利","PP_06粗利","PP_07粗利","PP_08粗利","PP_09粗利","PP_10粗利","PP_11粗利","PP_12粗利","PP_01粗利","PP_02粗利","PP_03粗利","PP_1Q粗利","PP_2Q粗利","PP_3Q粗利","PP_4Q粗利","PP_1H粗利","PP_2H粗利","PP_FY粗利","PP_04売上","PP_05売上","PP_06売上","PP_07売上","PP_08売上","PP_09売上","PP_10売上","PP_11売上","PP_12売上","PP_01売上","PP_02売上","PP_03売上","PP_1Q売上","PP_2Q売上","PP_3Q売上","PP_4Q売上","PP_1H売上","PP_2H売上","PP_FY売上","プロデューサー(主担当1名)","アクセラレーター(副担当複数名)","契約時間（対面支援工数）"\n"9999h000009ydGd","9999a99999RYLbr","2022/06/01 17:14","AAA 1期目（メンタルヘルス）","メンタルヘルス事業の事業開発に向けた伴走支援","一般社団法人アアアアア","02. アイデア可視化","IST","1","01. 更新","1","1","田中 三郎","test@sample.com","新事業統括本部 新事業統括事業企画部","マネージャー","田中 三郎","2022/03/31","内部決済完了(A)","メンタルヘルスに関する課題探索、先行センシング商品・ストレス軽減商品の社内評価を基に、新規事業として軸となる提供価値の仮説構築を完了","2022/04/01","2022/06/30","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","","","9000000","","","","","","","","","","9000000","0","0","0","9000000","0","9000000","IST_田中 三郎","","18.0"\n"9999h000009wia8","9999a99999RYLbr","2022/06/01 17:09","アイウエオ","SSAPによる事業支援サービス","一般社団法人アアアアア","01. 組織開発","IST","0","01. 更新","0","0","田中 三郎","test@sample.com","総合企画部 起業・事業化推進課","","田中 三郎","2022/03/14","内部決済完了(A)","事業化に繋がる実践的な伴走サポートにより、社会起業家養成の本格支援を実施","2022/04/01","2023/03/31","3300000","3300000","3300000","3300000","3100000","3300000","3300000","3300000","3300000","3300000","3300000","2900000","9900000","9700000","9900000","9500000","19600000","19400000","39000000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","3300000","9900000","9900000","9900000","9900000","19800000","19800000","39600000","IST_田中 三郎","IST_田中 三郎; IST_田中 次郎","122.5"',
                {
                    "mode": "execute",
                    "result": "error",
                    "projects": [],
                },
            ),
        ],
    )
    def test_execute_error(
        self,
        mocker,
        mock_auth_admin,
        body,
        s3_value,
        expected,
    ):
        mock_auth_admin([UserRoleType.SYSTEM_ADMIN.key])
        mock_s3 = mocker.patch.object(S3Helper, "get_object_content")
        mock_s3.return_value = s3_value
        mock_customer = mocker.patch.object(CustomerModel, "scan")
        mock_customer.return_value = [
            CustomerModel(
                id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                data_type=DataType.CUSTOMER,
                name="一般社団法人アアアアア",
                category="ソニーグループ",
                salesforce_customer_id="9999a99999RYLbr",
                salesforce_update_at=CustomerService.jst.localize(
                    datetime.strptime(
                        "2022/01/16 8:07",
                        "%Y/%m/%d %H:%M",
                    )
                ),
                salesforce_target=None,
                salesforce_credit_limit=None,
                salesforce_credit_get_month=None,
                salesforce_credit_manager=None,
                salesforce_credit_no_retry=None,
                salesforce_paws_credit_number=None,
                salesforce_customer_owner=None,
                salesforce_customer_segment=None,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at=datetime.strptime(
                    "2020-10-23T02:21:39.356000+0000",
                    "%Y-%m-%dT%H:%M:%S.%f+0000",
                ),
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at=datetime.strptime(
                    "2020-10-23T04:21:39.356000+0000",
                    "%Y-%m-%dT%H:%M:%S.%f+0000",
                ),
                version=1,
            ),
        ]
        mock_master = mocker.patch.object(
            MasterSupporterOrganizationModel.data_type_value_index, "query"
        )
        mock_master.return_value = [
            MasterSupporterOrganizationModel(
                id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                name="組織開発",
                value=None,
                attributes=None,
                order=1,
                use=True,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T04:21:39.356000+0000",
                version=1,
            ),
            MasterSupporterOrganizationModel(
                id="bad0b57c-de29-48e0-9deb-94be98437441",
                data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                name="アイデア可視化",
                value=None,
                attributes=None,
                order=1,
                use=True,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T04:21:39.356000+0000",
                version=1,
            ),
            MasterSupporterOrganizationModel(
                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                data_type=MasterDataType.MASTER_SERVICE_TYPE.value,
                name="Ideation Service Team",
                value="IST",
                attributes=None,
                order=1,
                use=True,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T04:21:39.356000+0000",
                version=1,
            ),
        ]
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = [
            UserModel(
                id="a9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 太郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="b9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 次郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="c9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 三郎",
                email="user@example.com",
                role=UserRoleType.SALES.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
        ]
        mock_user_batch_get = mocker.patch.object(UserModel, "batch_get")
        mock_user_batch_get.return_value = [
            UserModel(
                id="a9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 太郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="b9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 次郎",
                email="user@example.com",
                role=UserRoleType.SUPPORTER.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
            UserModel(
                id="c9b67094-cdab-494c-818e-d4845088269b",
                data_type=DataType.USER,
                name="田中 三郎",
                email="user@example.com",
                role=UserRoleType.SALES.key,
                customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                customer_name="ソニーグループ株式会社",
                job="部長",
                company=None,
                supporter_organization_id=None,
                is_input_man_hour=None,
                project_ids=None,
                cognito_id=None,
                agreed=False,
                last_login_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
        ]
        mock_project = mocker.patch.object(ProjectModel, "scan")
        mock_project.return_value = [
            ProjectModel(
                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                data_type=DataType.PROJECT,
                customer_id="11cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                salesforce_customer_id="9999a99999RYLbr",
                salesforce_opportunity_id="9999h000001AAAAA",
                salesforce_update_at=CustomerService.jst.localize(
                    datetime.strptime(
                        "2022/05/01 8:07",
                        "%Y/%m/%d %H:%M",
                    )
                ),
                name="サンプルプロジェクト",
                customer_name="ソニーグループ株式会社",
                service_type=None,
                create_new=None,
                continued=None,
                main_sales_user_id="c67b0ca2270d",
                contract_date=None,
                phase=None,
                customer_success=None,
                support_date_from="2021/03/01",
                support_date_to="2022/02/28",
                profit=None,
                gross=None,
                total_contract_time=200,
                main_customer_user_id="c67b0ca2270d",
                salesforce_main_customer=None,
                customer_user_ids=None,
                main_supporter_user_id=None,
                supporter_organization_id=None,
                salesforce_main_supporter_user_name=None,
                supporter_user_ids=None,
                salesforce_supporter_user_names=None,
                is_count_man_hour=True,
                is_karte_remind=True,
                contract_type=None,
                is_secret=False,
                salesforce_use_package=None,
                salesforce_via_pr=None,
                update_history=None,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            ),
        ]
        mock_batch_write = mocker.patch.object(BatchWrite, "save")
        mock_batch_write.side_effect = PutError()
        mock_admin = mocker.patch.object(AdminModel, "scan")
        mock_admin.return_value = [
            AdminModel(
                id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                data_type=DataType.ADMIN,
                name="田中 太郎",
                email="user@example.com",
                roles={UserRoleType.SYSTEM_ADMIN.key},
                company=None,
                job="部長",
                supporter_organization_id={"180a3597-b7e7-42c8-902c-a29016afa662"},
                organization_name=None,
                cognito_id=None,
                last_login_at="2020-10-23T03:21:39.356000+0000",
                otp_secret=None,
                otp_verified_token=None,
                otp_verified_at=None,
                disabled=False,
                create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                create_at="2020-10-23T03:21:39.356000+0000",
                update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                update_at="2020-10-23T03:21:39.356000+0000",
                version=1,
            )
        ]
        mocker.patch.object(SqsHelper, "send_message_batch_to_queue")

        response = client.post(
            "/api/projects/import", json=body, headers=REQUEST_HEADERS
        )

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected
