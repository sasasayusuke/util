# 応募ソルバー画面 設計書

## 関連課題

* （新規作成のため関連課題なし）

## 機能概要

人材要件に対する応募ソルバーを管理する画面。既存の個人ソルバーやソルバー候補から選択、または新規でソルバー候補を追加することができる。

## 画面デザイン

※詳細な画面デザインは別途デザインファイルを参照

## 利用可能権限

| ロール | 条件 |
|--------|------|
| 管理者（Admin） | 全機能利用可能 |
| 法人ソルバー | 自社に関連する応募ソルバーの管理が可能 |
| 個人ソルバー | アクセス不可 |
| 一般ユーザー | アクセス不可 |

## 項目定義

### メイン画面

| 画面項目名 | サイト表記 | 項目種別 | I/O | データ型 | 必須 | 上限 | 初期値 | プレースホルダー | 入力制約 | 備考 |
|------------|------------|----------|-----|----------|------|------|--------|------------------|----------|------|
| 案件コード | 案件コード | テキスト | O | string | - | - | - | - | - | 自動表示 |
| 案件名 | 案件名 | テキスト | O | string | - | - | - | - | - | |
| 必要人数 | 必要人数 | 数値 | O | number | - | - | - | - | - | X名 |
| 現在の選定人数 | 選定済み | 数値 | O | number | - | - | 0 | - | - | X名 |

### 個人ソルバー一覧（セクション）

| 画面項目名 | サイト表記 | 項目種別 | I/O | データ型 | 必須 | 上限 | 初期値 | プレースホルダー | 入力制約 | 備考 |
|------------|------------|----------|-----|----------|------|------|--------|------------------|----------|------|
| ソルバーID | ID | テキスト | O | string | - | - | - | - | - | |
| ソルバー名 | 氏名 | テキスト | O | string | - | - | - | - | - | |
| メールアドレス | メール | メール | O | string | - | - | - | - | - | |
| 電話番号 | 電話番号 | テキスト | O | string | - | - | - | - | - | |
| スキル概要 | スキル | テキスト | O | string | - | 200 | - | - | - | 省略表示 |
| 単価 | 単価 | 数値 | O | number | - | - | - | - | - | XX万円/月 |
| ステータス | ステータス | セレクト | I | string | ○ | - | 未選定 | - | - | 未選定/選定済/非選定 |
| 選択 | 選択 | チェックボックス | I | boolean | - | - | false | - | - | |

### ソルバー候補一覧（セクション）

| 画面項目名 | サイト表記 | 項目種別 | I/O | データ型 | 必須 | 上限 | 初期値 | プレースホルダー | 入力制約 | 備考 |
|------------|------------|----------|-----|----------|------|------|--------|------------------|----------|------|
| 候補ID | ID | テキスト | O | string | - | - | - | - | - | |
| 候補者名 | 氏名 | テキスト | O | string | - | - | - | - | - | |
| 登録日 | 登録日 | 日付 | O | date | - | - | - | - | - | YYYY/MM/DD |
| ステータス | ステータス | テキスト | O | string | - | - | - | - | - | 審査中/承認済/却下 |
| 選択 | 選択 | チェックボックス | I | boolean | - | - | false | - | - | |

## バリデーション

| 画面項目名 | チェック場所 | チェック内容 | エラーメッセージ | 備考 |
|------------|--------------|--------------------------|--------------------------|---------|
| ステータス | F/B | 必須チェック | ステータスを選択してください | 選定済みを選択時のみ |
| 選択人数 | B | 上限チェック | 必要人数を超えて選定することはできません | |
| ステータス整合性 | B | 論理チェック | 選定済みステータスは必要人数まで | |

* F：フロントエンド
* B：バックエンド

## リンク・ボタン項目

### メイン画面

| ボタン・リンク名 | サイト表記 | 項目種別 | 遷移先 | 初期状態（活性・非活性） | 備考 |
|------------------|------------|----------|--------|-------------------------|------|
| 個人ソルバー＋ | ＋ | ボタン | 応募ソルバー追加ポップアップ | 活性 | 個人ソルバーセクションのヘッダー |
| ソルバー候補＋ | ＋ | ボタン | ソルバー候補追加ポップアップ | 活性 | ソルバー候補セクションのヘッダー |
| 編集 | 編集 | ボタン | 個人ソルバー情報詳細（別タブ） | 活性 | 各ソルバー行に表示 |
| 詳細 | 詳細 | ボタン | ソルバー候補情報詳細（別タブ） | 活性 | 各候補者行に表示 |
| 変更する | 変更する | ボタン | 応募ソルバー登録完了画面 | 活性 | |
| 一覧へ戻る | 一覧へ戻る | リンク | 人材要件一覧画面 | 活性 | |
| キャンセル | キャンセル | ボタン | - | 活性 | 確認ダイアログ表示 |

### 応募ソルバー追加ポップアップ

| ボタン・リンク名 | サイト表記 | 項目種別 | 遷移先 | 初期状態（活性・非活性） | 備考 |
|------------------|------------|----------|--------|-------------------------|------|
| 既存ソルバーを選択 | 既存ソルバーから選択 | ラジオボタン | - | 活性 | デフォルト選択 |
| 検索 | 検索 | ボタン | - | 活性 | |
| 追加 | 追加 | ボタン | - | 非活性 | ソルバー選択時に活性化 |
| 閉じる | 閉じる | ボタン | - | 活性 | |

### ソルバー候補追加ポップアップ

| ボタン・リンク名 | サイト表記 | 項目種別 | 遷移先 | 初期状態（活性・非活性） | 備考 |
|------------------|------------|----------|--------|-------------------------|------|
| 既存候補を選択 | 既存ソルバー候補から選択 | ラジオボタン | - | 活性 | デフォルト選択 |
| 新規候補を追加 | 新規ソルバー候補を追加 | ラジオボタン | - | 活性 | |
| 検索 | 検索 | ボタン | - | 活性 | 既存候補選択時のみ |
| 追加 | 追加 | ボタン | - | 非活性 | 候補選択時に活性化 |
| 新規登録 | 新規登録 | ボタン | 新規個人ソルバー申請（別タブ） | 非活性 | 新規候補選択時に活性化 |
| 閉じる | 閉じる | ボタン | - | 活性 | |

## イベント定義

| イベント | 処理概要 | 異常時の処理 | 備考 |
|----------|----------|--------------|------|
| 画面初期表示 | 要件IDを元に応募ソルバー情報を取得 | エラーメッセージを画面上部に表示 | |
| 個人ソルバー＋クリック | 応募ソルバー追加ポップアップを表示 | - | |
| ソルバー候補＋クリック | ソルバー候補追加ポップアップを表示 | - | |
| ポップアップ内検索 | 条件に合うソルバー/候補を検索表示 | 該当なしメッセージ表示 | |
| ポップアップ追加 | 選択したソルバーを画面に追加 | エラーメッセージ表示 | 重複チェックあり |
| 新規登録クリック | 別タブで新規個人ソルバー申請画面を開く | - | 案件コード自動入力 |
| ステータス変更 | ソルバーのステータスを変更 | - | 選定済み数をリアルタイム更新 |
| 変更するクリック | 応募ソルバー情報を更新 | バリデーションエラー表示 | |
| 編集/詳細クリック | 別タブで詳細画面を開く | - | |

## 利用DB

| 場所（NPF/ PP） | テーブル名 | CRUD | 備考 |
|-----------------|------------|------|------|
| PP | solver_applications | CRU | 応募ソルバー情報の管理 |
| PP | solvers | R | 個人ソルバー情報の参照 |
| PP | solver_candidates | R | ソルバー候補情報の参照 |
| PP | projects | R | プロジェクト情報の参照 |
| NPF | 案件マスタ | R | 案件情報の参照 |

## 利用API

- `GET /api/project-requirements/{requirementId}/applied-solvers`: 応募ソルバー一覧の取得
- `GET /api/solvers`: 個人ソルバー検索（ポップアップ用）
  - クエリパラメータ: keyword, skills, available
- `GET /api/solver-candidates`: ソルバー候補検索（ポップアップ用）
  - クエリパラメータ: keyword, status
- `POST /api/project-requirements/{requirementId}/applied-solvers`: 応募ソルバーの追加
- `PUT /api/project-requirements/{requirementId}/applied-solvers/{solverId}`: 応募ソルバーのステータス更新
- `DELETE /api/project-requirements/{requirementId}/applied-solvers/{solverId}`: 応募ソルバーの削除

## シーケンス・フロー

### メインフロー
1. 人材要件詳細画面から「変更する」ボタンクリック
2. 応募ソルバー画面へ遷移（要件IDを受け取る）
3. 初期表示処理
   - 既存の応募ソルバー一覧を取得
   - 個人ソルバーとソルバー候補を分けて表示
4. ソルバーの追加/編集
   - ポップアップからソルバーを選択追加
   - ステータスの変更
   - 不要なソルバーの削除
5. 「変更する」ボタンクリック
   - 更新内容をAPIに送信
   - 成功時は完了画面へ遷移

### ポップアップでのソルバー追加フロー
1. 「＋」ボタンクリック
2. ポップアップ表示
3. 既存ソルバーから選択の場合
   - 検索条件入力
   - 検索実行
   - 一覧から選択
   - 追加ボタンクリック
   - メイン画面に反映
4. 新規ソルバー候補追加の場合
   - 「新規ソルバー候補を追加」選択
   - 「新規登録」ボタンクリック
   - 別タブで申請画面が開く
   - 申請完了後、元タブに戻る

---

*作成日: 2025年1月*
*バージョン: 1.0*