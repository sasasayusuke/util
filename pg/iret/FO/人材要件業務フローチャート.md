# 人材要件業務フローチャート

## 📋 概要
人材要件管理システムにおける、人材要件の登録から応募ソルバー管理までの業務フローを記載します。
このシステムは、Sony Acceleration Platform（SAP）における案件に対する人材要件と、その要件に応募するソルバー（支援者）を管理するためのものです。

---

## 🔍 参考資料
- 参照したPDF: 【FY25】ソルバーソーシング機能(対応範囲のみ）.pdf
- 参照した設計書: 人材要件一覧画面_設計書.md、人材要件詳細画面_設計書.md、応募ソルバー画面_設計書.md
- 関連ソースコード: ssap-partner-portal-fo-frontend/src/lang/ja.json（ラベル定義）

---

## 📊 フローチャート

```mermaid
%%{init: {'theme':'base', 'themeVariables': {'primaryColor':'#e1d5e7'}}}%%
flowchart TD
    Start([開始]) --> A[メニュー画面<br/>操作: 「人材要件」メニュークリック]
    A --> B[人材要件一覧画面<br/>・人材要件の一覧表示<br/>・絞り込み検索機能]
    
    B --> C{操作選択}
    C -->|絞り込み検索| D[検索条件入力<br/>・タイトル<br/>・ステータス]
    D --> E[「絞り込み」ボタンクリック]
    E --> F[絞り込み結果表示]
    F --> C
    
    C -->|詳細確認| G[人材要件Noクリック<br/>選択した要件の詳細を確認]
    G --> H[人材要件詳細画面<br/>・専門テーマ<br/>・依頼業務<br/>・求められるスキル<br/>・稼働条件]
    
    H --> I{操作選択}
    I -->|戻る| J[「一覧へ戻る」クリック]
    J --> B
    
    I -->|応募ソルバー管理| K{ステータス確認}
    K -->|完了以外| L[「変更する」ボタンクリック]
    K -->|完了| M[ボタン非活性<br/>変更不可]
    M --> I
    
    L --> N[応募ソルバー画面<br/>・既存ソルバー管理<br/>・新規ソルバー追加]
    
    N --> O{操作選択}
    O -->|ソルバー追加| P[「＋」ボタンクリック]
    P --> Q{追加方法選択}
    
    Q -->|個人ソルバー| R[個人ソルバー追加ポップアップ]
    R --> S[既存ソルバー検索・選択]
    S --> T[「追加」ボタンクリック]
    T --> U[一覧に追加]
    U --> O
    
    Q -->|ソルバー候補| V[ソルバー候補追加ポップアップ]
    V --> W{選択方法}
    W -->|既存候補| X[既存候補検索・選択]
    X --> Y[「追加」ボタンクリック]
    Y --> U
    
    W -->|新規候補| Z[「新規登録」ボタンクリック]
    Z --> AA[新規個人ソルバー申請画面<br/>（別タブで開く）]
    AA --> AB[申請完了後、元タブに戻る]
    AB --> O
    
    O -->|ステータス変更| AC[ステータスセレクトボックス操作<br/>・未選定<br/>・選定済<br/>・非選定]
    AC --> AD[選定済み人数自動更新]
    AD --> O
    
    O -->|保存| AE{選定人数チェック}
    AE -->|必要人数以下| AF[「変更する」ボタンクリック]
    AF --> AG[更新処理実行]
    AG --> AH[完了画面表示]
    AH --> End([終了])
    
    AE -->|必要人数超過| AI[エラー表示<br/>「必要人数を超えて選定することはできません」]
    AI --> O
    
    O -->|キャンセル| AJ[「キャンセル」ボタンクリック]
    AJ --> AK[確認ダイアログ表示]
    AK --> AL{確認}
    AL -->|はい| B
    AL -->|いいえ| O
```

---

## 🖥️ 画面別操作詳細

### 1. 人材要件一覧画面（URL: /project-requirements）
**ソースファイル**: `src/pages/project-requirements/list.vue`（推定）

#### 操作可能な要素:
| ラベル名（表示） | ソース上の名称 | 動作 | 次の遷移先 |
|----------------|--------------|------|-----------|
| 人材要件No | requirement_no | クリックで詳細表示 | 人材要件詳細画面 |
| 絞り込み | filter_button | 検索条件で絞り込み | 同画面（再表示） |
| リセット | reset_button | 検索条件クリア | 同画面（初期表示） |

#### 入力項目:
| 項目名（表示） | フィールド名 | 必須/任意 | バリデーション |
|--------------|-------------|----------|--------------|
| 絞り込み用タイトル | filter_title | 任意 | 最大文字数制限 |
| 絞り込み用ステータス | filter_status | 任意 | セレクトボックス |

### 2. 人材要件詳細画面（URL: /project-requirements/{requirementId}）
**ソースファイル**: `src/pages/project-requirements/_requirementId.vue`（推定）

#### 操作可能な要素:
| ラベル名（表示） | ソース上の名称 | 動作 | 次の遷移先 |
|----------------|--------------|------|-----------|
| 一覧へ戻る | back_to_list | 一覧画面へ遷移 | 人材要件一覧画面 |
| 変更する | edit_button | 応募ソルバー管理へ | 応募ソルバー画面 |
| 案件URL | project_url | 外部リンク | 案件詳細（外部） |

### 3. 応募ソルバー画面（URL: /project-requirements/{requirementId}/applied-solvers）
**ソースファイル**: `src/pages/project-requirements/applied-solvers.vue`（推定）

#### 操作可能な要素:
| ラベル名（表示） | ソース上の名称 | 動作 | 次の遷移先 |
|----------------|--------------|------|-----------|
| ＋（個人ソルバー） | add_solver | ポップアップ表示 | - |
| ＋（ソルバー候補） | add_candidate | ポップアップ表示 | - |
| 編集 | edit_solver | 詳細編集（別タブ） | ソルバー詳細 |
| 詳細 | view_candidate | 詳細表示（別タブ） | 候補者詳細 |
| 変更する | save_changes | 更新処理実行 | 完了画面 |
| キャンセル | cancel | 変更破棄 | 確認ダイアログ |

---

## 🔄 処理フロー詳細

### STEP 1: 人材要件一覧の表示
**実行画面**: 人材要件一覧画面
**トリガー**: メニューから「人材要件」選択

1. **画面操作**
   - 場所: グローバルメニュー
   - 操作: 「人材要件」メニュークリック
   - ラベル: 「人材要件」

2. **内部処理**
   - API呼び出し: `GET /api/project-requirements`
   - データ処理: 一覧データの取得・整形

3. **結果**
   - 成功時: 人材要件一覧を表示
   - エラー時: エラーメッセージを画面上部に表示

### STEP 2: 人材要件の絞り込み検索
**実行画面**: 人材要件一覧画面
**トリガー**: 「絞り込み」ボタンクリック

1. **画面操作**
   - 場所: 画面上部の検索エリア
   - 操作: 検索条件入力後、「絞り込み」ボタンクリック
   - ラベル: 「絞り込み」

2. **内部処理**
   - API呼び出し: `GET /api/project-requirements?title={title}&status={status}`
   - データ処理: 検索条件に合致するデータの取得

3. **結果**
   - 成功時: 絞り込み結果を表示
   - データなし: 「表示する情報がありません」メッセージ

### STEP 3: 応募ソルバーの管理
**実行画面**: 応募ソルバー画面
**トリガー**: 人材要件詳細画面から「変更する」ボタンクリック

1. **画面操作**
   - 場所: 人材要件詳細画面下部
   - 操作: 「変更する」ボタンクリック
   - ラベル: 「変更する」

2. **内部処理**
   - API呼び出し: `GET /api/project-requirements/{requirementId}/applied-solvers`
   - データ処理: 既存の応募ソルバー情報取得

3. **結果**
   - 成功時: 応募ソルバー画面を表示
   - エラー時: エラーメッセージ表示

### STEP 4: ソルバーの追加
**実行画面**: 応募ソルバー画面
**トリガー**: 「＋」ボタンクリック

1. **画面操作**
   - 場所: 各セクションヘッダー右側
   - 操作: 「＋」ボタンクリック
   - ラベル: 「＋」

2. **内部処理**
   - ポップアップ表示
   - 検索API呼び出し: `GET /api/solvers` または `GET /api/solver-candidates`

3. **結果**
   - 成功時: 選択したソルバーを一覧に追加
   - 重複時: 「既に追加されています」エラー

---

## ⚠️ 注意事項・エラー処理

### よくあるエラーパターン
| エラー種別 | 発生条件 | 表示メッセージ | 対処法 |
|-----------|---------|--------------|--------|
| 必要人数超過 | 選定済み人数が必要人数を超える | 必要人数を超えて選定することはできません | 選定済みを減らす |
| ステータス未選択 | 選定済みでステータス未選択 | ステータスを選択してください | ステータス選択 |
| 権限エラー | アクセス権限なし | このページを参照する権限がありません | 管理者に連絡 |
| 重複登録 | 既に登録済みのソルバー追加 | 既に追加されています | 別のソルバー選択 |

---

## 👥 ロール別の違い
| ロール | 利用可能機能 | 制限事項 |
|--------|------------|---------|
| APT | 全機能利用可能 | なし |
| 法人ソルバー | 自社関連の要件のみ参照・管理可能 | 他社の要件は表示されない |
| 個人ソルバー | アクセス不可 | 画面自体にアクセス不可 |

---

## 📝 補足情報
- **ソーシング期限**: 人材要件ごとに設定される期限。この日までに必要人数のソルバーを選定する必要がある
- **ステータスの意味**:
  - 未選定: まだ選定されていない状態
  - 選定済: この要件に選定された状態（必要人数までカウント）
  - 非選定: 選定から外れた状態
- **必要人数と選定済み人数**: 選定済みステータスのソルバー数が自動カウントされ、必要人数を超えることはできない
- **別タブでの操作**: 編集や新規登録は別タブで開くため、元の画面のデータは保持される