# ソルバーメニュー画面 設計書

## 関連課題

* なし

## 機能概要

ソルバー関連機能への入口となるメニュー画面。
法人ソルバーを選択することで、その法人に関連する個人ソルバー、ソルバー候補、月次更新、人材要件などの各種機能にアクセスできる。

## 画面デザイン

※後日添付

## 利用可能権限

| ロール | 条件 |
|--------|------|
| APT | 全機能利用可能、全法人ソルバー選択可能 |
| 法人ソルバー | 自社のみ選択可能、自社関連機能のみ利用可能 |
| 個人ソルバー | アクセス不可 |

## 項目定義


| 画面項目名 | 項目種別 | I/O | データ型 | 必須 | 初期値 | プレースホルダー | 入力制約 | 備考 |
|------------|----------|-----|----------|------|--------|------------------|----------|------|
| 法人ソルバー選択 | セレクトボックス | I/O | 文字列 | ○ |  | 法人ソルバーを選択 | | ログインユーザーの権限に応じて選択肢を制御 |
| 法人ソルバー情報詳細 | リンク | O | - |  |  |  | | 選択した法人ソルバーの詳細画面へのリンク |
| 個人ソルバーセクション | テキスト | O | 文字列 |  | 個人ソルバー |  | | セクションタイトル |
| 個人ソルバー一覧 | リンク | O | - |  |  |  | | メニュー項目 |
| 新規個人ソルバー申請 | リンク | O | - |  |  |  | | メニュー項目 |
| ソルバー候補セクション | テキスト | O | 文字列 |  | ソルバー候補 |  | | セクションタイトル |
| ソルバー候補一覧 | リンク | O | - |  |  |  | | メニュー項目 |
| 新規ソルバー候補申請 | リンク | O | - |  |  |  | | メニュー項目 |
| 月次更新セクション | テキスト | O | 文字列 |  | 月次更新 |  | | セクションタイトル |
| 稼働率・単価更新 | リンク | O | - |  |  |  | | メニュー項目 |
| 人材要件セクション | テキスト | O | 文字列 |  | 人材要件 |  | | セクションタイトル |
| 人材要件 | リンク | O | - |  |  |  | | メニュー項目 |

## バリデーション

| 画面項目名 | チェック場所 | チェック内容 | エラーメッセージ | 備考 |
|------------|--------------|--------------------------|--------------------------|---------|
| 法人ソルバー選択 | F | 必須チェック | 法人ソルバーを選択してください | メニュー項目クリック時 |

* F：フロントエンド
* B：バックエンド

## リンク・ボタン項目

| ボタン・リンク名 | 項目種別 | 遷移先 | 初期状態（活性・非活性） | 備考 |
|------------------|----------|--------|-------------------------|------|
| 法人ソルバー情報詳細 | リンク | /solver-corporations/{corporationId} | 非活性 | 法人ソルバー選択時に活性化 |
| 個人ソルバー一覧 | リンク | /solvers | 非活性 | 法人ソルバー選択時に活性化 |
| 新規個人ソルバー申請 | リンク | /solver/application | 非活性 | 法人ソルバー選択時に活性化 |
| ソルバー候補一覧 | リンク | /solver-candidates | 非活性 | 法人ソルバー選択時に活性化 |
| 新規ソルバー候補申請 | リンク | /solver-candidate/application | 非活性 | 法人ソルバー選択時に活性化 |
| 稼働率・単価更新 | リンク | /solver/monthly-update | 非活性 | 法人ソルバー選択時に活性化 |
| 人材要件 | リンク | /project-requirements | 非活性 | 法人ソルバー選択時に活性化 |

## イベント定義

| イベント | 処理概要 | 異常時の処理 | 備考 |
|----------|----------|--------------|------|
| 画面初期表示 | ログインユーザーの権限を確認し、選択可能な法人ソルバーリストを取得 | エラーメッセージを画面上部に表示 | |
| 法人ソルバー選択 | 選択した法人ソルバーIDをセッションに保存、メニュー項目を活性化 | - | |
| メニュー項目クリック | 法人ソルバー未選択チェック後、各画面へ遷移 | 法人ソルバー選択を促すメッセージ表示 | |

## 利用DB

| 場所（NPF/ PP） | テーブル名 | CRUD | 備考 |
|-----------------|------------|------|------|
| PP | solver_corporations | R | 法人ソルバー一覧の取得 |
| PP | users | R | ユーザー権限の確認 |

## 利用API

- `GET /api/solver-corporations`: 法人ソルバー一覧の取得
  - クエリパラメータ: userId（ログインユーザーのID）
  - レスポンス: 選択可能な法人ソルバーリスト

## シーケンス・フロー

### 初期表示フロー
1. ユーザーがソルバーメニュー画面にアクセス
2. ログインユーザーの権限を確認
3. 権限に応じた法人ソルバーリストを取得
   - APT権限: 全法人ソルバー
   - 法人ソルバー権限: 自社のみ
4. 法人ソルバー選択ドロップダウンにリストを設定
5. メニュー項目は非活性状態で表示

### 法人ソルバー選択フロー
1. ドロップダウンから法人ソルバーを選択
2. 選択した法人ソルバーIDをセッションに保存
3. 各メニュー項目を活性化
4. 法人ソルバー情報詳細リンクを活性化

### メニュー遷移フロー
1. メニュー項目をクリック
2. 法人ソルバー選択チェック
   - 未選択の場合: エラーメッセージ表示
   - 選択済みの場合: 各画面へ遷移（法人ソルバーIDをパラメータとして渡す）