import freezegun
import pytest
from app.main import app
from app.models.project import (
    GrossProfitAttribute,
    ProjectModel,
    SalesforceMainCustomerAttribute,
)
from app.models.project_survey import (
    AnswersAttribute,
    PointsAttribute,
    ProjectSurveyModel,
    SupporterUserAttribute,
)
from app.models.user import UserModel
from app.resources.const import DataType, UserRoleType
from fastapi.testclient import TestClient

client = TestClient(app)


@freezegun.freeze_time("2022-01-01T22:42:05.033Z")
class TestGetSurveys:
    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "?summaryMonth=202201&projectId=111a46d3-1d56-428b-ac6d-a51e263b54a8&customerId=3c648558-c450-42d7-9c4b-62e0f22dc0ff&serviceTypeId=7ac8bddf-88da-46c9-a504-a03d1661ad58&isFinished=false&type=pp&organizationIds=de40733f-6be9-4fef-8229-01052f43c1e2,de40733f-6be9-4fef-8229-01052f43c1e2,4c1f0a21-b11d-4c98-b2d7-33bbca9e63c3",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 3},
                        },
                    },
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        job="部長",
                        supporter_organization_id=[
                            "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d"
                        ],
                        organization_name="IST",
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        role="supporter_mgr",
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_ok(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """正常"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "?summaryMonth=202201&projectId=111a46d3-1d56-428b-ac6d-a51e263b54a8&customerId=3c648558-c450-42d7-9c4b-62e0f22dc0ff&serviceTypeId=7ac8bddf-88da-46c9-a504-a03d1661ad58&isFinished=false&type=quick&organizationIds=de40733f-6be9-4fef-8229-01052f43c1e2,de40733f-6be9-4fef-8229-01052f43c1e2,4c1f0a21-b11d-4c98-b2d7-33bbca9e63c3",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="quick",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="quick",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="quick",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": None,
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "quick",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "quick",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "quick",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        job="部長",
                        supporter_organization_id=[
                            "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d"
                        ],
                        organization_name="IST",
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        role="supporter_mgr",
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_ok_type_quick_no_summary(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """正常"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "?planSurveyResponseDateFrom=20220101&planSurveyResponseDateTo=20220131&projectId=111a46d3-1d56-428b-ac6d-a51e263b54a8&customerId=3c648558-c450-42d7-9c4b-62e0f22dc0ff&isFinished=false&type=pp&organizationIds=de40733f-6be9-4fef-8229-01052f43c1e2,de40733f-6be9-4fef-8229-01052f43c1e2,4c1f0a21-b11d-4c98-b2d7-33bbca9e63c3",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 3},
                        },
                    },
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        job="部長",
                        supporter_organization_id=[
                            "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d"
                        ],
                        organization_name="IST",
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        role="supporter_mgr",
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_ok_specified_planSurveyResponseDate(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """正常"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "?summaryMonth=202201&customerId=3c648558-c450-42d7-9c4b-62e0f22dc0ff&isFinished=false&type=pp&organizationIds=de40733f-6be9-4fef-8229-01052f43c1e2,de40733f-6be9-4fef-8229-01052f43c1e2,4c1f0a21-b11d-4c98-b2d7-33bbca9e63c3",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 3},
                        },
                    },
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        job="部長",
                        supporter_organization_id=[
                            "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d"
                        ],
                        organization_name="IST",
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        role="supporter_mgr",
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_ok_no_specified_project_id(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """正常"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "?summaryMonth=202201&customerId=3c648558-c450-42d7-9c4b-62e0f22dc0ff&isFinished=false&organizationIds=de40733f-6be9-4fef-8229-01052f43c1e2,de40733f-6be9-4fef-8229-01052f43c1e2,4c1f0a21-b11d-4c98-b2d7-33bbca9e63c3",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 3},
                        },
                    },
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        job="部長",
                        supporter_organization_id=[
                            "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d"
                        ],
                        organization_name="IST",
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        role="supporter_mgr",
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_ok_no_specified_project_id_and_type(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """正常"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "?summaryMonth=202201&customerId=3c648558-c450-42d7-9c4b-62e0f22dc0ff&isFinished=false&organizationIds=de40733f-6be9-4fef-8229-01052f43c1e2,de40733f-6be9-4fef-8229-01052f43c1e2,4c1f0a21-b11d-4c98-b2d7-33bbca9e63c3",
                [],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 0.0, "receive": 0},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 0.0, "receive": 0},
                            },
                            "year": {"satisfactionAverage": 0.0, "receive": 0},
                        },
                    },
                    "surveys": [],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        job="部長",
                        supporter_organization_id=[
                            "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d"
                        ],
                        organization_name="IST",
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        role="supporter_mgr",
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_ok_zero(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """正常0件"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 3},
                        },
                    },
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        job="部長",
                        supporter_organization_id=[
                            "89cbe2ed-f44c-4a1c-9408-c67b0ca2270d"
                        ],
                        organization_name="IST",
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        role="supporter_mgr",
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_ok_no_specified(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """正常"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        answer_user_name="山田太郎",
                        customer_id="106a3144-9650-4a34-8a23-3b02f3b9aeac",
                        customer_name="取引先株式会社",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": None,
                    "surveys": [
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                            "answerUserName": "山田太郎",
                            "customerId": "106a3144-9650-4a34-8a23-3b02f3b9aeac",
                            "customerName": "取引先株式会社",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        customer_id="106a3144-9650-4a34-8a23-3b02f3b9aeac",
                        customer_name="取引先株式会社",
                        job="部長",
                        organization_name="コンサルティング事業部",
                        project_ids=["886a3144-9650-4a34-8a23-3b02f3b9aeac"],
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        agreed=True,
                        role=UserRoleType.CUSTOMER.key,
                        version=1,
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_customer_user")
    def test_ok_visible_only_for_customer(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """権限確認：顧客でアクセス可能な情報のみ取得"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "",
                [
                    # 主担当支援者、支援者へ開示OK
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                            name="山田太郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 主担当支援者、支援者へ開示NG
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                            name="山田太郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=False,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 主担当支援者でも副担当支援者でもない
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 副担当支援者、支援者へ開示OK
                    ProjectSurveyModel(
                        id="44444449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                name="山田太郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 副担当支援者、支援者へ開示NG
                    ProjectSurveyModel(
                        id="55555449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                name="山田太郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=False,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 2},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 2},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 2},
                        },
                    },
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                    "name": "山田太郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                ProjectModel(
                    id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                    data_type=DataType.PROJECT,
                    salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                    name="サンプルプロジェクト１",
                    customer_name="ソニーグループ株式会社",
                    service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    create_new=True,
                    continued=True,
                    main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                    contract_date="2021/01/30",
                    phase="プラン提示(D)",
                    customer_success="DXの実現",
                    support_date_from="2021/01/30",
                    support_date_to="2021/02/28",
                    profit=GrossProfitAttribute(
                        monthly=[
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                            400000,
                        ],
                        quarterly=[1200000, 1200000, 1200000, 1200000],
                        half=[2400000, 2400000],
                        year=4800000,
                    ),
                    total_contract_time=200,
                    main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                    salesforce_main_customer=SalesforceMainCustomerAttribute(
                        name="山田太郎",
                        email="yamada@example.com",
                        organization_name="IST",
                        job="部長",
                    ),
                    customer_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                    supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                    salesforce_main_supporter_user_name="山田太郎",
                    supporter_user_ids=set(
                        list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                    ),
                    salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                    is_count_man_hour=True,
                    is_karte_remind=True,
                    contract_type="有償",
                    is_secret=False,
                    create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    create_at="2022-05-23T16:34:21.523000+0000",
                    update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                    update_at="2022-05-23T16:34:21.523000+0000",
                    version=1,
                ),
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        company="テスト株式会社",
                        supporter_organization_id=[
                            "556a3144-9650-4a34-8a23-3b02f3b9aeac"
                        ],
                        is_input_man_hour=True,
                        project_ids=["886a3144-9650-4a34-8a23-3b02f3b9aeac"],
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        agreed=True,
                        role=UserRoleType.SUPPORTER.key,
                        version=1,
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_supporter_user")
    def test_ok_visible_only_for_supporter(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """権限確認：支援者でアクセス可能な情報のみ取得"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "",
                [
                    # 非所属課の非公開案件アンケート
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト２",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 所属課の非公開案件アンケート：アクセス可能
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト２",
                        customer_success="DXの実現",
                        supporter_organization_id="556a3144-9650-4a34-8a23-3b02f3b9aeac",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                            name="山田太郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 所属課の公開案件アンケート：アクセス可能
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト２",
                        customer_success="DXの実現",
                        supporter_organization_id="556a3144-9650-4a34-8a23-3b02f3b9aeac",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                name="山田太郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 非所属課の公開案件アンケート：アクセス可能
                    ProjectSurveyModel(
                        id="44444449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 3},
                        },
                    },
                    "surveys": [
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "556a3144-9650-4a34-8a23-3b02f3b9aeac",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                "name": "山田太郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "556a3144-9650-4a34-8a23-3b02f3b9aeac",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                                    "name": "山田太郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "44444449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                [
                    # 公開案件
                    ProjectModel(
                        id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        data_type=DataType.PROJECT,
                        salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        name="サンプルプロジェクト１",
                        customer_name="ソニーグループ株式会社",
                        service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        create_new=True,
                        continued=True,
                        main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        contract_date="2021/01/30",
                        phase="プラン提示(D)",
                        customer_success="DXの実現",
                        support_date_from="2021/01/30",
                        support_date_to="2021/02/28",
                        profit=GrossProfitAttribute(
                            monthly=[
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                            ],
                            quarterly=[1200000, 1200000, 1200000, 1200000],
                            half=[2400000, 2400000],
                            year=4800000,
                        ),
                        total_contract_time=200,
                        main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        salesforce_main_customer=SalesforceMainCustomerAttribute(
                            name="山田太郎",
                            email="yamada@example.com",
                            organization_name="IST",
                            job="部長",
                        ),
                        customer_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        salesforce_main_supporter_user_name="山田太郎",
                        supporter_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type="有償",
                        is_secret=False,
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 非公開案件
                    ProjectModel(
                        id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        data_type=DataType.PROJECT,
                        salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        name="サンプルプロジェクト２",
                        customer_name="ソニーグループ株式会社",
                        service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        create_new=True,
                        continued=True,
                        main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        contract_date="2021/01/30",
                        phase="プラン提示(D)",
                        customer_success="DXの実現",
                        support_date_from="2021/01/30",
                        support_date_to="2021/02/28",
                        profit=GrossProfitAttribute(
                            monthly=[
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                            ],
                            quarterly=[1200000, 1200000, 1200000, 1200000],
                            half=[2400000, 2400000],
                            year=4800000,
                        ),
                        total_contract_time=200,
                        main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        salesforce_main_customer=SalesforceMainCustomerAttribute(
                            name="山田太郎",
                            email="yamada@example.com",
                            organization_name="IST",
                            job="部長",
                        ),
                        customer_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        salesforce_main_supporter_user_name="山田太郎",
                        supporter_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type="有償",
                        is_secret=True,
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        company="テスト株式会社",
                        supporter_organization_id=[
                            "556a3144-9650-4a34-8a23-3b02f3b9aeac"
                        ],
                        is_input_man_hour=True,
                        project_ids=["886a3144-9650-4a34-8a23-3b02f3b9aeac"],
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        agreed=True,
                        role=UserRoleType.SUPPORTER_MGR.key,
                        version=1,
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_supporter_mgr_user")
    def test_ok_visible_only_for_supporter_mgr(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """権限確認：支援者責任者でアクセス可能な情報のみ取得"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "",
                [
                    # 所属していない非公開案件のアンケート
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト２",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 所属している非公開案件のアンケート：アクセス可能
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト２",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 所属していない公開案件のアンケート：アクセス可能
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 2,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 2},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 2},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 2},
                        },
                    },
                    "surveys": [
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "906a3144-9650-4a34-8a23-3b02f3b9aeac",
                            "salesUserName": "山田太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                [
                    # 公開案件
                    ProjectModel(
                        id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        data_type=DataType.PROJECT,
                        salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        name="サンプルプロジェクト１",
                        customer_name="ソニーグループ株式会社",
                        service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        create_new=True,
                        continued=True,
                        main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        contract_date="2021/01/30",
                        phase="プラン提示(D)",
                        customer_success="DXの実現",
                        support_date_from="2021/01/30",
                        support_date_to="2021/02/28",
                        profit=GrossProfitAttribute(
                            monthly=[
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                            ],
                            quarterly=[1200000, 1200000, 1200000, 1200000],
                            half=[2400000, 2400000],
                            year=4800000,
                        ),
                        total_contract_time=200,
                        main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        salesforce_main_customer=SalesforceMainCustomerAttribute(
                            name="山田太郎",
                            email="yamada@example.com",
                            organization_name="IST",
                            job="部長",
                        ),
                        customer_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        salesforce_main_supporter_user_name="山田太郎",
                        supporter_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type="有償",
                        is_secret=False,
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 非公開案件
                    ProjectModel(
                        id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        data_type=DataType.PROJECT,
                        salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        name="サンプルプロジェクト２",
                        customer_name="ソニーグループ株式会社",
                        service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        create_new=True,
                        continued=True,
                        main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        contract_date="2021/01/30",
                        phase="プラン提示(D)",
                        customer_success="DXの実現",
                        support_date_from="2021/01/30",
                        support_date_to="2021/02/28",
                        profit=GrossProfitAttribute(
                            monthly=[
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                            ],
                            quarterly=[1200000, 1200000, 1200000, 1200000],
                            half=[2400000, 2400000],
                            year=4800000,
                        ),
                        total_contract_time=200,
                        main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        salesforce_main_customer=SalesforceMainCustomerAttribute(
                            name="山田太郎",
                            email="yamada@example.com",
                            organization_name="IST",
                            job="部長",
                        ),
                        customer_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        salesforce_main_supporter_user_name="山田太郎",
                        supporter_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type="有償",
                        is_secret=True,
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        company="テスト株式会社",
                        is_input_man_hour=True,
                        project_ids=["886a3144-9650-4a34-8a23-3b02f3b9aeac"],
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        agreed=True,
                        role=UserRoleType.SALES.key,
                        version=1,
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_sales_user")
    def test_ok_visible_only_for_sales(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """権限確認：営業担当者でアクセス可能な情報のみ取得"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param, survey_models, expected, project_model, user_models",
        [
            (
                "",
                [
                    ProjectSurveyModel(
                        id="11111449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト２",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="22222449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    ProjectSurveyModel(
                        id="33333449-5d63-42d4-ae1b-f0faf65a7076",
                        data_type=DataType.SURVEY,
                        survey_master_id="9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                        survey_master_revision=4,
                        survey_type="pp",
                        project_id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        project_name="サンプルプロジェクト",
                        customer_success="DXの実現",
                        supporter_organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                        supporter_organization_name="IST",
                        support_date_from="2021/06/01",
                        support_date_to="2022/12/31",
                        main_supporter_user=SupporterUserAttribute(
                            id="51ff73f4-2414-421c-b64c-9981f988b331",
                            name="田中 三郎",
                            organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                            organization_name="AST",
                        ),
                        supporter_users=[
                            SupporterUserAttribute(
                                id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                name="田中 次郎",
                                organization_id="de40733f-6be9-4fef-8229-01052f43c1e2",
                                organization_name="AST",
                            )
                        ],
                        sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        service_type_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        service_type_name="組織開発",
                        answer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        answer_user_name="田中 次郎",
                        customer_id="d6121808-341d-4883-8e2c-69462acf6ccb",
                        customer_name="あああ研究所",
                        company="ソニーグループ株式会社",
                        answers=[
                            AnswersAttribute(
                                id="89cbe2ed-f44c-4a1c-9408-c67b0ca2270d",
                                answer="問題なし",
                                point=3,
                            )
                        ],
                        summary_month="2022/01",
                        plan_survey_request_datetime="2022/01/15 01:00",
                        actual_survey_request_datetime="2022/01/15 01:10",
                        plan_survey_response_datetime="2022/01/31 17:00",
                        actual_survey_response_datetime="2022/01/30 10:00",
                        is_finished=False,
                        is_disclosure=True,
                        is_not_summary=False,
                        points=PointsAttribute(
                            satisfaction=3,
                            continuation=False,
                            recommended=3,
                            sales=0,
                            survey_satisfaction=4,
                            man_hour_satisfaction=4,
                            karte_satisfaction=4,
                            master_karte_satisfaction=0,
                        ),
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                {
                    "summary": {
                        "monthly": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                        ],
                        "accumulation": [
                            {
                                "month": "2021年4月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年5月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年6月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年7月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年8月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年9月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年10月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年11月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2021年12月",
                                "satisfactionAverage": 0.0,
                                "receive": 0,
                            },
                            {
                                "month": "2022年1月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年2月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                            {
                                "month": "2022年3月",
                                "satisfactionAverage": 3.0,
                                "receive": 3,
                            },
                        ],
                        "total": {
                            "quota": {
                                "quota1": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota2": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota3": {"satisfactionAverage": 0.0, "receive": 0},
                                "quota4": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "half": {
                                "half1": {"satisfactionAverage": 0.0, "receive": 0},
                                "half2": {"satisfactionAverage": 3.0, "receive": 3},
                            },
                            "year": {"satisfactionAverage": 3.0, "receive": 3},
                        },
                    },
                    "surveys": [
                        {
                            "id": "11111449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "222a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト２",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "22222449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                        {
                            "id": "33333449-5d63-42d4-ae1b-f0faf65a7076",
                            "surveyMasterId": "9fb8c7c1-fa03-48ce-b0b1-be8fe638fabf",
                            "surveyRevision": 4,
                            "surveyType": "pp",
                            "projectId": "111a46d3-1d56-428b-ac6d-a51e263b54a8",
                            "projectName": "サンプルプロジェクト",
                            "customerSuccess": "DXの実現",
                            "supporterOrganizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                            "supporterOrganizationName": "IST",
                            "supportDateFrom": "2021/06/01",
                            "supportDateTo": "2022/12/31",
                            "mainSupporterUser": {
                                "id": "51ff73f4-2414-421c-b64c-9981f988b331",
                                "name": "田中 三郎",
                                "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                "organizationName": "AST",
                            },
                            "supporterUsers": [
                                {
                                    "id": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                                    "name": "田中 次郎",
                                    "organizationId": "de40733f-6be9-4fef-8229-01052f43c1e2",
                                    "organizationName": "AST",
                                }
                            ],
                            "salesUserId": "1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                            "salesUserName": "田中 太郎",
                            "serviceTypeId": "7ac8bddf-88da-46c9-a504-a03d1661ad58",
                            "serviceTypeName": "組織開発",
                            "answerUserId": "7b36cc66-fe66-495f-b416-16ecc879fbaa",
                            "answerUserName": "田中 次郎",
                            "customerId": "d6121808-341d-4883-8e2c-69462acf6ccb",
                            "customerName": "あああ研究所",
                            "company": "ソニーグループ株式会社",
                            "summaryMonth": "2022/01",
                            "isNotSummary": False,
                            "planSurveyRequestDatetime": "2022/01/15 01:00",
                            "actualSurveyRequestDatetime": "2022/01/15 01:10",
                            "planSurveyResponseDatetime": "2022/01/31 17:00",
                            "actualSurveyResponseDatetime": "2022/01/30 10:00",
                            "isFinished": False,
                            "isDisclosure": True,
                        },
                    ],
                },
                [
                    # 公開案件
                    ProjectModel(
                        id="111a46d3-1d56-428b-ac6d-a51e263b54a8",
                        data_type=DataType.PROJECT,
                        salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        name="サンプルプロジェクト１",
                        customer_name="ソニーグループ株式会社",
                        service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        create_new=True,
                        continued=True,
                        main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        contract_date="2021/01/30",
                        phase="プラン提示(D)",
                        customer_success="DXの実現",
                        support_date_from="2021/01/30",
                        support_date_to="2021/02/28",
                        profit=GrossProfitAttribute(
                            monthly=[
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                            ],
                            quarterly=[1200000, 1200000, 1200000, 1200000],
                            half=[2400000, 2400000],
                            year=4800000,
                        ),
                        total_contract_time=200,
                        main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        salesforce_main_customer=SalesforceMainCustomerAttribute(
                            name="山田太郎",
                            email="yamada@example.com",
                            organization_name="IST",
                            job="部長",
                        ),
                        customer_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        salesforce_main_supporter_user_name="山田太郎",
                        supporter_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type="有償",
                        is_secret=False,
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                    # 非公開案件
                    ProjectModel(
                        id="222a46d3-1d56-428b-ac6d-a51e263b54a8",
                        data_type=DataType.PROJECT,
                        salesforce_customer_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        customer_id="3c648558-c450-42d7-9c4b-62e0f22dc0ff",
                        name="サンプルプロジェクト２",
                        customer_name="ソニーグループ株式会社",
                        service_type="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        create_new=True,
                        continued=True,
                        main_sales_user_id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        contract_date="2021/01/30",
                        phase="プラン提示(D)",
                        customer_success="DXの実現",
                        support_date_from="2021/01/30",
                        support_date_to="2021/02/28",
                        profit=GrossProfitAttribute(
                            monthly=[
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                                400000,
                            ],
                            quarterly=[1200000, 1200000, 1200000, 1200000],
                            half=[2400000, 2400000],
                            year=4800000,
                        ),
                        total_contract_time=200,
                        main_customer_user_id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        salesforce_main_customer=SalesforceMainCustomerAttribute(
                            name="山田太郎",
                            email="yamada@example.com",
                            organization_name="IST",
                            job="部長",
                        ),
                        customer_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        main_supporter_user_id="51ff73f4-2414-421c-b64c-9981f988b331",
                        supporter_organization_id="7ac8bddf-88da-46c9-a504-a03d1661ad58",
                        salesforce_main_supporter_user_name="山田太郎",
                        supporter_user_ids=set(
                            list(["51ff73f4-2414-421c-b64c-9981f988b331"])
                        ),
                        salesforce_supporter_user_names=["山田太郎", "山田次郎"],
                        is_count_man_hour=True,
                        is_karte_remind=True,
                        contract_type="有償",
                        is_secret=False,
                        create_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        create_at="2022-05-23T16:34:21.523000+0000",
                        update_id="998c3cd7-63b5-453f-9de2-5af21d565b98",
                        update_at="2022-05-23T16:34:21.523000+0000",
                        version=1,
                    ),
                ],
                [
                    UserModel(
                        id="1b5e955f-4c1a-405d-b9ba-b618c8ba1edd",
                        data_type=DataType.USER,
                        name="田中 太郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="7b36cc66-fe66-495f-b416-16ecc879fbaa",
                        data_type=DataType.USER,
                        name="田中 次郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="51ff73f4-2414-421c-b64c-9981f988b331",
                        data_type=DataType.USER,
                        name="田中 三郎",
                        email="user@example.com",
                        role=UserRoleType.CUSTOMER,
                        customer_id="033bd0b5-c2c7-4778-a58d-76a46500f7d9",
                        customer_name="ソニーグループ株式会社",
                        job="部長",
                        company=None,
                        supporter_organization_id=None,
                        is_input_man_hour=None,
                        project_ids=None,
                        cognito_id=None,
                        agreed=False,
                        last_login_at=None,
                        disabled=False,
                        create_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        create_at="2020-10-23T03:21:39.356000+0000",
                        update_id="fa5c9f96-af22-bbc6-ac4e-cbcb25ad18e7",
                        update_at="2020-10-23T03:21:39.356000+0000",
                        version=1,
                    ),
                    UserModel(
                        id="906a3144-9650-4a34-8a23-3b02f3b9aeac",
                        data_type=DataType.USER,
                        name="山田太郎",
                        email="taro.yamada@example.com",
                        company="テスト株式会社",
                        is_input_man_hour=True,
                        project_ids=["886a3144-9650-4a34-8a23-3b02f3b9aeac"],
                        cognito_id="itk5s7d0-fj4s-kg05-b238-kld430d2bb97",
                        agreed=True,
                        role=UserRoleType.SALES_MGR.key,
                        version=1,
                    ),
                ],
            ),
        ],
    )
    @pytest.mark.usefixtures("auth_sales_mgr_user")
    def test_ok_visible_only_for_sales_mgr(
        self,
        mocker,
        query_param,
        survey_models,
        expected,
        project_model,
        user_models,
    ):
        """権限確認：営業責任者（制限なし）"""
        mock_user = mocker.patch.object(UserModel.data_type_name_index, "query")
        mock_user.return_value = user_models
        mock_project = mocker.patch.object(ProjectModel, "get")
        mock_project.return_value = project_model

        mock_survey = mocker.patch.object(
            ProjectSurveyModel.project_id_summary_month_index, "query"
        )
        mock_survey.return_value = survey_models
        mock_survey_2 = mocker.patch.object(
            ProjectSurveyModel.survey_type_summary_month_index, "query"
        )
        mock_survey_2.return_value = survey_models
        mock_survey_3 = mocker.patch.object(
            ProjectSurveyModel.data_type_summary_month_index, "query"
        )
        mock_survey_3.return_value = survey_models
        mock_survey_4 = mocker.patch.object(
            ProjectSurveyModel.data_type_plan_survey_response_datetime_index, "query"
        )
        mock_survey_4.return_value = survey_models

        response = client.get(f"/api/surveys{query_param}")

        actual = response.json()
        assert response.status_code == 200
        assert actual == expected

    @pytest.mark.parametrize(
        "query_param",
        [
            # summaryMonth
            "?summaryMonth=202013",
            # summaryMonthFrom
            "?summaryMonthFrom=202013",
            # summaryMonthTo
            "?summaryMonthTo=202013",
            # planSurveyResponseDateFrom
            "?planSurveyResponseDateFrom=20201301",
            # planSurveyResponseDateTo
            "?planSurveyResponseDateTo=20201301",
            # YearMonthFrom, summaryMonthTo の年月の逆転
            "?summaryMonthFrom=202202&summaryMonthTo=202201",
            # planSurveyResponseDateFrom, planSurveyResponseDateTo の年月日の逆転
            "?planSurveyResponseDateFrom=20220202&planSurveyResponseDateTo=20220201",
            # summaryMonth, summaryMonthFrom の重複指定
            "?summaryMonth=202202&summaryMonthFrom=202201",
            # summaryMonth, summaryMonthTo の重複指定
            "?summaryMonth=202202&summaryMonthTo=202201",
            # summaryMonth, planSurveyResponseDateFrom の重複指定
            "?summaryMonth=202202&planSurveyResponseDateFrom=20220101",
            # summaryMonth, planSurveyResponseDateTo の重複指定
            "?summaryMonth=202202&planSurveyResponseDateTo=20220101",
            # summaryMonthFrom, planSurveyResponseDateFrom の重複指定
            "?summaryMonthFrom=202202&planSurveyResponseDateFrom=20220101",
            # summaryMonthFrom, planSurveyResponseDateTo の重複指定
            "?summaryMonthFrom=202202&planSurveyResponseDateTo=20220101",
            # summaryMonthTo, planSurveyResponseDateFrom の重複指定
            "?summaryMonthTo=202202&planSurveyResponseDateFrom=20220101",
            # summaryMonthTo, planSurveyResponseDateTo の重複指定
            "?summaryMonthTo=202202&planSurveyResponseDateTo=20220101",
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_validation(
        self,
        mocker,
        query_param,
    ):
        """summaryMonth,summaryMonthFrom, summaryMonthTo, planSurveyResponseDateFrom, planSurveyResponseDateTo バリデーションエラー"""
        response = client.get(f"/api/surveys{query_param}")

        assert response.status_code == 400

    @pytest.mark.parametrize(
        "query_param",
        [
            # type
            "?type=pppp",
        ],
    )
    @pytest.mark.usefixtures("auth_user")
    def test_validation_enum(
        self,
        mocker,
        query_param,
    ):
        """typeのENUMバリデーションエラー"""
        response = client.get(f"/api/surveys{query_param}")

        assert response.status_code == 422
