//削除ボタン押したときの処理
async function o_BulkDelete() {
    try {
        // 選択されたIDを取得
        let selectedIds = $p.selectedIds();
        console.log(selectedIds);

        // 選択されていない場合はエラーメッセージ
        if (selectedIds.length === 0) {
            $p.setMessage('#Message', JSON.stringify({
                Css: 'alert-error',
                Text: 'レコードを選択してください。'
            }));
            return;
        }

        // 確認フォームの文言
        let confirmText = '削除してもよろしいですか。';
        // 確定して問題ないか聞く
        let answer = confirm(confirmText);
        if (!answer) {
            return;
        }

        // メッセージ出す
        $p.setMessage('#Message', JSON.stringify({
            Css: 'alert-warning',
            Text: '処理中です。'
        }));

        // レコードごとに処理（0.1秒ごとに実行）
        for (let i = 0; i < selectedIds.length; i++) {
            const selectedId = selectedIds[i];
            $p.apiDelete({
                id: selectedId
            });
        }

        // 処理中のメッセージ消す
        $p.clearMessage();
        // 完了のメッセージ出す
        $p.setMessage('#Message', JSON.stringify({
            Css: 'alert-success',
            Text: `${selectedIds.length}件のレコードを削除しました。`
        }));

    } catch (error) {
        console.error(error);
        $p.setMessage('#Message', JSON.stringify({
            Css: 'alert-error',
            Text: '処理中にエラーが発生しました。'
        }));
    }
}