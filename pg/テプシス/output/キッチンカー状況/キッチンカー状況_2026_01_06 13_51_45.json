{
  "HeaderInfo": {
    "AssemblyVersion": "1.4.1.1",
    "BaseSiteId": 253125,
    "Server": "http://192.168.10.67",
    "CreatorName": "Administrator",
    "PackageTime": "2026-01-06T04:51:45.9474652+00:00",
    "Convertors": [
      {
        "SiteId": 253125,
        "SiteTitle": "キッチンカー状況",
        "ReferenceType": "Results",
        "IncludeData": false
      }
    ],
    "IncludeSitePermission": true,
    "IncludeRecordPermission": true,
    "IncludeColumnPermission": true,
    "IncludeNotifications": true,
    "IncludeReminders": true
  },
  "Sites": [
    {
      "TenantId": 1,
      "SiteId": 253125,
      "Title": "キッチンカー状況",
      "SiteName": "",
      "SiteGroupName": "",
      "Body": "",
      "GridGuide": "",
      "EditorGuide": "",
      "CalendarGuide": "",
      "CrosstabGuide": "",
      "GanttGuide": "",
      "BurnDownGuide": "",
      "TimeSeriesGuide": "",
      "AnalyGuide": "",
      "KambanGuide": "",
      "ImageLibGuide": "",
      "ReferenceType": "Results",
      "ParentId": 253124,
      "InheritPermission": 253093,
      "SiteSettings": {
        "Version": 1.017,
        "ReferenceType": "Results",
        "GridColumns": [
          "ClassA",
          "DateA",
          "DateB",
          "ClassB",
          "DateC",
          "DateD"
        ],
        "FilterColumns": [
          "ClassD",
          "ClassE",
          "ClassF",
          "ClassG",
          "ClassH",
          "ClassI",
          "ClassJ",
          "ClassK",
          "ClassL",
          "ClassM",
          "ClassN",
          "ClassO",
          "ClassP",
          "ClassQ",
          "ClassR",
          "ClassS",
          "ClassT",
          "ClassU",
          "ClassV",
          "ClassW",
          "ClassX",
          "ClassY",
          "ClassZ",
          "NumA",
          "NumB",
          "NumC",
          "NumD",
          "NumE",
          "NumF",
          "NumG",
          "NumH",
          "NumI",
          "NumJ",
          "NumK",
          "NumL",
          "NumM",
          "NumN",
          "NumO",
          "NumP",
          "NumQ",
          "NumR",
          "NumS",
          "NumT",
          "NumU",
          "NumV",
          "NumW",
          "NumX",
          "NumY",
          "NumZ",
          "DateE",
          "DateF",
          "DateG",
          "DateH",
          "DateI",
          "DateJ",
          "DateK",
          "DateL",
          "DateM",
          "DateN",
          "DateO",
          "DateP",
          "DateQ",
          "DateR",
          "DateS",
          "DateT",
          "DateU",
          "DateV",
          "DateW",
          "DateX",
          "DateY",
          "DateZ",
          "CheckB",
          "CheckC",
          "CheckD",
          "CheckE",
          "CheckF",
          "CheckG",
          "CheckH",
          "CheckI",
          "CheckJ",
          "CheckK",
          "CheckL",
          "CheckM",
          "CheckN",
          "CheckO",
          "CheckP",
          "CheckQ",
          "CheckR",
          "CheckS",
          "CheckT",
          "CheckU",
          "CheckV",
          "CheckW",
          "CheckX",
          "CheckY",
          "CheckZ"
        ],
        "EditorColumnHash": {
          "General": [
            "ResultId",
            "ClassA",
            "DateA",
            "DateB",
            "ClassB",
            "DateC",
            "DateD"
          ]
        },
        "TitleColumns": [
          "ClassA"
        ],
        "LinkColumns": [
          "ClassA",
          "DateA",
          "DateB",
          "ClassB",
          "DateC",
          "DateD",
          "CheckA"
        ],
        "Columns": [
          {
            "ColumnName": "ClassA",
            "LabelText": "キッチンカー名",
            "NoWrap": true
          },
          {
            "ColumnName": "DateA",
            "LabelText": "直近の予約期間(開始日)",
            "NoWrap": true,
            "EditorReadOnly": true
          },
          {
            "ColumnName": "DateB",
            "LabelText": "直近の予約期間(終了日)",
            "EditorReadOnly": true
          },
          {
            "ColumnName": "ClassB",
            "LabelText": "使用先イベント名称",
            "NoWrap": true,
            "Hide": true
          },
          {
            "ColumnName": "DateC",
            "LabelText": "使用不可期間(開始日)",
            "NoWrap": true
          },
          {
            "ColumnName": "DateD",
            "LabelText": "使用不可期間(終了日)"
          },
          {
            "ColumnName": "CheckA",
            "DefaultInput": "false"
          },
          {
            "ColumnName": "ClassC",
            "LabelText": "キッチンカー",
            "ChoicesText": "[[253143]]",
            "Link": true,
            "SearchType": "PartialMatch"
          },
          {
            "ColumnName": "ResultId",
            "LabelText": "キッチンカーId",
            "Hide": true
          }
        ],
        "Links": [
          {
            "ColumnName": "ClassC",
            "SiteId": 253143
          }
        ],
        "Styles": [
          {
            "Title": "css",
            "All": true,
            "Body": "/* ================================\n   モーダル背景\n================================ */\n.sdt-modal-wrap {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.25);\n  z-index: 9999;\n  display: flex;\n  align-items: flex-start;\n  justify-content: center;\n  padding-top: 40px;\n}\n\n/* ================================\n   モーダル本体\n================================ */\n.sdt-modal {\n  position: relative;\n  width: 760px;\n  max-width: calc(100% - 32px);\n  background: #fff;\n  border: 1px solid #e6edf3;\n  border-radius: 10px;\n  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.18);\n  padding: 22px 26px 24px;\n}\n\n/* タイトル */\n.sdt-modal__header {\n  margin-bottom: 14px;\n}\n\n.sdt-modal__title {\n  font-size: 20px;\n  font-weight: 700;\n  color: #2b2f33;\n}\n\n/* 右上の× */\n.sdt-modal__close {\n  position: absolute;\n  top: 14px;\n  right: 14px;\n  width: 36px;\n  height: 36px;\n  border: none;\n  background: transparent;\n  font-size: 28px;\n  line-height: 36px;\n  cursor: pointer;\n  color: #47a9c6; /* 画像の水色寄せ */\n}\n\n.sdt-modal__close:hover {\n  opacity: 0.8;\n}\n\n/* ================================\n   中身（枠）\n================================ */\n.sdt-modal__content {\n  border: 1px solid #e6edf3;\n  border-radius: 8px;\n  padding: 22px;\n  background: #fff;\n}\n\n/* ================================\n   フィールド\n================================ */\n.sdt-field__label {\n  font-size: 14px;\n  font-weight: 600;\n  color: #4b5560;\n  margin-bottom: 10px;\n}\n\n.sdt-field__required {\n  color: #e53935;\n  font-weight: 700;\n  margin-left: 4px;\n}\n\n.sdt-field__input {\n  width: 100%;\n  height: 54px;\n  border: 1px solid #d8e2ea;\n  border-radius: 6px;\n  padding: 0 16px;\n  font-size: 16px;\n  color: #2b2f33;\n  outline: none;\n  background: #fff;\n}\n\n.sdt-field__input:focus {\n  border-color: #7fc6dc;\n  box-shadow: 0 0 0 4px rgba(127, 198, 220, 0.18);\n}\n\n/* ================================\n   ボタン配置\n================================ */\n.sdt-actions {\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 18px;\n}\n\n/* ================================\n   ボタン\n================================ */\n.sdt-btn {\n  height: 44px;\n  min-width: 140px;\n  padding: 0 18px;\n  border-radius: 8px;\n  border: 1px solid transparent;\n  font-size: 15px;\n  font-weight: 700;\n  cursor: pointer;\n}\n\n.sdt-btn--primary {\n  background: #56b6cf; /* 画像の水色寄せ */\n  border-color: #56b6cf;\n  color: #fff;\n}\n\n.sdt-btn--primary:hover {\n  opacity: 0.9;\n}\n",
            "Id": 1
          }
        ],
        "Scripts": [
          {
            "Title": "サイトID",
            "All": true,
            "Body": "date_Site_Id = \"253143\"; //キッチンカー（出力）必要なのは期間のみ\nkitchen_State_Site_Id = \"253125\"; //キッチンカー状況必要なのはキッチンカー名",
            "Id": 7
          },
          {
            "Title": "CDN読み込み",
            "Index": true,
            "Body": "// === JS読み込み（ExcelJSのみ） ===\nconst scripts = [\n  // Excel出力用（ExcelJS）\n  \"https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js\"\n];\n\nfor (const script of scripts) {\n  const elm = document.createElement(\"script\");\n  elm.src = script + \"?p=\" + new Date().getTime();\n  document.head.appendChild(elm);\n}\n",
            "Id": 4
          },
          {
            "Title": "Excelダウンロードボタン",
            "Index": true,
            "Body": "/* ============================================================\n    一覧画面：ボタン追加\n============================================================ */\n(function () {\n    const fnMainCommands = document.getElementById(\"MainCommands\");\n    if (!fnMainCommands) return;\n    if (document.getElementById(\"fn-download-usage-excel\")) return;\n\n    const fnBtn = document.createElement(\"button\");\n    fnBtn.id = \"fn-download-usage-excel\";\n    fnBtn.type = \"button\";\n    fnBtn.className = \"button ui-button ui-corner-all ui-widget applied\";\n    fnBtn.textContent = \"利用状況をExcelでダウンロード\";\n    fnBtn.addEventListener(\"click\", fnOpenModal);\n\n    fnMainCommands.appendChild(fnBtn);\n})();\n\n/* ============================================================\n    モーダルを開く\n============================================================ */\nfunction fnOpenModal() {\n    if (document.getElementById(\"sdt-usage-excel-modal\")) return;\n\n    const fnWrap = document.createElement(\"div\");\n    fnWrap.id = \"sdt-usage-excel-modal\";\n    fnWrap.className = \"sdt-modal-wrap\";\n\n    fnWrap.innerHTML = `\n        <div class=\"sdt-modal\">\n            <button type=\"button\" class=\"sdt-modal__close\" aria-label=\"close\">×</button>\n\n            <div class=\"sdt-modal__header\">\n                <div class=\"sdt-modal__title\">利用状況Excelダウンロード</div>\n            </div>\n\n            <div class=\"sdt-modal__content\">\n                <div class=\"sdt-field\">\n                    <div class=\"sdt-field__label\">\n                        ダウンロード対象の年月 <span class=\"sdt-field__required\">*</span>\n                    </div>\n                    <input id=\"fn-target-month\" class=\"sdt-field__input\" type=\"month\" />\n                </div>\n\n                <div class=\"sdt-actions\">\n                    <button\n                        id=\"fn-modal-download\"\n                        type=\"button\"\n                        class=\"sdt-btn sdt-btn--primary\"\n                    >\n                        ダウンロード\n                    </button>\n                </div>\n            </div>\n        </div>\n    `;\n\n    document.body.appendChild(fnWrap);\n\n    // 初期値：今月\n    const fnNow = new Date();\n    const fnY = fnNow.getFullYear();\n    const fnM = String(fnNow.getMonth() + 1).padStart(2, \"0\");\n    fnWrap.querySelector(\"#fn-target-month\").value = `${fnY}-${fnM}`;\n\n    // ダウンロード\n    fnWrap\n        .querySelector(\"#fn-modal-download\")\n        .addEventListener(\"click\", fnDownloadUsageExcel);\n\n    // ×ボタンで閉じる\n    fnWrap\n        .querySelector(\".sdt-modal__close\")\n        .addEventListener(\"click\", fnCloseModal);\n}\n\n/* ============================================================\n    ダウンロード押下（ここからExcel処理へ）\n============================================================ */\nfunction fnDownloadUsageExcel() {\n    const fnInput = document.getElementById(\"fn-target-month\");\n    const fnYm = fnInput ? String(fnInput.value || \"\") : \"\"; // 例 \"2026-01\"\n\n    if (!fnYm) {\n        alert(\"年月を選択してください\");\n        return;\n    }\n\n    console.log(\"OK\", { fnYm: fnYm });\n\n    // いったん閉じる（好み。閉じないなら消してOK）\n    // fnCloseModal();\n}\n\n/* ============================================================\n    モーダルを閉じる\n============================================================ */\nfunction fnCloseModal() {\n    document.getElementById(\"sdt-usage-excel-modal\")?.remove();\n}\n",
            "Id": 8
          }
        ],
        "HideLink": true,
        "UseSearchFilter": false,
        "NoDisplayIfReadOnly": false
      },
      "Publish": false,
      "DisableCrossSearch": false,
      "Comments": []
    }
  ],
  "Data": [],
  "Permissions": [
    {
      "SiteId": 253125,
      "Permissions": []
    }
  ],
  "PermissionIdList": {
    "DeptIdList": [],
    "GroupIdList": [],
    "UserIdList": []
  }
}