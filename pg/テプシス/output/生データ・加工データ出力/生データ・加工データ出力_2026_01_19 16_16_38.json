{
  "HeaderInfo": {
    "AssemblyVersion": "1.4.1.1",
    "BaseSiteId": 255696,
    "Server": "http://192.168.10.67",
    "CreatorName": "Administrator",
    "PackageTime": "2026-01-19T07:16:38.9237324+00:00",
    "Convertors": [
      {
        "SiteId": 255696,
        "SiteTitle": "生データ・加工データ出力",
        "ReferenceType": "Results",
        "IncludeData": false
      }
    ],
    "IncludeSitePermission": true,
    "IncludeRecordPermission": true,
    "IncludeColumnPermission": true,
    "IncludeNotifications": true,
    "IncludeReminders": true
  },
  "Sites": [
    {
      "TenantId": 1,
      "SiteId": 255696,
      "Title": "生データ・加工データ出力",
      "SiteName": "",
      "SiteGroupName": "",
      "Body": "",
      "GridGuide": "",
      "EditorGuide": "",
      "CalendarGuide": "",
      "CrosstabGuide": "",
      "GanttGuide": "",
      "BurnDownGuide": "",
      "TimeSeriesGuide": "",
      "AnalyGuide": "",
      "KambanGuide": "",
      "ImageLibGuide": "",
      "ReferenceType": "Results",
      "ParentId": 255643,
      "InheritPermission": 255696,
      "SiteSettings": {
        "Version": 1.017,
        "ReferenceType": "Results",
        "Styles": [
          {
            "Title": "【表示制御】生データ・加工データ画面スタイル",
            "Index": true,
            "Body": "@charset \"UTF-8\";\n/* ===================\n    色定義\n==================*/\n/* ===================\n    縦スペース定義\n==================*/\n/* ===================\n    横スペース定義\n==================*/\n/* ===================\n    テキストサイズ定義\n==================*/\n.sdt-processing {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n  background-color: #F2F2F2;\n  z-index: 705;\n}\n.sdt-processing .sdt-processing-wrap {\n  position: relative;\n  display: block;\n  width: 100%;\n  height: 100%;\n  padding: 20px;\n  background-color: #F2F2F2;\n}\n.sdt-processing .sdt-processing-title {\n  margin: 20px 0 0;\n}\n.sdt-processing .sdt-processing-title__text {\n  font-weight: bold;\n  font-size: 1.2em;\n}\n.sdt-processing .sdt-processing-downloadList {\n  display: flex;\n  align-items: center;\n  margin-top: 12px;\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-processing-downloadList {\n    margin-top: 9px;\n  }\n}\n.sdt-processing .sdt-processing-downloadList .sdt-download-name {\n  width: 300px;\n  font-weight: bold;\n  color: #2666E2;\n}\n.sdt-processing .sdt-processing-downloadList .sdt-download-explanation {\n  font-weight: bold;\n}\n.sdt-processing .sdt-modal {\n  position: fixed;\n  inset: 0;\n  display: none; /* 閉じているときは非表示 */\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  /* オーバーレイ */\n  /* ダイアログ本体 */\n  /* ヘッダー */\n}\n.sdt-processing .sdt-modal[data-open=true] {\n  display: flex;\n}\n.sdt-processing .sdt-modal__overlay {\n  position: absolute;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.45);\n  z-index: 10; /* ダイアログより下 */\n  pointer-events: auto; /* overlay 自体はクリックを受ける（背景クリックで閉じる） */\n}\n.sdt-processing .sdt-modal__dialog {\n  position: relative;\n  z-index: 20; /* overlay (10) の上にあるのでボタンが押せる */\n  background: #fff;\n  border-radius: 8px;\n  max-width: 720px;\n  width: 90%;\n  max-height: 85vh;\n  overflow: auto;\n  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);\n  padding: 1rem;\n  transform-origin: center;\n}\n.sdt-processing .sdt-modal__header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.sdt-processing .sdt-modal__close {\n  background: none;\n  border: none;\n  font-size: 1.2rem;\n  cursor: pointer;\n}\n.sdt-processing .sdt-modal__content {\n  margin-top: 0.75rem;\n  line-height: 1.5;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form {\n  display: flex;\n  flex-wrap: wrap;\n  border: solid 1px #3B3B3B;\n  padding-top: 20px;\n  padding-left: 20px;\n  padding-right: 20px;\n  padding-bottom: 20px;\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form {\n    padding-top: 15px;\n  }\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form {\n    padding-left: 15px;\n  }\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form {\n    padding-right: 15px;\n  }\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form {\n    padding-bottom: 15px;\n  }\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form__head {\n  display: inline-flex;\n  width: 100%;\n  margin-bottom: 20px;\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form__head {\n    margin-bottom: 15px;\n  }\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form__body {\n  display: inline-flex;\n  width: 100%;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form__footer {\n  display: inline-flex;\n  justify-content: flex-end;\n  align-items: center;\n  width: 100%;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-form-title {\n  width: 100%;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-form-data {\n  position: relative;\n  display: flex;\n  height: 30px;\n  width: 45%;\n  margin-bottom: 20px;\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form .sdt-form-data {\n    margin-bottom: 15px;\n  }\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-form-data__tilde {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 10%;\n  margin-bottom: 20px;\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form .sdt-form-data__tilde {\n    margin-bottom: 15px;\n  }\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-form-label {\n  position: relative;\n  width: 100%;\n  height: 100%;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input {\n  width: 100%;\n  height: 100%;\n  padding: 0;\n  padding-left: 12px;\n  padding-right: 12px;\n  border-radius: 5px;\n  border: none;\n  box-shadow: 0 0 0 1px #78818F inset;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n  font-size: 16px;\n  background-color: #fff;\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input {\n    padding-left: 9px;\n  }\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input {\n    padding-right: 9px;\n  }\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input::-moz-placeholder {\n  color: #C4C9D0;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input::placeholder {\n  color: #C4C9D0;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input:focus {\n  outline: 0;\n  box-shadow: 0 0 0 2px #2F80ED inset;\n  color: #3B3B3B;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input:disabled {\n  color: #C4C9D0;\n  box-shadow: 0 0 0 2px #C4C9D0 inset;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input:-moz-read-only {\n  border: none;\n  outline: none;\n  box-shadow: none;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input:read-only {\n  border: none;\n  outline: none;\n  box-shadow: none;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-input--error {\n  box-shadow: 0 0 0 1px #E80000 inset;\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 50px;\n  height: 30px;\n  border-radius: 5px;\n  margin-left: 20px;\n  background-color: #2F80ED;\n}\n@media screen and (max-width: 760px) {\n  .sdt-processing .sdt-modal__content .sdt-processing-form .sdt-button {\n    margin-left: 15px;\n  }\n}\n.sdt-processing .sdt-modal__content .sdt-processing-form .sdt-button__text {\n  color: #fff;\n}",
            "Id": 1
          },
          {
            "Title": "【表示制御】プリザンター表示合わせ調整スタイル",
            "Index": true,
            "Body": "\n.ui-widget.ui-widget-content{\n    z-index: 706 !important;\n}",
            "Id": 2
          }
        ],
        "Scripts": [
          {
            "Title": "【設定】CDN読み込み",
            "All": true,
            "Disabled": true,
            "Body": "// === JS読み込み ===\nconst scripts = [\n  // exceljs\n  \"https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js\",\n];\n\n\nfor (const script of scripts) {\n  const elm = document.createElement(\"script\");\n  elm.src = script + \"?p=\" + new Date().getTime();\n  document.head.appendChild(elm);\n}",
            "Id": 4
          },
          {
            "Title": "【表示制御】生データ・加工データ初期表示設定",
            "Index": true,
            "Body": "(function ($) {\n  'use strict';\n\n  /************************************************************************\n   * 画面読み込み時に一度だけ実行するレイアウト処理\n   *\n   * 目的：\n   *  - ヘッダー（#Header）の高さを取得して、その高さ分だけ\n   *    #sdt-processing の top をずらします（重なり防止）。\n   *  - さらに #sdt-processing の高さを CSS の calc() を使って\n   *    calc(100% - {headerHeight}px) に設定します。これにより、\n   *    ビューポート全体の高さからヘッダー分を差し引いた高さにできます。\n   *\n   * 注意：\n   *  - この処理は「読み込み時に一度だけ実行」されます。画面サイズ変更で追従\n   *    させたい場合は下の「リサイズ追従（任意）」のコメントを参考に有効化してください。\n   *  - #sdt-processing に top を効かせるには、その要素に適切な position（relative/absolute/fixed/sticky）\n   *    が CSS で設定されている必要があります。もし反映されない場合は CSS 側を確認してください。\n   ************************************************************************/\n\n  /**\n   * getHeaderHeight\n   * - #Header 要素の「見た目の高さ」および .both.cf 要素の高さをピクセル単位で合算し、\n   *   さらに 10px を加えた合計を返します。\n   * - 見た目の高さとは、実際に画面に描画された高さ（border・padding を含むサイズ）です。\n   * - 要素が見つからなければ 0 を返します（呼び出し側で扱いやすくするため）。\n   *\n   * 基本の考え方（初心者向け）：\n   *  - jQuery の .height() は「コンテンツ高さ」を返しますが、\n   *    getBoundingClientRect().height は表示上の高さ（細かい描画情報）を返すので、\n   *    見た目を合わせたい時はこちらを使うことが多いです。\n   *\n   * @returns {number} headerHeightPx - 整数ピクセル（例: 64）\n   */\n  function getHeaderHeight() {\n    // jQuery で要素を取得\n    var $header = $('#Header');\n\n    // 要素が無ければ 0 を返す（安全なフォールバック）\n    var headerHeight = 0;\n    if ($header.length !== 0) {\n      // ネイティブ DOM の getBoundingClientRect() で「見た目の高さ」を取得\n      var rect = $header[0].getBoundingClientRect();\n      // 小数点が乗ることがあるため四捨五入して整数にする（CSS に入れやすくするため）\n      headerHeight = Math.round(rect.height || 0);\n      if (headerHeight < 0) {\n        headerHeight = 0;\n      }\n    }\n\n    // .both.cf 要素の高さを取得（最初に見つかった要素を対象）\n    var bothHeight = 0;\n    var $both = $('.both.cf');\n    if ($both.length !== 0) {\n      try {\n        var bothRect = $both[0].getBoundingClientRect();\n        bothHeight = Math.round(bothRect.height || 0);\n        if (bothHeight < 0) {\n          bothHeight = 0;\n        }\n      } catch (e) {\n        // 何らかの理由で取得できなかった場合は 0 とする（安全対策）\n        bothHeight = 0;\n        window.force && console.error('.both.cf height read error', e);\n      }\n    }\n\n    // 合計に 10px を上乗せする\n    var total = headerHeight + bothHeight + 10;\n\n    // 最終的に不正値にならないようにガードして返す\n    return (total > 0) ? total : 0;\n  }\n\n  /**\n   * buildCalcHeightCss\n   * - ヘッダーのピクセル値を受け取り、CSS の calc() 文字列を返します。\n   * - 例: px=50 -> \"calc(100% - 50px)\"\n   *\n   * @param {number} px - ヘッダー高さ（ピクセル）\n   * @returns {string} CSS の値（例: \"calc(100% - 50px)\"）\n   */\n  function buildCalcHeightCss(px) {\n    // 安全のため数値に変換してから文字列を生成\n    var n = (typeof px === 'number' && !isNaN(px)) ? px : 0;\n    return 'calc(100% - ' + String(n) + 'px)';\n  }\n\n  /**\n   * applyUpcomingEventsLayout\n   * - 実際に DOM に対して style を当てる関数（書き込みのみ）\n   * - headerHeightPx が数値で与えられたら top と height を設定します。\n   * - 要素が無ければ何もしません（無害で安全）。\n   *\n   * @param {number} headerHeightPx - ヘッダーの高さ（ピクセル）\n   */\n  function applyUpcomingEventsLayout(headerHeightPx) {\n    // 対象要素を取得\n    var $target = $('#fn-processing');\n\n    // 要素が無ければ早期リターン（処理を止めない）\n    if ($target.length === 0) {\n      return;\n    }\n\n    // top をピクセルで設定（例: \"64px\"）\n    $target.css('top', String(headerHeightPx) + 'px');\n\n    // height を calc(100% - {headerHeight}px) に設定\n    $target.css('height', buildCalcHeightCss(headerHeightPx));\n  }\n\n  /**\n   * initUpcomingEventsLayout\n   * - 画面読み込み時に呼ばれるオーケストレーション関数\n   * - 役割: ヘッダー高さを取得して、対象要素にレイアウトを適用する（1回だけ）\n   */\n  function initUpcomingEventsLayout() {\n    // ヘッダーの高さを取得（例: 64）\n    var headerH = getHeaderHeight();\n\n    // 取得した高さを使って対象要素にスタイルを適用\n    applyUpcomingEventsLayout(headerH);\n  }\n\n  // DOMContentLoaded のタイミングで一度だけ実行する\n  document.addEventListener('DOMContentLoaded', function () {\n    try {\n      initUpcomingEventsLayout();\n    } catch (e) {\n      // エラーが出たときは開発用に console に出す（運用では消してもよい）\n      // window.force を true にすると詳細ログが出ます（デバッグ用）\n      window.force && console.error('initUpcomingEventsLayout error', e);\n    }\n  });\n\n  /* --------------------------------------------------------------------\n   * リサイズ時に高さを再計算して追従させたい場合（任意）\n   *\n   * - 画面サイズが変わるとヘッダーの高さが変化する UI がある場合は、\n   *   下のコードを有効化してください。\n   * - 最小限の実装を心がけるためデフォルトでは無効にしています。\n   *\n   * // window.addEventListener('resize', function () {\n   * //   try {\n   * //     initUpcomingEventsLayout();\n   * //   } catch (e) {\n   * //     window.force && console.error('resize initUpcomingEventsLayout error', e);\n   * //   }\n   * // });\n   * ------------------------------------------------------------------ */\n\n  /* --------------------------------------------------------------------\n   * 補足（初心者向け Q&A）\n   *\n   * Q: なぜ top を設定するだけで表示がずれるの？\n   * A: top は要素が position: absolute/fixed/sticky/relative の時に意味を持ちます。\n   *    もし #sdt-processing に position が無い（static）場合、top は効きません。\n   *    その場合は CSS に position: relative; などを設定してください。\n   *\n   * Q: calc(100% - 50px) は何を意味するの？\n   * A: 親要素の高さやビューポート高さを基準に 100% から 50px を引いた高さを意味します。\n   *    ここでは「画面全体の高さ - ヘッダーの高さ」を意図しています。\n   *\n   * Q: この処理を手動で再実行する方法は？\n   * A: このファイルは外部公開しない方針なので直接呼べる関数は置いていません。\n   *    もし手動で呼びたい場合は initUpcomingEventsLayout を global に公開してください。\n   * ------------------------------------------------------------------ */\n\n})(jQuery);\n",
            "Id": 1
          },
          {
            "Title": "【表示制御】モーダル処理",
            "Index": true,
            "Body": "  (function($) {\n    'use strict';\n\n    /**\n     * ModalManager\n     * 単一ファイル内に収めたオーケストレーション実装。\n     * - fn- 接頭辞のセレクタのみ参照\n     * - 開閉・フォーカス管理・キーハンドリングを統括\n     */\n    const ModalManager = (function() {\n      // ---- セレクタ定義（fn- プレフィックスのみを使う） ----\n      const SELECTORS = {\n        trigger: '.fn-open-modal',       // data-target を持つ要素（クリックで起動）\n        modal: '.fn-modal',              // モーダルルート（data-modal 属性を読む）\n        overlay: '.fn-modal-overlay',    // オーバーレイ（背景クリックで閉じる）\n        closeBtn: '.fn-modal-close',      // 閉じるボタン\n        startDate: '.fn-modal-start-date', // 開始日\n        finishDate: '.fn-modal-finish-date' // 終了日\n      };\n\n      // フォーカス可能要素のセレクタ（フォーカストラップで利用）\n      const FOCUSABLES = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, [tabindex]:not([tabindex=\"-1\"])';\n\n      // 内部状態\n      let $activeModal = null; // 現在開いているモーダルの jQuery オブジェクト\n      let lastFocused = null;  // 開く前にフォーカスしていた要素（復帰に使う）\n\n      // ----------------- ヘルパー関数 -----------------\n\n      /**\n       * findModalById\n       * data-modal の値から該当モーダルを返す（無ければ空の jQuery）\n       */\n      function findModalById(id) {\n        if (!id) return $();\n        return $(`${SELECTORS.modal}[data-modal=\"${id}\"]`);\n      }\n\n      /**\n       * setModalOpenState\n       * data-open 属性と aria-hidden を切り替える（スタイルは sdt- に任せる）\n       */\n      function setModalOpenState($modal, isOpen) {\n        if (!$modal || !$modal.length) return;\n        $modal.attr('data-open', isOpen ? 'true' : 'false');\n        $modal.attr('aria-hidden', isOpen ? 'false' : 'true');\n      }\n\n      /**\n       * getFocusableElements\n       * モーダル内の表示されているフォーカス可能要素を返す\n       */\n      function getFocusableElements($modal) {\n        return $modal.find(FOCUSABLES).filter(':visible');\n      }\n\n      /**\n       * formatDateLocal\n       * Date → yyyy-mm-dd（ローカル時間）\n       */\n      function formatDateLocal(date) {\n        const y = date.getFullYear();\n        const m = String(date.getMonth() + 1).padStart(2, '0');\n        const d = String(date.getDate()).padStart(2, '0');\n        return `${y}-${m}-${d}`;\n      }\n\n      // ----------------- キーハンドリング -----------------\n\n      /**\n       * handleKeydown\n       * - ESC で閉じる\n       * - TAB でフォーカストラップを実現\n       */\n      function handleKeydown(e) {\n        if (!$activeModal) return;\n\n        // ESC（閉じる）\n        if (e.key === 'Escape' || e.keyCode === 27) {\n          e.preventDefault();\n          closeActiveModal();\n          return;\n        }\n\n        // TAB（フォーカストラップ）\n        if (e.key === 'Tab' || e.keyCode === 9) {\n          const $focusables = getFocusableElements($activeModal);\n          if (!$focusables.length) {\n            e.preventDefault();\n            return;\n          }\n\n          const first = $focusables.first()[0];\n          const last = $focusables.last()[0];\n\n          if (e.shiftKey) {\n            // Shift + Tab\n            if (document.activeElement === first) {\n              e.preventDefault();\n              last.focus();\n            }\n          } else {\n            // Tab\n            if (document.activeElement === last) {\n              e.preventDefault();\n              first.focus();\n            }\n          }\n        }\n      }\n\n\n      // ----------------- 年月入力初期値 -----------------\n\n      /**\n       * setInitialDateValues\n       * 開始日：当月初日\n       * 終了日：翌月初日\n       */\n      function setInitialDateValues($modal) {\n        const today = new Date();\n\n        // 当月の初日\n        const startDate = new Date(today.getFullYear(), today.getMonth(), 1);\n        console.log(startDate);\n\n        // 翌月の初日\n        const finishDate = new Date(today.getFullYear(), today.getMonth() + 1, 1);\n        console.log(finishDate);\n\n        $modal.find(SELECTORS.startDate).val(formatDateLocal(startDate));\n        $modal.find(SELECTORS.finishDate).val(formatDateLocal(finishDate));\n      }\n\n      // ----------------- 開閉ロジック -----------------\n\n      /**\n       * openModalById\n       * 指定された id のモーダルを開く（data-modal と一致）\n       * @param {String} id - data-modal の値\n       * @param {jQuery|Element} $trigger - 開いたトリガー要素（フォーカス復帰用）\n       */\n      function openModalById(id, $trigger) {\n        const $modal = findModalById(id);\n        if (!$modal.length) return;\n\n        // 現在アクティブなモーダルを上書き（シンプル実装では同時オープンは非対応）\n        $activeModal = $modal;\n        lastFocused = ($trigger && $trigger.length) ? $trigger : $(document.activeElement);\n\n        // 状態を開くにセット\n        setModalOpenState($modal, true);\n\n        // 年月入力の初期値をセット\n        setInitialDateValues($modal);\n\n        // フォーカス移動：モーダル内の最初のフォーカス可能要素へ\n        const $focusables = getFocusableElements($modal);\n        if ($focusables.length) {\n          $focusables.first().focus();\n        } else {\n          // フォーカス可能要素がなければモーダルルートに tabindex を付与してフォーカス\n          $modal.attr('tabindex', '-1').focus();\n        }\n\n        // ドキュメントにキーイベントを登録（Esc / Tab）\n        $(document).on('keydown.fnModal', handleKeydown);\n      }\n\n      /**\n       * closeActiveModal\n       * 現在開いているモーダルを閉じる（フォーカス復帰・イベント解除）\n       */\n      function closeActiveModal() {\n        if (!$activeModal || !$activeModal.length) return;\n\n        // 閉じる状態に切り替え\n        setModalOpenState($activeModal, false);\n\n        // フォーカスを元の要素に戻す（安全に）\n        try {\n          if (lastFocused && $(lastFocused).length) {\n            $(lastFocused).focus();\n          } else {\n            document.body.focus();\n          }\n        } catch (err) {\n          // フォーカス復帰で例外が出ても無視\n        }\n\n        // イベント解除と状態クリア\n        $(document).off('keydown.fnModal');\n        $activeModal = null;\n        lastFocused = null;\n      }\n\n      // ----------------- イベントバインド（デリゲート） -----------------\n\n      /**\n       * bindGlobalEvents\n       * - すべてのクリック監視をここで行う（動的に追加された要素にも対応）\n       */\n      function bindGlobalEvents() {\n        // トリガークリック（data-target を読み、対応する data-modal を open）\n        $(document).on('click.fnModal', SELECTORS.trigger, function(e) {\n          e.preventDefault();\n          const targetId = $(this).attr('data-target');\n          if (!targetId) return;\n          openModalById(targetId, $(this));\n        });\n\n        // overlay クリックで閉じる\n        $(document).on('click.fnModal', SELECTORS.overlay, function(e) {\n          // overlay 自体がクリックされたら閉じる（dialog 内のクリックは対象外）\n          closeActiveModal();\n        });\n\n        // 閉じるボタン\n        $(document).on('click.fnModal', SELECTORS.closeBtn, function(e) {\n          e.preventDefault();\n          closeActiveModal();\n        });\n\n        // ルートモーダルの余地クリック（ダイアログ外クリック）で閉じる\n        $(document).on('click.fnModal', SELECTORS.modal, function(e) {\n          const $root = $(this);\n          const $dialog = $root.find('.sdt-modal__dialog').first();\n          // クリック対象がダイアログの外側（＝背景領域）なら閉じる\n          if ($dialog.length && !$dialog[0].contains(e.target)) {\n            closeActiveModal();\n          }\n        });\n      }\n\n      // ----------------- 公開 API -----------------\n      function init() {\n        bindGlobalEvents();\n      }\n\n      return {\n        init: init,\n        open: openModalById,   // テスト用に外部から開ける（必要なければ使わない）\n        close: closeActiveModal\n      };\n    })();\n\n    // DOM Ready で初期化\n    $(function() {\n      ModalManager.init();\n      // （オプション）開発中はここで自動的に開いて動作確認もできます:\n      // ModalManager.open('modal-A');\n    });\n  })(jQuery);",
            "Id": 2
          },
          {
            "Title": "【表示制御】ボタンクリックイベント",
            "Index": true,
            "Disabled": true,
            "Body": "// ----------------- dummy Json Object -----------------\nconst dummyJsonFromSql = [\n  { \"名前\": \"山田太郎\", \"年齢\": 28, \"部署\": \"営業部\" },\n  { \"名前\": \"鈴木花子\", \"年齢\": 34, \"部署\": \"企画部\" },\n  { \"名前\": \"佐藤次郎\", \"年齢\": 45, \"部署\": \"開発部\" }\n];\n\n\n// ----------------- メイン処理 -----------------\n// モーダル内：バリデーションあり\n$(document).on('click', '.fn-sdt-modal-export', function (e) {\n  formValidate.call(this, e);\n});\n\n\n// 直接エクスポート：バリデーションなし\n$(document).on('click', '.fn-export', async function (e) {\n  e.preventDefault();\n  const button = this;\n  const buttonId = this.id; // htmlのbuttonのid\n\n  const sqlFileName = exportWithoutParameter[buttonId]\n\n  if (!sqlFileName) {\n    alert(\"対応するSQLが定義されていません\");\n    return;\n  }\n\n  alert('Excelファイルを出力します');\n\n  const extendSqlResult = await getExtendSqlWithoutParameter(sqlFileName);\n  if(!extendSqlResult) return;\n\n  exportExcel(extendSqlResult, button);\n});\n\n\n// ----------------- ヘルパー関数 -----------------\n/**\n * getExportTitle\n * - Excelファイル名に使うタイトルを取得\n * - モーダル経由 / 直接エクスポート 両対応\n *\n * @param {HTMLElement} button\n * @returns {string}\n */\nfunction getExportTitle(button) {\n  // ① モーダル内の「出力」ボタンか？\n  const modal = button.closest('.fn-modal');\n\n  if (modal) {\n    const modalId = modal.dataset.modal;\n    if (!modalId) return '';\n\n    const openModalButton = document.querySelector(\n      `.fn-open-modal[data-target=\"${modalId}\"]`\n    );\n\n    return openModalButton\n      ? openModalButton.innerText.trim()\n      : '';\n  }\n\n  // ② 直接エクスポート（fn-export）\n  return button.innerText.trim();\n}\n\n\n/**\n * createExcelFileName\n * - クリックされたボタンのテキストを元にExcelファイル名を生成\n * - 日付inputがない場合は本日の日付を使用\n *\n * @param {HTMLElement} button クリックされたボタン要素\n * @returns {string}\n */\nfunction createExcelFileName(exportButton) {\n  let year;\n  let month;\n\n  const dateInput = exportButton\n    .closest('form')\n    ?.querySelector('.fn-modal-start-date');\n\n  if (dateInput && dateInput.value) {\n    const [y, m] = dateInput.value.split('-');\n    year = y;\n    month = m;\n  } else {\n    const today = new Date();\n    year = today.getFullYear();\n    month = String(today.getMonth() + 1).padStart(2, '0');\n  }\n\n  const yearMonth = `${year}年${month}月`;\n\n  const title = getExportTitle(exportButton);\n  const safeTitle = title.replace(/[\\\\/:*?\"<>|]/g, '');\n\n  return `${yearMonth}_${safeTitle}.xlsx`;\n}\n\n\n/**\n * getExtendSqlWithoutParameter\n * - 拡張sqlを実行しjson生データを取得するする関数\n * - 引数: jsonFromSql - 拡張sqlで取得したjson配列\n * - 動作: 引数で渡されたjson配列をExcelファイルに変換してダウンロードさせる\n */\nasync function getExtendSqlWithoutParameter(sqlFileName) {\n  if (!sqlFileName) {\n    throw new Error('sqlFileNameが指定されていません');\n  }\n\n  //パラメーターあり\n  const getEvents = sql(sqlFileName, { DateFrom: null, DateTo: null });\n\n  // 12/1〜12/31で絞り込み\n  const rows = await getEvents();\n\n  // console.log(rows.length);\n  // console.table(`拡張SQL(${sqlFileName})取得結果：`, rows);\n\n  let obj = JSON.parse(rows);\n  try {\n    obj = JSON.parse(rows);\n  } catch (e) {\n    console.log(\"拡張sqlのjsonパースに失敗しました。\");\n    console.log(rows);\n    return;\n  };\n\n  const resultSql = obj?.Response?.Data?.Table;  // JSON生データ\n\n  if (!resultSql) {\n    console.log(\"拡張sqlで取得されたjsonがありません\");\n    return resultSql;\n  }\n}\n\n\n/**\n * getExtendSqlWithParameter\n * - 拡張sqlを実行しjson生データを取得するする関数\n * - 引数: sqlFileName - 拡張sqlファイル名\n * - 引数：dateRange - パラメーターとして渡す期間\n * - 動作: 引数で渡されたsqlを実行し、取得したjson生データをjsonパースして返す(resultSql)\n */\nasync function getExtendSqlWithParameter(sqlFileName, dateRange) {\n  if (!sqlFileName) {\n    throw new Error('sqlFileNameが指定されていません');\n  }\n\n  const getEvents = sql(sqlFileName, dateRange);\n\n  const rows = await getEvents();\n\n  if (!rows) {\n    console.log(\"拡張sqlで取得されたjsonがありません\");\n    return;\n  }\n\n  let obj;\n  try {\n    obj = JSON.parse(rows);\n  } catch (e) {\n    console.log(\"拡張sqlのjsonパースに失敗しました。\");\n    console.log(rows);\n    return;\n  }\n\n  const resultSql = obj?.Response?.Data?.Table;\n\n  if (!resultSql) {\n    console.log(\"拡張sqlで取得されたjsonがありません\");\n    return;\n  }\n\n  return resultSql;\n}\n\n\n\n/**\n * exportExcel\n * - 拡張sqlで取得したjson配列をExcelファイルとして出力する関数\n * - 引数: jsonFromSql - 拡張sqlで取得したjson配列\n * - 動作: 引数で渡されたjson配列をExcelファイルに変換してダウンロードさせる\n */\nfunction exportExcel(jsonFromSql, button) {\n  const workbook = new ExcelJS.Workbook();\n  const worksheet = workbook.addWorksheet('Sheet1');\n\n  const header = Object.keys(jsonFromSql[0]);\n  worksheet.addRow(header);\n\n  jsonFromSql.forEach(row => {\n    worksheet.addRow(Object.values(row));\n  });\n\n  const fileName = createExcelFileName(button);\n\n  workbook.xlsx.writeBuffer().then(buffer => {\n    const blob = new Blob(\n      [buffer],\n      { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' }\n    );\n\n    const url = URL.createObjectURL(blob);\n\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = fileName;\n    document.body.appendChild(a);\n    a.click();\n\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  });\n}\n\n\n/**\n * formValidate\n * - フォームのバリデーションを行う関数\n * - 引数: form - バリデーションを行うフォーム要素\n * - 動作: フォームの有効性をチェックし、無効な場合は処理を中断する。有効な場合はExcel出力を行う。\n */\nasync function formValidate(e) {\n  e.preventDefault();\n\n  const button = this;\n  const form = this.closest('form');\n  if (!form) return;\n\n  if (!form.reportValidity()) return;\n\n  const buttonId = button.id;\n  const sqlFileName = exportWithParameter[buttonId];\n\n  if(!sqlFileName){\n    alert(\"対応するSQLが定義されていません\");\n    return;\n  }\n\n  let dateRange;\n  try{\n    dateRange = getDateRangeFromModal(button);\n  } catch (err) {\n    alert(err.message);\n    return;\n  }  \n\n  alert('Excelファイルを出力します');\n\n  const extendSqlResult = await getExtendSqlWithParameter(sqlFileName, dateRange);\n  // this = クリックされた .fn-sdt-modal-export ボタン\n  exportExcel(extendSqlResult, button);\n}\n\n/**\n * getDateRangeFromModal\n * - モーダル内の入力値から DateFrom / DateTo を生成\n *\n * @param {HTMLElement} button クリックされたボタン\n * @returns {{ DateFrom: string, DateTo: string }}\n */\nfunction getDateRangeFromModal(button) {\n  const modal = button.closest('.fn-modal');\n  if (!modal) {\n    throw new Error('モーダルが見つかりません');\n  }\n\n  const startInput = modal.querySelector('.fn-modal-start-date');\n  const finishInput = modal.querySelector('.fn-modal-finish-date');\n\n  if (!startInput || !startInput.value) {\n    throw new Error('開始日が入力されていません');\n  }\n\n  const buttonId = button.id;\n\n  // ===== 加工データ（月指定） =====\n  if (buttonId === 'fn-processed-data-export') {\n    // YYYY-MM\n    const [year, month] = startInput.value.split('-').map(Number);\n\n    const firstDay = `${year}-${String(month).padStart(2, '0')}-01`;\n\n    // 月末日を取得\n    const lastDate = new Date(year, month, 0); // 次月0日 = 月末\n    const lastDay = `${year}-${String(month).padStart(2, '0')}-${String(lastDate.getDate()).padStart(2, '0')}`;\n\n    return {\n      DateFrom: firstDay,\n      DateTo: lastDay\n    };\n  }\n\n  // ===== 通常（開始日〜終了日） =====\n  if (!finishInput || !finishInput.value) {\n    throw new Error('終了日が入力されていません');\n  }\n\n  return {\n    DateFrom: startInput.value,\n    DateTo: finishInput.value\n  };\n}\n\n\n// パラメーター無しのエクスポート\nconst exportWithoutParameter =\n{\n  \"fn-product-achivement-export\": \"getStorePerformance\",        // 品目実績\n  \"fn-kitchencar-export\": \"getKitchenCar\",                      // キッチンカー\n  \"fn-kitchencar-use-export\": \"getUseOfFoodTrucks\",             // キッチンカー利用\n  \"fn-employee-export\": \"DispatchStatus\",                       // 派遣者\n  \"fn-employee-use-export\": \"getForDispatchedWorkers\",          // 派遣者利用\n  \"fn-client-export\": \"getImportantPerson\",                     // 先方（要人）\n  \"fn-menu-export\": \"getMenuNumberOfSeparateMeals\",             // メニュー別食数\n  \"fn-media-export\": \"getTheEconomicValueOfMediaExposure\",      // メディア露出の経済価値\n  \"fn-eventphoto-export\": \"getStorePerformanceDetails\",         // イベント写真（写真名のみ）\n  \"fn-center-export\": \"getRoomCenter\",                          // 室・センター\n  \"fn-group-export\": \"getGroup\",                                // グループ\n  \"fn-member-export\": \"getMemberVerificationRequired\",          // メンバー\n  \"fn-store-export\": \"getShop\",                                 // 店舗\n  \"fn-contractor-export\": \"\",                                   // 委託先情報(社名)\n  \"fn-tv-radio-export\": \"getEconomicValueTelevisionAndRadio\",   // メディア露出の経済価値（テレビ・ラジオ）\n  \"fn-newspaper-export\": \"getEconomicValueNewspaper\",           // メディア露出の経済価値（新聞）\n  \"fn-brand-export\": \"getVarietyBrand\",                         // 品種（ブランド）\n  \"fn-supplier-export\": \"getSupplier\",                          // 仕入先\n  \"fn-rank-export\": \"getRankAndGrade\",                          // ランク\n  \"fn-peach-packaging-export\": \"getPackaging\",                  // 包装\n  \"fn-beef-part-export\": \"getPart\",                             // 部位\n  \"fn-scallops-type-export\": \"getKindsScallops\"                 // 種類（ホタテ）\n}                \n\n// パラメーター有りのエクスポート\nconst exportWithParameter =\n{\n  \"fn-event-export\": \"getEvent\",            // イベント\n  \"fn-event-store-export\": \"\",              // イベント店舗\n  \"fn-event-work-export\": \"getEventWork\",   // イベント勤務\n  \"fn-event-weather-export\": \"\",            // イベント天気\n  \"fn-processed-data-export\": \"\"           // 加工データ\n}          \n",
            "Id": 3
          },
          {
            "Title": "【設定】拡張SQL設定 ",
            "All": true,
            "Body": "// =====================\n// 共通設定\n// =====================\n// const ENDPOINT = \"http://localhost/api/extended/sql\";         // ローカル環境\nconst ENDPOINT = \"http://192.168.10.67/api/extended/sql\";    // 67環境\nconst API_VERSION = 1.1;\n\nconst API_KEY = \"\";\n",
            "Id": 7
          },
          {
            "Title": "【設定】出力ボタンと拡張SQLファイルのマッピング",
            "All": true,
            "Body": "// パラメーター無しのエクスポート\nconst exportWithoutParameter =\n{\n  \"fn-product-achivement-export\": \"getStorePerformance\",        // 品目実績\n  \"fn-kitchencar-export\": \"getKitchenCar\",                      // キッチンカー\n  \"fn-kitchencar-use-export\": \"getUseOfFoodTrucks\",             // キッチンカー利用\n  \"fn-employee-export\": \"DispatchStatus\",                       // 派遣者\n  \"fn-employee-use-export\": \"getForDispatchedWorkers\",          // 派遣者利用\n  \"fn-client-export\": \"getImportantPerson\",                     // 先方（要人）\n  \"fn-menu-export\": \"getMenuNumberOfSeparateMeals\",             // メニュー別食数\n  \"fn-media-export\": \"getTheEconomicValueOfMediaExposure\",      // メディア露出の経済価値\n  \"fn-eventphoto-export\": \"getStorePerformanceDetails\",         // イベント写真（写真名のみ）\n  \"fn-center-export\": \"getRoomCenter\",                          // 室・センター\n  \"fn-group-export\": \"getGroup\",                                // グループ\n  \"fn-member-export\": \"getMemberVerificationRequired\",          // メンバー\n  \"fn-store-export\": \"getShop\",                                 // 店舗\n  \"fn-contractor-export\": \"getContractorInformation\",           // 委託先情報(社名)\n  \"fn-tv-radio-export\": \"getEconomicValueTelevisionAndRadio\",   // メディア露出の経済価値（テレビ・ラジオ）\n  \"fn-newspaper-export\": \"getEconomicValueNewspaper\",           // メディア露出の経済価値（新聞）\n  \"fn-brand-export\": \"getVarietyBrand\",                         // 品種（ブランド）\n  \"fn-supplier-export\": \"getSupplier\",                          // 仕入先\n  \"fn-rank-export\": \"getRankAndGrade\",                          // ランク\n  \"fn-peach-packaging-export\": \"getPackaging\",                  // 包装\n  \"fn-beef-part-export\": \"getPart\",                             // 部位\n  \"fn-scallops-type-export\": \"getKindsScallops\"                 // 種類（ホタテ）\n}                \n\n// パラメーター有りのエクスポート\nconst exportWithParameter =\n{\n  \"fn-event-export\": \"getEvent\",                    // イベント\n  \"fn-event-store-export\": \"getEventShop\",        // イベント店舗\n  \"fn-event-work-export\": \"getEventWork\",          // イベント勤務\n  \"fn-event-weather-export\": \"getEventWeather\",    // イベント天気\n  \"fn-processed-data-export\": \"getProcessingData\"  // 加工データ\n}          \n",
            "Id": 8
          },
          {
            "Title": "【共通処理】拡張SQL呼び出し共通関数",
            "All": true,
            "Body": "function undefinedToNull(obj = {}) {\n    return Object.fromEntries(\n        Object.entries(obj).map(([k, v]) => [k, v === undefined ? null : v])\n    );\n}\n\n/**\n * 拡張SQLを実行して返す共通関数\n * - 返り値は「オブジェクト配列」か「生JSON文字列」かをコメントアウトで切替\n */\nasync function sqlTable(name, params = {}) {\n    const cleanParams = undefinedToNull(params);\n\n    const body = {\n        ApiVersion: API_VERSION,\n        Name: name,\n        ...(API_KEY ? { ApiKey: API_KEY } : {}),\n        ...(Object.keys(cleanParams).length ? { Params: cleanParams } : {}),\n    };\n\n    console.log(\"request body:\", body);\n\n    const res = await fetch(ENDPOINT, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        credentials: \"include\",\n        body: JSON.stringify(body),\n    });\n\n    if (!res.ok) {\n        const text = await res.text().catch(() => \"\");\n        throw new Error(`HTTP ${res.status} ${res.statusText}\\n${text}`);\n    }\n\n    // =============================\n    // 返り値の形式\n    // =============================\n\n    // // ---- A) オブジェクト配列で返す（Response.Data.Table）----\n    // const json = await res.json();\n    // return json?.Response?.Data?.Table ?? [];\n\n    // ---- B) 生のJSON文字列で返す（そのままテキスト）----\n    const text = await res.text();\n    return text;\n}\n\n\nfunction sql(name, baseParams = {}) {\n    return async (params = {}) => {\n        // baseParams（既定） + params（上書き）を合体して送る\n        const merged = { ...baseParams, ...params };\n        return sqlTable(name, merged);\n    };\n}",
            "Id": 5
          },
          {
            "Title": "【表示制御】出力ボタンクリックイベント",
            "Index": true,
            "Body": "// ----------------- メイン処理 -----------------\n// モーダル内：バリデーションあり\n$(document).on('click', '.fn-sdt-modal-export', function (e) {\n  formValidate.call(this, e);\n});\n\n\n// 直接エクスポート：バリデーションなし\n$(document).on('click', '.fn-export', async function (e) {\n  e.preventDefault();\n  const button = this;\n  const buttonId = this.id; // htmlのbuttonのid\n\n  const sqlFileName = exportWithoutParameter[buttonId]\n\n  if (!sqlFileName) {\n    alert(\"対応するSQLが定義されていません\");\n    return;\n  }\n\n  alert('Excelファイルを出力します');\n\n  const extendSqlResult = await getExtendSqlWithoutParameter(sqlFileName);\n  if(!extendSqlResult) return;\n\n  exportExcel(extendSqlResult, button);\n});\n\n\n// ----------------- ヘルパー関数 -----------------\n/**\n * getExportTitle\n * - Excelファイル名に使うタイトルを取得\n * - モーダル経由 / 直接エクスポート 両対応\n *\n * @param {HTMLElement} button\n * @returns {string}\n */\nfunction getExportTitle(button) {\n  // ① モーダル内の「出力」ボタンか？\n  const modal = button.closest('.fn-modal');\n\n  if (modal) {\n    const modalId = modal.dataset.modal;\n    if (!modalId) return '';\n\n    const openModalButton = document.querySelector(\n      `.fn-open-modal[data-target=\"${modalId}\"]`\n    );\n\n    return openModalButton\n      ? openModalButton.innerText.trim()\n      : '';\n  }\n\n  // ② 直接エクスポート（fn-export）\n  return button.innerText.trim();\n}\n\n\n/**\n * createExcelFileName\n * - クリックされたボタンのテキストを元にExcelファイル名を生成\n * - 日付inputがない場合は本日の日付を使用\n *\n * @param {HTMLElement} button クリックされたボタン要素\n * @returns {string}\n */\nfunction createExcelFileName(exportButton) {\n  let year;\n  let month;\n\n  const dateInput = exportButton\n    .closest('form')\n    ?.querySelector('.fn-modal-start-date');\n\n  if (dateInput && dateInput.value) {\n    const [y, m] = dateInput.value.split('-');\n    year = y;\n    month = m;\n  } else {\n    const today = new Date();\n    year = today.getFullYear();\n    month = String(today.getMonth() + 1).padStart(2, '0');\n  }\n\n  const yearMonth = `${year}年${month}月`;\n\n  const title = getExportTitle(exportButton);\n  const safeTitle = title.replace(/[\\\\/:*?\"<>|]/g, '');\n\n  return `${yearMonth}_${safeTitle}.xlsx`;\n}\n\n\n/**\n * getExtendSqlWithoutParameter\n * - 拡張sqlを実行しjson生データを取得するする関数\n * - 引数: jsonFromSql - 拡張sqlで取得したjson配列\n * - 動作: 引数で渡されたjson配列をExcelファイルに変換してダウンロードさせる\n */\nasync function getExtendSqlWithoutParameter(sqlFileName) {\n  if (!sqlFileName) {\n    throw new Error('sqlFileNameが指定されていません');\n  }\n\n  //パラメーターあり\n  const getEvents = sql(sqlFileName, { DateFrom: null, DateTo: null });\n\n  // 12/1〜12/31で絞り込み\n  const rows = await getEvents();\n\n  // console.log(rows.length);\n  // console.table(`拡張SQL(${sqlFileName})取得結果：`, rows);\n\n  let obj = JSON.parse(rows);\n  try {\n    obj = JSON.parse(rows);\n  } catch (e) {\n    console.log(\"拡張sqlのjsonパースに失敗しました。\");\n    console.log(rows);\n    return;\n  };\n\n  const resultSql = obj?.Response?.Data?.Table;  // JSON生データ\n\n  if (!resultSql) {\n    console.log(\"拡張sqlで取得されたjsonがありません\");\n    return;\n  }\n  return resultSql;\n}\n\n\n/**\n * getExtendSqlWithParameter\n * - 拡張sqlを実行しjson生データを取得するする関数\n * - 引数: sqlFileName - 拡張sqlファイル名\n * - 引数：dateRange - パラメーターとして渡す期間\n * - 動作: 引数で渡されたsqlを実行し、取得したjson生データをjsonパースして返す(resultSql)\n */\nasync function getExtendSqlWithParameter(sqlFileName, dateRange) {\n  if (!sqlFileName) {\n    throw new Error('sqlFileNameが指定されていません');\n  }\n\n  const getEvents = sql(sqlFileName, dateRange);\n\n  const rows = await getEvents();\n\n  if (!rows) {\n    console.log(\"拡張sqlで取得されたjsonがありません\");\n    return;\n  }\n\n  let obj= JSON.parse(rows);\n  try {\n    obj = JSON.parse(rows);\n  } catch (e) {\n    console.log(\"拡張sqlのjsonパースに失敗しました。\");\n    console.log(rows);\n    return;\n  }\n\n  const resultSql = obj?.Response?.Data?.Table;\n\n  if (!resultSql) {\n    console.log(\"拡張sqlで取得されたjsonがありません\");\n    return;\n  }\n\n  return resultSql;\n}\n\n\n\n/**\n * exportExcel\n * - 拡張sqlで取得したjson配列をExcelファイルとして出力する関数\n * - 引数: jsonFromSql - 拡張sqlで取得したjson配列\n * - 動作: 引数で渡されたjson配列をExcelファイルに変換してダウンロードさせる\n */\n// function exportExcel(jsonFromSql, button) {\n//   const workbook = new ExcelJS.Workbook();\n//   const worksheet = workbook.addWorksheet('Sheet1');\n\n//   const header = Object.keys(jsonFromSql[0]);\n//   worksheet.addRow(header);\n\n//   jsonFromSql.forEach(row => {\n//     worksheet.addRow(Object.values(row));\n//   });\n\n//   const fileName = createExcelFileName(button);\n\n//   workbook.xlsx.writeBuffer().then(buffer => {\n//     const blob = new Blob(\n//       [buffer],\n//       { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' }\n//     );\n\n//     const url = URL.createObjectURL(blob);\n\n//     const a = document.createElement('a');\n//     a.href = url;\n//     a.download = fileName;\n//     document.body.appendChild(a);\n//     a.click();\n\n//     document.body.removeChild(a);\n//     URL.revokeObjectURL(url);\n//   });\n// }\n\nfunction exportExcel(jsonFromSql, button) {\n\n  // ★ 追加：データなしチェック\n  if (!Array.isArray(jsonFromSql) || jsonFromSql.length === 0) {\n    alert('出力するデータがありません。');\n    return;\n  }\n\n  const workbook = new ExcelJS.Workbook();\n  const worksheet = workbook.addWorksheet('Sheet1');\n\n  const header = Object.keys(jsonFromSql[0]);\n  worksheet.addRow(header);\n\n  jsonFromSql.forEach(row => {\n    worksheet.addRow(Object.values(row));\n  });\n\n  const fileName = createExcelFileName(button);\n\n  workbook.xlsx.writeBuffer().then(buffer => {\n    const blob = new Blob(\n      [buffer],\n      { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' }\n    );\n\n    const url = URL.createObjectURL(blob);\n\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = fileName;\n    document.body.appendChild(a);\n    a.click();\n\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  });\n}\n\n\n\n/**\n * formValidate\n * - フォームのバリデーションを行う関数\n * - 引数: form - バリデーションを行うフォーム要素\n * - 動作: フォームの有効性をチェックし、無効な場合は処理を中断する。有効な場合はExcel出力を行う。\n */\nasync function formValidate(e) {\n  e.preventDefault();\n\n  const button = this;\n  const form = this.closest('form');\n  if (!form) return;\n\n  if (!form.reportValidity()) return;\n\n  const buttonId = button.id;\n  const sqlFileName = exportWithParameter[buttonId];\n\n  if(!sqlFileName){\n    alert(\"対応するSQLが定義されていません\");\n    return;\n  }\n\n  let dateRange;\n  try{\n    dateRange = getDateRangeFromModal(button);\n  } catch (err) {\n    alert(err.message);\n    return;\n  }  \n\n  alert('Excelファイルを出力します');\n\n  const extendSqlResult = await getExtendSqlWithParameter(sqlFileName, dateRange);\n  // this = クリックされた .fn-sdt-modal-export ボタン\n  exportExcel(extendSqlResult, button);\n}\n\n/**\n * getDateRangeFromModal\n * - モーダル内の入力値から DateFrom / DateTo を生成\n *\n * @param {HTMLElement} button クリックされたボタン\n * @returns {{ DateFrom: string, DateTo: string }}\n */\nfunction getDateRangeFromModal(button) {\n  const modal = button.closest('.fn-modal');\n  if (!modal) {\n    throw new Error('モーダルが見つかりません');\n  }\n\n  const startInput = modal.querySelector('.fn-modal-start-date');\n  const finishInput = modal.querySelector('.fn-modal-finish-date');\n\n  if (!startInput || !startInput.value) {\n    throw new Error('開始日が入力されていません');\n  }\n\n  const buttonId = button.id;\n\n  // ===== 加工データ（月指定） =====\n  if (buttonId === 'fn-processed-data-export') {\n    // YYYY-MM\n    const [year, month] = startInput.value.split('-').map(Number);\n\n    const firstDay = `${year}-${String(month).padStart(2, '0')}-01`;\n\n    // 月末日を取得\n    const lastDate = new Date(year, month, 0); // 次月0日 = 月末\n    const lastDay = `${year}-${String(month).padStart(2, '0')}-${String(lastDate.getDate()).padStart(2, '0')}`;\n\n    return {\n      DateFrom: firstDay,\n      DateTo: lastDay\n    };\n  }\n\n  // ===== 通常（開始日〜終了日） =====\n  if (!finishInput || !finishInput.value) {\n    throw new Error('終了日が入力されていません');\n  }\n\n  return {\n    DateFrom: startInput.value,\n    DateTo: finishInput.value\n  };\n}",
            "Id": 6
          }
        ],
        "Htmls": [
          {
            "Title": "CDN",
            "PositionType": 1010,
            "All": true,
            "Body": " <!-- exceljs -->\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js\"></script>",
            "Id": 2
          },
          {
            "Title": "【表示制御】生データ・加工データHTML",
            "PositionType": 1010,
            "Index": true,
            "Body": "<div id=\"fn-processing\" class=\"sdt-processing\">\n    <!-- 生データ・加工データ全体ラップ -->\n    <section class=\"sdt-processing-wrap\">\n\n        <!-- 画面タイトル -->\n        <h2 class=\"sdt-processing-title\">\n            <span class=\"sdt-processing-title__text\">生データ出力</span>\n        </h2>\n\n        <!-- イベント -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <!-- モーダル起動 -->\n                <button class=\"fn-open-modal\" data-target=\"modal-A\">イベント</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">イベントカテゴリやイベント名称などの基本的なイベント情報</p>\n            </div>\n\n            <!-- モーダルHTML -->\n            <div class=\"fn-modal sdt-modal\" data-modal=\"modal-A\" role=\"dialog\" aria-modal=\"true\" aria-hidden=\"true\"\n                data-open=\"false\">\n                <div class=\"sdt-modal__overlay fn-modal-overlay\" tabindex=\"-1\"></div>\n\n                <div class=\"sdt-modal__dialog\" role=\"document\" aria-labelledby=\"fn-modal-title\">\n                    <div class=\"sdt-modal__header\">\n                        <p id=\"fn-modal-title\">データ出力の年月指定</p>\n                        <button class=\"fn-modal-close sdt-modal__close\" aria-label=\"閉じる\">✕</button>\n                    </div>\n                    <!-- モーダルコンテンツ -->\n                    <div class=\"sdt-modal__content\">\n                        <form class=\"sdt-processing-form fn-modal-processing-form\">\n                            <!-- モーダルフォームタイトル -->\n                            <div class=\"sdt-processing-form__head\">\n                                <p class=\"sdt-form-title\">イベント開催日</p>\n                            </div>\n                            <!-- フォーム領域 -->\n                            <div class=\"sdt-processing-form__body\">\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-start-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                                <span class=\"sdt-form-data__tilde\">~</span>\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-finish-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                            </div>\n                            <!-- ボタン -->\n                            <div class=\"sdt-processing-form__footer\">\n                                <button class=\"fn-sdt-modal-export sdt-button\" id=\"fn-event-export\" type=\"search\" onclick=\"\">\n                                    <span class=\"sdt-button__text\">出力</span>\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n\n        <!-- イベント店舗 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <!-- モーダル起動 -->\n                <button class=\"fn-open-modal\" data-target=\"modal-B\">イベント店舗</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">イベントに登録されている店舗ごとの情報</p>\n            </div>\n\n            <!-- モーダルHTML -->\n            <div class=\"fn-modal sdt-modal\" data-modal=\"modal-B\" role=\"dialog\" aria-modal=\"true\" aria-hidden=\"true\"\n                data-open=\"false\">\n                <div class=\"sdt-modal__overlay fn-modal-overlay\" tabindex=\"-1\"></div>\n\n                <div class=\"sdt-modal__dialog\" role=\"document\" aria-labelledby=\"fn-modal-title\">\n                    <div class=\"sdt-modal__header\">\n                        <p id=\"fn-modal-title\">データ出力の年月指定</p>\n                        <button class=\"fn-modal-close sdt-modal__close\" aria-label=\"閉じる\">✕</button>\n                    </div>\n                    <!-- モーダルコンテンツ -->\n                    <div class=\"sdt-modal__content\">\n                        <form class=\"sdt-processing-form\">\n                            <!-- モーダルフォームタイトル -->\n                            <div class=\"sdt-processing-form__head\">\n                                <p class=\"sdt-form-title\">イベント開催日</p>\n                            </div>\n                            <!-- フォーム領域 -->\n                            <div class=\"sdt-processing-form__body\">\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-start-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                                <span class=\"sdt-form-data__tilde\">~</span>\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-finish-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                            </div>\n                            <!-- ボタン -->\n                            <div class=\"sdt-processing-form__footer\">\n                                <button class=\"fn-sdt-modal-export sdt-button\" id=\"fn-event-store-export\" type=\"search\" onclick=\"\">\n                                    <span class=\"sdt-button__text\" >出力</span>\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n        <!-- イベント勤務 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <!-- モーダル起動 -->\n                <button class=\"fn-open-modal\" data-target=\"modal-C\">イベント勤務</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">日ごと登録されるイベントの勤務時間</p>\n            </div>\n\n            <!-- モーダルHTML -->\n            <div class=\"fn-modal sdt-modal\" data-modal=\"modal-C\" role=\"dialog\" aria-modal=\"true\" aria-hidden=\"true\"\n                data-open=\"false\">\n                <div class=\"sdt-modal__overlay fn-modal-overlay\" tabindex=\"-1\"></div>\n\n                <div class=\"sdt-modal__dialog\" role=\"document\" aria-labelledby=\"fn-modal-title\">\n                    <div class=\"sdt-modal__header\">\n                        <p id=\"fn-modal-title\">データ出力の年月指定</p>\n                        <button class=\"fn-modal-close sdt-modal__close\" aria-label=\"閉じる\">✕</button>\n                    </div>\n                    <!-- モーダルコンテンツ -->\n                    <div class=\"sdt-modal__content\">\n                        <form class=\"sdt-processing-form\">\n                            <!-- モーダルフォームタイトル -->\n                            <div class=\"sdt-processing-form__head\">\n                                <p class=\"sdt-form-title\">勤務日</p>\n                            </div>\n                            <!-- フォーム領域 -->\n                            <div class=\"sdt-processing-form__body\">\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-start-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                                <span class=\"sdt-form-data__tilde\">~</span>\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-finish-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                            </div>\n                            <!-- ボタン -->\n                            <div class=\"sdt-processing-form__footer\">\n                                <button class=\"fn-sdt-modal-export sdt-button\" id=\"fn-event-work-export\" type=\"search\" onclick=\"\">\n                                    <span class=\"sdt-button__text\" >出力</span>\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n        <!-- イベント天気 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <!-- モーダル起動 -->\n                <button class=\"fn-open-modal\" data-target=\"modal-D\">イベント天気</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">日ごと登録されるイベント当日の天気</p>\n            </div>\n\n            <!-- モーダルHTML -->\n            <div class=\"fn-modal sdt-modal\" data-modal=\"modal-D\" role=\"dialog\" aria-modal=\"true\" aria-hidden=\"true\"\n                data-open=\"false\">\n                <div class=\"sdt-modal__overlay fn-modal-overlay\" tabindex=\"-1\"></div>\n\n                <div class=\"sdt-modal__dialog\" role=\"document\" aria-labelledby=\"fn-modal-title\">\n                    <div class=\"sdt-modal__header\">\n                        <p id=\"fn-modal-title\">データ出力の年月指定</p>\n                        <button class=\"fn-modal-close sdt-modal__close\" aria-label=\"閉じる\">✕</button>\n                    </div>\n                    <!-- モーダルコンテンツ -->\n                    <div class=\"sdt-modal__content\">\n                        <form class=\"sdt-processing-form\">\n                            <!-- モーダルフォームタイトル -->\n                            <div class=\"sdt-processing-form__head\">\n                                <p class=\"sdt-form-title\">イベント日</p>\n                            </div>\n                            <!-- フォーム領域 -->\n                            <div class=\"sdt-processing-form__body\">\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-start-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                                <span class=\"sdt-form-data__tilde\">~</span>\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-finish-date sdt-input\" type=\"date\" required>\n                                    </label>\n                                </div>\n                            </div>\n                            <!-- ボタン -->\n                            <div class=\"sdt-processing-form__footer\">\n                                <button class=\"fn-sdt-modal-export sdt-button\" id=\"fn-event-weather-export\" type=\"search\" onclick=\"\">\n                                    <span class=\"sdt-button__text\" >出力</span>\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n        <!-- 品目実績 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-product-achivement-export\">品目実績</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">品目/品種ごとの販売額・取扱量などの実績</p>\n            </div>\n        </div>\n\n        <!-- キッチンカー -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-kitchencar-export\">キッチンカー</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されたキッチンカーに対する利用情報</p>\n            </div>\n        </div>\n\n        <!-- キッチンカー利用 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-kitchencar-use-export\">キッチンカー利用</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">登録されたキッチンカーに対する利用情報</p>\n            </div>\n        </div>\n\n        <!-- 派遣者 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-employee-export\">派遣者</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録される派遣者情報</p>\n            </div>\n        </div>\n\n        <!-- 派遣者利用 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-employee-use-export\">派遣者利用</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">登録された派遣者に対する派遣情報</p>\n            </div>\n        </div>\n\n        <!-- 先方（要人） -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-client-export\"> 先方（要人）</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">イベント予定とイベント当日で登録される先方（要人）情報</p>\n            </div>\n        </div>\n\n        <!-- メニュー別食数 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-menu-export\">メニュー別食数</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">イベントの店舗ごとに登録されるメニュー別食数</p>\n            </div>\n        </div>\n\n        <!-- メディア露出の経済価値 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-media-export\">メディア露出の経済価値</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">イベントごとのメディア掲載情報</p>\n            </div>\n        </div>\n\n        <!-- イベント写真(写真名のみ) -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-eventphoto-export\">イベント写真(写真名のみ)</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">イベントの店舗ごとに登録される写真の写真名データ</p>\n            </div>\n        </div>\n\n        <!-- 室·センター -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-center-export\">室·センター</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている室·センター</p>\n            </div>\n        </div>\n\n        <!-- グループ -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-group-export\">グループ</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されているグループー</p>\n            </div>\n        </div>\n\n        <!-- メンバー -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-member-export\">メンバー</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されているメンバー</p>\n            </div>\n        </div>\n\n        <!-- 店舗 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-store-export\">店舗</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている店舗</p>\n            </div>\n        </div>\n\n        <!-- 委託先情報(社名) -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-contractor-export\">委託先情報(社名)</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている委託先情報(社名)</p>\n            </div>\n        </div>\n\n        <!-- メディア露出の経済価値(テレビ·ラジオ) -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-tv-radio-export\">メディア露出の経済価値(テレビ·ラジオ)</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されているメディア露出の経済価値(テレビ·ラジオ)</p>\n            </div>\n        </div>\n\n        <!-- メディア露出の経済価値(新聞) -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-newspaper-export\">メディア露出の経済価値(新聞)</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されているメディア露出の経済価値(新聞)</p>\n            </div>\n        </div>\n\n        <!-- 品種(ブランド) -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-brand-export\">品種(ブランド)</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている品種(ブランド)</p>\n            </div>\n        </div>\n\n        <!-- 仕入先 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-supplier-export\">仕入先</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている仕入先</p>\n            </div>\n        </div>\n\n        <!-- ランク(等級) -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-rank-export\">ランク(等級)</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されているランク(等級)</p>\n            </div>\n        </div>\n\n        <!-- 包装 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-peach-packaging-export\">包装</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている包装</p>\n            </div>\n        </div>\n\n        <!-- 部位 -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-beef-part-export\">部位</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている部位</p>\n            </div>\n        </div>\n\n        <!-- 種類(ホタテ) -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <button class=\"fn-export\" id=\"fn-scallops-type-export\">種類(ホタテ)</button>\n            </div>\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">システムに登録されている種類(ホタテ)</p>\n            </div>\n        </div>\n\n        <!-- 画面タイトル -->\n        <h2 class=\"sdt-processing-title\">\n            <span class=\"sdt-processing-title__text\">加工データ出力</span>\n        </h2>\n\n        <!-- DLリスト -->\n        <div class=\"sdt-processing-downloadList\">\n            <div class=\"sdt-download-name\">\n                <!-- モーダル起動 -->\n                <button class=\"fn-open-modal\" data-target=\"modal-processing\">品目別イベント開催日数</button>\n            </div>\n\n            <div class=\"sdt-download-explanation\">\n                <p class=\"sdt-download-explanation__text\">品目毎のイベント開催日数</p>\n            </div>\n\n            <!-- モーダルHTML -->\n            <div class=\"fn-modal sdt-modal\" data-modal=\"modal-processing\" role=\"dialog\" aria-modal=\"true\"\n                aria-hidden=\"true\" data-open=\"false\">\n                <div class=\"sdt-modal__overlay fn-modal-overlay\" tabindex=\"-1\"></div>\n\n                <div class=\"sdt-modal__dialog\" role=\"document\" aria-labelledby=\"fn-modal-title\">\n                    <div class=\"sdt-modal__header\">\n                        <p id=\"fn-modal-title\">データ出力の年月指定</p>\n                        <button class=\"fn-modal-close sdt-modal__close\" aria-label=\"閉じる\">✕</button>\n                    </div>\n                    <!-- モーダルコンテンツ -->\n                    <div class=\"sdt-modal__content\">\n                        <form class=\"sdt-processing-form\">\n                            <!-- モーダルフォームタイトル -->\n                            <div class=\"sdt-processing-form__head\">\n                                <p class=\"sdt-form-title\">対象年月選択</p>\n                            </div>\n                            <!-- フォーム領域 -->\n                            <div class=\"sdt-processing-form__body\">\n                                <div class=\"sdt-form-data\">\n                                    <label class=\"sdt-form-label\">\n                                        <input class=\"fn-modal-start-date sdt-input\" type=\"month\" required>\n                                    </label>\n                                </div>\n                                <!-- <span class=\"sdt-form-data__tilde\">~</span>\n                                        <div class=\"sdt-form-data\">\n                                            <label class=\"sdt-form-label\">\n                                                <input class=\"sdt-input\" type=\"date\">\n                                            </label>\n                                        </div> -->\n                            </div>\n                            <!-- ボタン -->\n                            <div class=\"sdt-processing-form__footer\">\n                                <button class=\"fn-sdt-modal-export sdt-button\" id=\"fn-processed-data-export\" type=\"search\" onclick=\"\">\n                                    <span class=\"sdt-button__text\">出力</span>\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n\n    </section>\n\n</div>",
            "Id": 1
          }
        ],
        "NoDisplayIfReadOnly": false
      },
      "Publish": false,
      "DisableCrossSearch": false,
      "Comments": []
    }
  ],
  "Data": [],
  "Permissions": [
    {
      "SiteId": 255696,
      "Permissions": [
        {
          "ReferenceId": 255696,
          "DeptId": 208,
          "GroupId": 0,
          "UserId": 0,
          "PermissionType": 511
        },
        {
          "ReferenceId": 255696,
          "DeptId": 0,
          "GroupId": 0,
          "UserId": 1,
          "PermissionType": 511
        }
      ]
    }
  ],
  "PermissionIdList": {
    "DeptIdList": [
      {
        "DeptId": 208,
        "DeptCode": "000000"
      }
    ],
    "GroupIdList": [],
    "UserIdList": [
      {
        "UserId": 1,
        "LoginId": "Administrator"
      }
    ]
  }
}